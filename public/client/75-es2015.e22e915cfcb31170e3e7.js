(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{"7b8J":function(e,t,i){"use strict";i.r(t),i.d(t,"PermissionMatrixModule",(function(){return _}));var n=i("ofXK"),o=i("tyNb"),r=i("fXoL"),s=i("c92J"),a=i("1VJT"),l=i("ccyI");function c(e,t){1&e&&(r["\u0275\u0275elementStart"](0,"div"),r["\u0275\u0275element"](1,"img",10),r["\u0275\u0275text"](2," Loading... "),r["\u0275\u0275elementEnd"]())}function m(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"th"),r["\u0275\u0275text"](1),r["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate"](e.role_name)}}function d(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"span",23),r["\u0275\u0275listener"]("click",(function(){r["\u0275\u0275restoreView"](e);const t=r["\u0275\u0275nextContext"]().$implicit,i=r["\u0275\u0275nextContext"]().$implicit;return r["\u0275\u0275nextContext"](2).addPermission(t.role_id,i.permission.permission_id,i)})),r["\u0275\u0275elementStart"](1,"em",24),r["\u0275\u0275element"](2,"i",25),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"]()}if(2&e){const e=r["\u0275\u0275nextContext"]().$implicit,t=r["\u0275\u0275nextContext"]().$implicit;r["\u0275\u0275advance"](1),r["\u0275\u0275propertyInterpolate2"]("title","click to grant permission: ",t.permission.name," to role: ",e.role_name,"")}}function f(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"span",23),r["\u0275\u0275listener"]("click",(function(){r["\u0275\u0275restoreView"](e);const t=r["\u0275\u0275nextContext"]().$implicit,i=r["\u0275\u0275nextContext"]().$implicit;return r["\u0275\u0275nextContext"](2).removePermission(t.role_id,i.permission.permission_id,i)})),r["\u0275\u0275elementStart"](1,"em",26),r["\u0275\u0275element"](2,"i",15),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"]()}if(2&e){const e=r["\u0275\u0275nextContext"]().$implicit,t=r["\u0275\u0275nextContext"]().$implicit;r["\u0275\u0275advance"](1),r["\u0275\u0275propertyInterpolate2"]("title","click to remove permission: ",t.permission.name," from role: ",e.role_name,"")}}function h(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"td",20),r["\u0275\u0275template"](1,d,3,2,"span",21),r["\u0275\u0275template"](2,f,3,2,"ng-template",null,22,r["\u0275\u0275templateRefExtractor"]),r["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,i=r["\u0275\u0275reference"](3),n=r["\u0275\u0275nextContext"]().$implicit;r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",-1==n.roles.indexOf(e.role_id))("ngIfElse",i)}}function p(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"tr"),r["\u0275\u0275elementStart"](1,"td"),r["\u0275\u0275text"](2),r["\u0275\u0275element"](3,"br"),r["\u0275\u0275elementStart"](4,"em",18),r["\u0275\u0275text"](5),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275template"](6,h,4,2,"td",19),r["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,i=r["\u0275\u0275nextContext"](2);r["\u0275\u0275advance"](2),r["\u0275\u0275textInterpolate"](e.permission.name),r["\u0275\u0275advance"](3),r["\u0275\u0275textInterpolate"](e.permission.description),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngForOf",i.roles)}}function u(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"div"),r["\u0275\u0275elementStart"](1,"table",11),r["\u0275\u0275elementStart"](2,"caption"),r["\u0275\u0275elementStart"](3,"em",12),r["\u0275\u0275element"](4,"i",13),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](5," = Role does not currently have this permission, "),r["\u0275\u0275elementStart"](6,"em",14),r["\u0275\u0275element"](7,"i",15),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](8," = Role currently has this permission "),r["\u0275\u0275element"](9,"br"),r["\u0275\u0275elementStart"](10,"em"),r["\u0275\u0275text"](11,"Click on a "),r["\u0275\u0275elementStart"](12,"em",14),r["\u0275\u0275element"](13,"i",15),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](14," to remove a permission from the role, or click on a "),r["\u0275\u0275elementStart"](15,"em",12),r["\u0275\u0275element"](16,"i",16),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](17," to add that permission to the role"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](18,"thead"),r["\u0275\u0275elementStart"](19,"tr"),r["\u0275\u0275element"](20,"th"),r["\u0275\u0275template"](21,m,2,1,"th",17),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275template"](22,p,7,3,"tr",17),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"]();r["\u0275\u0275advance"](21),r["\u0275\u0275property"]("ngForOf",e.roles),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngForOf",e.objects)}}function x(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"div",3),r["\u0275\u0275text"](1," Unable to connect to server. Please check your connection. "),r["\u0275\u0275elementStart"](2,"a",4),r["\u0275\u0275listener"]("click",(function(){return r["\u0275\u0275restoreView"](e),r["\u0275\u0275nextContext"]().start()})),r["\u0275\u0275text"](3,"Try Again"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"]()}}const g=[{path:"",component:(()=>{class e{constructor(e,t,i){this.dbService=e,this.notify=t,this.authService=i,this.objects=[],this.is_loading=!1,this.error=!1,this.is_loaded=!1,this.url="admin/permissionMatrix",this.roles=[],this.is_loading_roles=!1,this.error_roles=!1,this.is_loaded_roles=!1,-1==this.authService.current_user.permissions.indexOf("Manage Roles")&&(this.goBack(),this.notify.failNotification("You are not permitted to view this page"))}ngOnInit(){this.start(),this.getRoles()}start(){this.is_loaded=!1,this.is_loading=!0,this.dbService.getData(this.url,this.authService.current_user).subscribe(e=>{"-1"===e.status&&(this.notify.failNotification("Internal server error. Please check to make sure the registration number does not already exist"),this.error=!0),"-9"===e.status?(this.notify.showNotification("You are not permitted to perform this action","fail",3e3),this.error=!0):(this.objects=e.data,this.is_loaded=!0,this.error=!1),this.is_loading=!1},e=>{this.notify.noConnectionNotification(),this.is_loaded=!1,this.is_loading=!1,this.error=!0})}getRoles(){this.is_loaded=!1,this.is_loading=!0,this.dbService.getData("admin/getRoles",this.authService.current_user).subscribe(e=>{"-1"===e.status&&(this.notify.failNotification("Internal server error. Please check to make sure the registration number does not already exist"),this.error=!0),"-9"===e.status?(this.notify.showNotification("You are not permitted to perform this action","fail",3e3),this.error=!0):(this.roles=e.data,this.is_loaded_roles=!0,this.error_roles=!1),this.is_loading_roles=!1},e=>{this.notify.noConnectionNotification(),this.is_loaded_roles=!1,this.is_loading_roles=!1,this.error_roles=!0})}addPermission(e,t,i){this.notify.showLoading();let n=new FormData;n.append("role_id",e),n.append("permission_id",t),this.dbService.postData(n,"admin/addRolePermission",this.authService.current_user).subscribe(t=>{this.notify.hideLoading(),"-1"===t.status?this.notify.failNotification("Unable to authenticate. Please login again"):"-9"===t.status?this.notify.showNotification("You are not permitted to perform this action","fail",3e3):(this.notify.successNotification("Permission added to role successfully"),i.roles.push(e))},e=>{this.notify.noConnectionNotification()})}removePermission(e,t,i){this.notify.showLoading();let n=new FormData;n.append("role_id",e),n.append("permission_id",t),this.dbService.postData(n,"admin/deleteRolePermission",this.authService.current_user).subscribe(t=>{this.notify.hideLoading(),"-1"===t.status?this.notify.failNotification("Unable to authenticate. Please login again"):"-9"===t.status?this.notify.showNotification("You are not permitted to perform this action","fail",3e3):(this.notify.successNotification("Permission removed from role successfully"),i.roles.splice(i.roles.indexOf(e),1))},e=>{this.notify.noConnectionNotification()})}goBack(){window.history.back()}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275directiveInject"](s.a),r["\u0275\u0275directiveInject"](a.a),r["\u0275\u0275directiveInject"](l.a))},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["app-permission-matrix"]],decls:13,vars:3,consts:[[1,"content"],[1,"container-fluid"],[1,"block-header"],[1,""],[1,"btn","btn-primary",3,"click"],[1,"row","clear-fix"],[1,"card"],[1,"body","table-responsive"],[4,"ngIf"],["class","",4,"ngIf"],["src","../../assets/images/ripple.gif","height","50","alt","loading"],[1,"table","table-bordered","table-striped"],[1,"text-danger"],[1,"fa","fa-trash-alt"],[1,"text-success"],[1,"fa","fa-check"],[1,"fa","fa-remove"],[4,"ngFor","ngForOf"],[1,"text-muted"],["class","text-center",4,"ngFor","ngForOf"],[1,"text-center"],["class","fill_box",3,"click",4,"ngIf","ngIfElse"],["has_it",""],[1,"fill_box",3,"click"],[1,"text-danger",3,"title"],[1,"fa","fa-minus"],[1,"text-success",3,"title"]],template:function(e,t){1&e&&(r["\u0275\u0275elementStart"](0,"section",0),r["\u0275\u0275elementStart"](1,"div",1),r["\u0275\u0275elementStart"](2,"div",2),r["\u0275\u0275elementStart"](3,"h2",3),r["\u0275\u0275elementStart"](4,"a",4),r["\u0275\u0275listener"]("click",(function(){return t.goBack()})),r["\u0275\u0275text"](5,"Back"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](6," PERMISSION MATRIX "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](7,"div",5),r["\u0275\u0275elementStart"](8,"div",6),r["\u0275\u0275elementStart"](9,"div",7),r["\u0275\u0275template"](10,c,3,0,"div",8),r["\u0275\u0275template"](11,u,23,2,"div",8),r["\u0275\u0275template"](12,x,4,0,"div",9),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"]()),2&e&&(r["\u0275\u0275advance"](10),r["\u0275\u0275property"]("ngIf",t.is_loading),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",t.is_loaded&&t.is_loaded_roles),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",t.error))},directives:[n.j,n.i],styles:[""]}),e})()}];let v=(()=>{class e{}return e.\u0275mod=r["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=r["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.e.forChild(g)],o.e]}),e})(),_=(()=>{class e{}return e.\u0275mod=r["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=r["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[n.b,v]]}),e})()}}]);