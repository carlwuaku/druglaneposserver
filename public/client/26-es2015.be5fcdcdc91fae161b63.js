(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{FPPG:function(e,t,n){"use strict";n.r(t),n.d(t,"EditUserModule",(function(){return w}));var r=n("ofXK"),i=n("tyNb"),a=n("zmU/"),o=n("MCNt"),s=n("fXoL"),l=n("c92J"),d=n("1VJT"),m=n("ccyI"),p=n("3Pt+"),c=n("hiAm");function u(e,t){1&e&&s["\u0275\u0275element"](0,"app-loading")}function h(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"div",26),s["\u0275\u0275text"](1," Please make sure passwords match "),s["\u0275\u0275elementEnd"]())}function g(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"option",27),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275propertyInterpolate"]("value",e.role_id),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",e.role_name," ")}}function f(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"td"),s["\u0275\u0275elementStart"](1,"select",23),s["\u0275\u0275listener"]("ngModelChange",(function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"](2).role_id=t})),s["\u0275\u0275template"](2,g,2,2,"option",24),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](3,"span",15),s["\u0275\u0275elementEnd"]()}if(2&e){const e=s["\u0275\u0275nextContext"](2);s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngModel",e.role_id),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngForOf",e.roles)}}function S(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"option",27),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275propertyInterpolate"]("value",e.id),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function y(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",11),s["\u0275\u0275elementStart"](1,"table",12),s["\u0275\u0275elementStart"](2,"tbody"),s["\u0275\u0275elementStart"](3,"tr"),s["\u0275\u0275elementStart"](4,"td"),s["\u0275\u0275elementStart"](5,"label"),s["\u0275\u0275text"](6,"Full Name*"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"td"),s["\u0275\u0275elementStart"](8,"input",13),s["\u0275\u0275listener"]("ngModelChange",(function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().user.display_name=t})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](9,"tr"),s["\u0275\u0275elementStart"](10,"td"),s["\u0275\u0275elementStart"](11,"label"),s["\u0275\u0275text"](12,"Username*"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](13,"td"),s["\u0275\u0275elementStart"](14,"input",14),s["\u0275\u0275listener"]("ngModelChange",(function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().user.username=t})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](15,"span",15),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](16,"tr"),s["\u0275\u0275elementStart"](17,"td"),s["\u0275\u0275elementStart"](18,"label"),s["\u0275\u0275text"](19,"Phone*"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](20,"td"),s["\u0275\u0275elementStart"](21,"input",16),s["\u0275\u0275listener"]("ngModelChange",(function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().user.phone=t})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](22,"tr"),s["\u0275\u0275elementStart"](23,"td"),s["\u0275\u0275elementStart"](24,"label"),s["\u0275\u0275text"](25,"Email*"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](26,"td"),s["\u0275\u0275elementStart"](27,"input",17),s["\u0275\u0275listener"]("ngModelChange",(function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().user.email=t})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](28,"tr"),s["\u0275\u0275elementStart"](29,"td"),s["\u0275\u0275elementStart"](30,"label"),s["\u0275\u0275text"](31,"Password"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](32,"br"),s["\u0275\u0275elementStart"](33,"em",18),s["\u0275\u0275text"](34,"leave the passwords empty if you do not intend to change the password"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](35,"td"),s["\u0275\u0275elementStart"](36,"input",19),s["\u0275\u0275listener"]("ngModelChange",(function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().password=t})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](37,"tr"),s["\u0275\u0275elementStart"](38,"td"),s["\u0275\u0275elementStart"](39,"label"),s["\u0275\u0275text"](40,"Confirm Password"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](41,"td"),s["\u0275\u0275elementStart"](42,"input",20),s["\u0275\u0275listener"]("ngModelChange",(function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().confirm_password=t})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](43,h,2,0,"div",21),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](44,"tr"),s["\u0275\u0275elementStart"](45,"td"),s["\u0275\u0275elementStart"](46,"label"),s["\u0275\u0275text"](47,"Position*"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](48,"td"),s["\u0275\u0275elementStart"](49,"input",22),s["\u0275\u0275listener"]("ngModelChange",(function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().user.position=t})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](50,"span",15),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](51,"tr"),s["\u0275\u0275elementStart"](52,"td"),s["\u0275\u0275elementStart"](53,"label"),s["\u0275\u0275text"](54,"Role*"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](55,f,4,2,"td",6),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](56,"tr"),s["\u0275\u0275elementStart"](57,"td"),s["\u0275\u0275elementStart"](58,"label"),s["\u0275\u0275text"](59,"Branch*"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](60,"td"),s["\u0275\u0275elementStart"](61,"select",23),s["\u0275\u0275listener"]("ngModelChange",(function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().company_id=t})),s["\u0275\u0275template"](62,S,2,2,"option",24),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](63,"span",15),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](64,"input",25),s["\u0275\u0275elementEnd"]()}if(2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](8),s["\u0275\u0275property"]("ngModel",e.user.display_name),s["\u0275\u0275advance"](6),s["\u0275\u0275property"]("ngModel",e.user.username),s["\u0275\u0275advance"](7),s["\u0275\u0275property"]("ngModel",e.user.phone),s["\u0275\u0275advance"](6),s["\u0275\u0275property"]("ngModel",e.user.email),s["\u0275\u0275advance"](9),s["\u0275\u0275property"]("ngModel",e.password),s["\u0275\u0275advance"](6),s["\u0275\u0275property"]("ngModel",e.confirm_password),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",e.password!=e.confirm_password),s["\u0275\u0275advance"](6),s["\u0275\u0275property"]("ngModel",e.user.position),s["\u0275\u0275advance"](6),s["\u0275\u0275property"]("ngIf",e.is_loaded_roles),s["\u0275\u0275advance"](6),s["\u0275\u0275property"]("ngModel",e.company_id),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngForOf",e.branches),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("disabled",e.password!=e.confirm_password)}}const E=[{path:"",component:(()=>{class e{constructor(e,t,n,r,i,s){this.location=e,this.router=t,this.dbService=r,this.notify=i,this.authService=s,this.uploadUrl="uploadPharmacistPicture",this.error=!1,this.is_loading=!0,this.is_loaded=!1,this.error_roles=!1,this.is_loading_roles=!0,this.is_loaded_roles=!1,this.id=n.snapshot.params.id,this.user=new a.a,this.user.role=new o.a,-1==this.authService.current_user.permissions.indexOf("Manage Staff")&&this.goBack(),this.dbService.setTitle("Edit User")}ngOnInit(){this.dbService.getDataById(this.id,"admin/getUser",this.authService.current_user).subscribe(e=>{this.user=e.data,this.role_id=this.user.role.role_id,this.company_id=this.user.company_id,this.is_loading=!1,this.is_loaded=!0,this.error=!1},e=>{this.is_loading=!1,this.error=!0,this.is_loaded=!1}),this.dbService.getData("admin/getRoles",this.authService.current_user).subscribe(e=>{this.roles=e.data,this.is_loading_roles=!1,this.is_loaded_roles=!0,this.error_roles=!1},e=>{this.is_loading_roles=!1,this.error_roles=!0,this.is_loaded_roles=!1}),this.getBranches()}uploadFinished(e){this.user.picture=e}getBranches(){this.notify.showLoading();let e="admin/getBranches?only_others=no";"admin"==this.authService.current_user.type&&(e+="&parent_company_id="+this.authService.current_user.parent_company_id),this.dbService.getData(e,this.authService.current_user).subscribe(e=>{this.notify.hideLoading(),"-1"===e.status||(this.branches=e.data)},e=>{this.notify.hideLoading(),this.notify.noConnectionNotification()})}submit(){this.notify.showLoading();const e=new FormData;e.append("display_name",this.user.display_name),e.append("username",this.user.username),e.append("password",this.password),e.append("email",this.user.email),e.append("position",this.user.position),e.append("role_id",this.role_id),e.append("type",this.user.type),e.append("phone",this.user.phone),e.append("picture",this.user.picture),e.append("company_id",this.company_id),e.append("id",this.id),this.dbService.postData(e,"admin/saveUser",this.authService.current_user).subscribe(e=>{this.notify.hideLoading(),"-1"===e.status?this.notify.failNotification("Unable to authenticate. Please login again"):"-9"===e.status?this.notify.showNotification("You are not permitted to perform this action","fail",3e3):(this.notify.successNotification("User edited successfully"),this.router.navigate(["/users"]))},e=>{this.notify.noConnectionNotification()})}goBack(){window.history.back()}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](r.f),s["\u0275\u0275directiveInject"](i.d),s["\u0275\u0275directiveInject"](i.a),s["\u0275\u0275directiveInject"](l.a),s["\u0275\u0275directiveInject"](d.a),s["\u0275\u0275directiveInject"](m.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-edit-user"]],decls:13,vars:2,consts:[[1,"content"],[1,"container"],[1,"row"],[1,"col-sm-12"],[1,"card"],[1,"card-header"],[4,"ngIf"],[1,"card-block"],["ngNativeValidate","",3,"ngSubmit"],["n","ngForm"],["class","body",4,"ngIf"],[1,"body"],[1,"table","table-striped","table-bordered"],["id","name","required","","type","text","name","name","maxlength","50",3,"ngModel","ngModelChange"],["id","username","required","","type","text","name","username","maxlength","20",3,"ngModel","ngModelChange"],[1,"help-inline"],["required","","type","text","name","phone",3,"ngModel","ngModelChange"],["required","","id","email","type","email","name","email",3,"ngModel","ngModelChange"],[1,"text-muted"],["type","password","name","password",3,"ngModel","ngModelChange"],["type","password","name","c_password",3,"ngModel","ngModelChange"],["class","text-danger",4,"ngIf"],["required","","type","text","name","position",3,"ngModel","ngModelChange"],["required","","name","role",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","submit","name","","value","Submit",1,"btn","btn-primary",3,"disabled"],[1,"text-danger"],[3,"value"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"section",0),s["\u0275\u0275elementStart"](1,"div",1),s["\u0275\u0275elementStart"](2,"div",2),s["\u0275\u0275elementStart"](3,"div",3),s["\u0275\u0275elementStart"](4,"div",4),s["\u0275\u0275elementStart"](5,"div",5),s["\u0275\u0275elementStart"](6,"h5"),s["\u0275\u0275text"](7,"Edit user"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](8,u,1,0,"app-loading",6),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](9,"div",7),s["\u0275\u0275elementStart"](10,"form",8,9),s["\u0275\u0275listener"]("ngSubmit",(function(){return t.submit()})),s["\u0275\u0275template"](12,y,65,12,"div",10),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](8),s["\u0275\u0275property"]("ngIf",t.is_loading),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("ngIf",t.is_loaded))},directives:[r.j,p.f,p.g,c.a,p.b,p.l,p.d,p.e,p.h,p.m,r.i,p.i,p.n],styles:[""]}),e})()}];let v=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.f.forChild(E)],i.f]}),e})();var _=n("uQlb"),b=n("nEHF");let w=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[r.b,v,_.a,b.a]]}),e})()},hiAm:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("fXoL");let i=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["app-loading"]],decls:2,vars:0,consts:[[1,"fa","fa-spin","fa-spinner"]],template:function(e,t){1&e&&(r["\u0275\u0275element"](0,"i",0),r["\u0275\u0275text"](1," Loading..."))},styles:[""]}),e})()},rNAZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("ofXK"),i=n("nEHF"),a=n("6QD7"),o=n("fXoL");let s=(()=>{class e{}return e.\u0275mod=o["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=o["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[r.b,i.a,a.b],a.b]}),e})()}}]);