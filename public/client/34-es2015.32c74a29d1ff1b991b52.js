(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{GcqH:function(e,t,n){"use strict";n.r(t),n.d(t,"ReceivePaymentModule",(function(){return g}));var i=n("ofXK"),r=n("tyNb");class s{constructor(){this.payer="Credit Sale Payment"}}var o=n("fXoL"),a=n("c92J"),l=n("1VJT"),c=n("ccyI"),d=n("3Pt+"),m=n("QQkv");const h=[{path:"",component:(()=>{class e{constructor(e,t,n,i,r){this.dbService=e,this.router=t,this.ar=n,this.notify=i,this.authService=r,this.vendor_id="",this.type="Miscellaneous",-1==this.authService.current_user.permissions.indexOf("Create Sales")&&(this.notify.failNotification("You are not permitted to view the page"),this.dbService.goBackHome()),this.dbService.setTitle("Recieve Credit Sales Payment"),this.object=new s,this.object.type="Credit Sale Payment",n.queryParams.subscribe(e=>{console.log(e),this.object.item_code=e.item_code,this.object.payer=e.payer,this.vendor_id=e.recipient})}ngOnInit(){}setCustomer(e){this.object.payer=e.id}submit(){this.notify.showLoading();const e=new FormData;e.append("item_code",this.object.item_code),e.append("notes",this.object.notes),e.append("transaction_id",this.object.transaction_id),e.append("date",this.object.date),e.append("created_by",this.authService.current_user.id),e.append("type",this.object.type),e.append("payment_method",this.object.payment_method),e.append("amount",this.object.amount),e.append("payer",this.object.payer),e.append("created_on",this.dbService.getToday("timestamp")),e.append("display_name",this.authService.current_user.display_name),this.dbService.postData(e,"admin/saveIncomingPayment",this.authService.current_user).subscribe(e=>{this.notify.hideLoading(),"0"===e.status?this.notify.failNotification("Unable to authenticate. Please login again"):"-1"===e.status?this.notify.failNotification("Server error. Please try again"):"-9"===e.status?this.notify.showNotification("You are not permitted to perform this action","fail",3e3):(this.notify.hideLoading(),this.notify.successNotification("Payment saved successfully"),this.object=new s,this.object.type="Credit Sale Payment")},e=>{this.notify.hideLoading(),this.notify.noConnectionNotification()})}searchCustomers(){""!=this.customer_name.trim()&&null!=this.customer_name&&null!=this.customer_name?this.dbService.getDataWithQuery("customer/search",this.authService.current_user,"param="+this.customer_name+"&limit=10").subscribe(e=>{"-1"===e.status||(this.customer_objects=e.data)},e=>{}):this.customer_objects=[]}getCustomerPhone(){for(var e=0;e<this.customer_objects.length;e++){var t=this.customer_objects[e];if(t.name.trim().toLowerCase()==this.customer_name.trim().toLowerCase()){this.customer_phone=t.phone;break}}}goBack(){window.history.back()}}return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275directiveInject"](a.a),o["\u0275\u0275directiveInject"](r.c),o["\u0275\u0275directiveInject"](r.a),o["\u0275\u0275directiveInject"](l.a),o["\u0275\u0275directiveInject"](c.a))},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["app-receive-payment"]],decls:68,vars:8,consts:[[1,"content"],[1,"container"],[1,"card"],[1,"card-body"],["ngNativeValidate","",3,"ngSubmit"],["n","ngForm"],[1,""],[1,"row","bottom-margin"],[1,"col-md-4"],["required","","type","date","name","date",3,"ngModel","ngModelChange"],["required","","type","text","name","amount",3,"ngModel","ngModelChange"],[3,"type","onFinish"],["required","","type","text","name","type",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","item_code",1,"form-control",3,"ngModel","ngModelChange"],["name","payment_method",3,"ngModel","ngModelChange"],["value","object.payment_method == 'Cash' ? 'N/A': ''","required","","type","text","name","transaction_id",1,"form-control",3,"ngModel","ngModelChange"],["name","notes","rows","3","cols","40",1,"form-control",3,"ngModel","ngModelChange"],["type","submit","name","submit","value","Submit",1,"btn","btn-success"],["type","reset","name","reset","value","Reset",1,"btn","btn-warning"]],template:function(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"section",0),o["\u0275\u0275elementStart"](1,"div",1),o["\u0275\u0275elementStart"](2,"h4"),o["\u0275\u0275text"](3,"Receive Payment for a Credit Sale "),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](4,"div",2),o["\u0275\u0275elementStart"](5,"div",3),o["\u0275\u0275elementStart"](6,"form",4,5),o["\u0275\u0275listener"]("ngSubmit",(function(){return t.submit()})),o["\u0275\u0275elementStart"](8,"div",6),o["\u0275\u0275elementStart"](9,"em"),o["\u0275\u0275text"](10,"Fields marked * are required"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](11,"div",7),o["\u0275\u0275elementStart"](12,"div",8),o["\u0275\u0275elementStart"](13,"label"),o["\u0275\u0275text"](14,"Payment Date*"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](15,"br"),o["\u0275\u0275elementStart"](16,"input",9),o["\u0275\u0275listener"]("ngModelChange",(function(e){return t.object.date=e})),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](17,"div",8),o["\u0275\u0275elementStart"](18,"label"),o["\u0275\u0275text"](19,"Amount Paid*"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](20,"br"),o["\u0275\u0275elementStart"](21,"input",10),o["\u0275\u0275listener"]("ngModelChange",(function(e){return t.object.amount=e})),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](22,"div",8),o["\u0275\u0275elementStart"](23,"label"),o["\u0275\u0275text"](24,"Customer Name*"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](25,"app-select-customer",11),o["\u0275\u0275listener"]("onFinish",(function(e){return t.setCustomer(e)})),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](26,"hr"),o["\u0275\u0275elementStart"](27,"div",7),o["\u0275\u0275elementStart"](28,"div",8),o["\u0275\u0275elementStart"](29,"label"),o["\u0275\u0275text"](30,"Purpose of Payment "),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](31,"br"),o["\u0275\u0275elementStart"](32,"input",12),o["\u0275\u0275listener"]("ngModelChange",(function(e){return t.object.type=e})),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](33,"div",8),o["\u0275\u0275elementStart"](34,"label"),o["\u0275\u0275text"](35,"Invoice Number"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](36,"br"),o["\u0275\u0275elementStart"](37,"input",13),o["\u0275\u0275listener"]("ngModelChange",(function(e){return t.object.item_code=e})),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](38,"div",8),o["\u0275\u0275elementStart"](39,"label"),o["\u0275\u0275text"](40,"Payment Method*"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](41,"br"),o["\u0275\u0275elementStart"](42,"div"),o["\u0275\u0275elementStart"](43,"select",14),o["\u0275\u0275listener"]("ngModelChange",(function(e){return t.object.payment_method=e})),o["\u0275\u0275elementStart"](44,"option"),o["\u0275\u0275text"](45,"Cash"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](46,"option"),o["\u0275\u0275text"](47,"Mobile Money"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](48,"option"),o["\u0275\u0275text"](49,"Cheque"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](50,"option"),o["\u0275\u0275text"](51,"POS"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](52,"option"),o["\u0275\u0275text"](53,"Other"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](54,"hr"),o["\u0275\u0275elementStart"](55,"div",7),o["\u0275\u0275elementStart"](56,"div",8),o["\u0275\u0275elementStart"](57,"label"),o["\u0275\u0275text"](58,"Transaction Id/Reference/Cheque No.*"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](59,"br"),o["\u0275\u0275elementStart"](60,"input",15),o["\u0275\u0275listener"]("ngModelChange",(function(e){return t.object.transaction_id=e})),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](61,"div",8),o["\u0275\u0275elementStart"](62,"label"),o["\u0275\u0275text"](63,"Notes"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](64,"br"),o["\u0275\u0275elementStart"](65,"textarea",16),o["\u0275\u0275listener"]("ngModelChange",(function(e){return t.object.notes=e})),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](66,"input",17),o["\u0275\u0275element"](67,"input",18),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"]()),2&e&&(o["\u0275\u0275advance"](16),o["\u0275\u0275property"]("ngModel",t.object.date),o["\u0275\u0275advance"](5),o["\u0275\u0275property"]("ngModel",t.object.amount),o["\u0275\u0275advance"](4),o["\u0275\u0275property"]("type","select"),o["\u0275\u0275advance"](7),o["\u0275\u0275property"]("ngModel",t.object.type),o["\u0275\u0275advance"](5),o["\u0275\u0275property"]("ngModel",t.object.item_code),o["\u0275\u0275advance"](6),o["\u0275\u0275property"]("ngModel",t.object.payment_method),o["\u0275\u0275advance"](17),o["\u0275\u0275property"]("ngModel",t.object.transaction_id),o["\u0275\u0275advance"](5),o["\u0275\u0275property"]("ngModel",t.object.notes))},directives:[d.f,d.g,d.b,d.l,d.e,d.h,m.a,d.m,d.i,d.n],styles:[""]}),e})()}];let u=(()=>{class e{}return e.\u0275mod=o["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=o["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[r.f.forChild(h)],r.f]}),e})();var p=n("nEHF"),f=n("NFbv");let g=(()=>{class e{}return e.\u0275mod=o["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=o["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.b,u,p.a,f.a]]}),e})()},Ikxx:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{constructor(){}}},NFbv:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("ofXK"),r=n("nEHF"),s=n("fXoL");let o=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.b,r.a]]}),e})()},QQkv:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n("fXoL"),r=n("c92J"),s=n("ccyI"),o=n("1VJT"),a=n("ofXK"),l=n("mEfR"),c=n("3Pt+");function d(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"datalist",9),i["\u0275\u0275element"](1,"option",10),i["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;i["\u0275\u0275advance"](1),i["\u0275\u0275propertyInterpolate2"]("value","",e.name," (",e.phone,")")}}function m(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"option",10),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;i["\u0275\u0275propertyInterpolate"]("value",e.id),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate2"]("",e.name," ",e.phone," ")}}function h(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"span"),i["\u0275\u0275elementStart"](1,"select",11),i["\u0275\u0275listener"]("change",(function(){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().itemSelected()}))("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().selected=t})),i["\u0275\u0275template"](2,m,2,3,"option",12),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](3,"a",13),i["\u0275\u0275listener"]("click",(function(){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().addNew()})),i["\u0275\u0275element"](4,"i",14),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngModel",e.selected),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngForOf",e.objects)}}function u(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275elementStart"](1,"b"),i["\u0275\u0275text"](2,"Not found"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]())}const p=function(e){return{"select-product-active":e}};function f(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"li",21),i["\u0275\u0275listener"]("click",(function(){i["\u0275\u0275restoreView"](e);const n=t.$implicit;return i["\u0275\u0275nextContext"](3).add(n)})),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=t.index,r=i["\u0275\u0275nextContext"](3);i["\u0275\u0275property"]("ngClass",i["\u0275\u0275pureFunction1"](3,p,n==r.arrowkeyLocation)),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate2"](" ",e.name," (",e.phone,") ")}}function g(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",18),i["\u0275\u0275elementStart"](1,"ul",19),i["\u0275\u0275template"](2,f,2,5,"li",20),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e){const e=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngForOf",e.objects)}}function b(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275text"](1," No customer found. Check the spelling.\n"),i["\u0275\u0275elementEnd"]())}function v(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",15),i["\u0275\u0275elementStart"](1,"input",16),i["\u0275\u0275listener"]("keyup",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().keyUp(t)}))("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().param=t})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](2,u,3,0,"div",1),i["\u0275\u0275template"](3,g,3,1,"div",17),i["\u0275\u0275template"](4,b,2,0,"div",1),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngModel",e.param),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.objects.length<1&&e.is_finished_search),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.objects.length>0&&e.is_finished_search),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.objects.length<1&&e.is_finished_search)}}let y=(()=>{class e{constructor(e,t,n){this.dbService=e,this.authService=t,this.notify=n,this.onFinish=new i.EventEmitter,this.btn_text="Select",this.param="",this.objects=[],this.selected=null,this.is_searching=!1,this.is_finished_search=!1,this.error_search=!1,this.autocomplete=!1,this.autocomplete_list=[],this.onAdd=new i.EventEmitter,this.type="search",this.show="no",this.added=[],this.filter_param="",this.filter_results=[],this.arrowkeyLocation=0}ngOnInit(){this.getCustomers()}getCustomers(){this.dbService.getData("customer/getList",this.authService.current_user).subscribe(e=>{"1"==e.status&&(this.objects=e.data)},e=>{this.notify.failNotification("Unable to get customers. Check connection")})}ngOnChanges(){"search"==this.type&&this.search()}select_autocomplete(e){}addItem(){$("#add_customer_modal").modal("show")}itemAdded(e){this.objects.push(e),$("#add_customer_modal").modal("hide"),this.onFinish.emit(e)}search(){this.is_searching=!0,this.is_finished_search=!1,this.error_search=!1,this.dbService.getDataWithQuery("customer/search",this.authService.current_user,"param="+this.param).subscribe(e=>{"-1"===e.status?(this.is_searching=!1,this.is_finished_search=!1,this.error_search=!0):(this.objects=e.data,this.is_searching=!1,this.is_finished_search=!0,this.error_search=!1,this.selected=null)},e=>{this.is_searching=!1,this.is_finished_search=!1,this.error_search=!0})}add(e){this.onAdd.emit(e),console.log(e),this.is_finished_search=!1,$("#customer_search").focus(),this.param="",this.objects=[],this.arrowkeyLocation=0}select(e){this.selected=e,this.onFinish.emit(e)}itemSelected(){for(var e=0;e<this.objects.length;e++)if(this.objects[e].id==this.selected){this.onFinish.emit(this.objects[e]);break}}highlightObject(e){this.objects.map(e=>{e.selected=!1}),this.highlightedObject=e,e.selected=!0}keyUp(e){switch(e.keyCode){case 38:0==this.arrowkeyLocation||this.arrowkeyLocation--,$(".search_results").scrollTop(0),$(".search_results").scrollTop($(".select-product-active:first").offset().top-$(".search_results").height()+10),console.log($(".select-product-active:first").offset().top-$(".search_results").height()),this.focusCursor();break;case 40:this.arrowkeyLocation==this.objects.length-1||this.arrowkeyLocation++,$(".search_results").scrollTop(0),$(".search_results").scrollTop($(".select-product-active:first").offset().top-$(".search_results").height()+10),console.log($(".select-product-active:first").offset().top-$(".search_results").height()),this.focusCursor();break;case 13:let e=this.objects[this.arrowkeyLocation];null!=e&&null!=e&&this.add(e);break;case 27:this.hideSearchResults();break;default:this.arrowkeyLocation=0,this.search()}}focusCursor(){let e=$("#customer_search").val();$("#customer_search").val("").val(e)}hideSearchResults(){this.param="",this.objects.length=0,this.is_finished_search=!1}addNew(){$("#addCustomerModal").modal("show")}customerAdded(e){this.objects.push(e),this.selected=e.id,this.onFinish.emit(e),$("#addCustomerModal").modal("hide")}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](r.a),i["\u0275\u0275directiveInject"](s.a),i["\u0275\u0275directiveInject"](o.a))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-select-customer"]],inputs:{btn_text:"btn_text",param:"param",selected:"selected",autocomplete:"autocomplete",type:"type",show:"show",timestamp:"timestamp"},outputs:{onFinish:"onFinish",onAdd:"onAdd"},features:[i["\u0275\u0275NgOnChangesFeature"]],decls:11,vars:3,consts:[["id","customer_list",4,"ngFor","ngForOf"],[4,"ngIf"],["id","addCustomerModal","tabindex","-1","role","dialog",1,"modal","fade","in"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-body"],[3,"onFinish"],["class","focus_search",4,"ngIf"],["id","customer_list"],[3,"value"],["name","customer",3,"ngModel","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["title","add new customer",1,"btn-sm","btn-primary","btn",3,"click"],[1,"fa","fa-plus"],[1,"focus_search"],["autofocus","","autocomplete","off","placeholder","Enter customer name or phone","required","","type","text","id","customer_search","name","search",3,"ngModel","keyup","ngModelChange"],["class","search_results ","id","search_results_list",4,"ngIf"],["id","search_results_list",1,"search_results"],[1,"list-group"],["tabindex","-1","class","list-group-item",3,"ngClass","click",4,"ngFor","ngForOf"],["tabindex","-1",1,"list-group-item",3,"ngClass","click"]],template:function(e,t){1&e&&(i["\u0275\u0275template"](0,d,2,2,"datalist",0),i["\u0275\u0275template"](1,h,5,2,"span",1),i["\u0275\u0275elementStart"](2,"div",2),i["\u0275\u0275elementStart"](3,"div",3),i["\u0275\u0275elementStart"](4,"div",4),i["\u0275\u0275elementStart"](5,"div",5),i["\u0275\u0275elementStart"](6,"h5"),i["\u0275\u0275text"](7,"Add new Customer"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](8,"div",6),i["\u0275\u0275elementStart"](9,"app-customer-form",7),i["\u0275\u0275listener"]("onFinish",(function(e){return t.customerAdded(e)})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](10,v,5,4,"div",8)),2&e&&(i["\u0275\u0275property"]("ngForOf",t.objects),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf","select"==t.type),i["\u0275\u0275advance"](9),i["\u0275\u0275property"]("ngIf","search"==t.type))},directives:[a.i,a.j,l.a,c.i,c.n,c.m,c.e,c.h,c.b,c.l,a.h],styles:[".autocomplete-items[_ngcontent-%COMP%]:hover{background-color:#e9e9e9}"]}),e})()},mEfR:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("fXoL"),r=n("Ikxx"),s=n("c92J"),o=n("1VJT"),a=n("ccyI"),l=n("3Pt+");let c=(()=>{class e{constructor(e,t,n){this.dbService=e,this.notify=t,this.authService=n,this.error=!1,this.is_loading=!0,this.is_loaded=!1,this.onFinish=new i.EventEmitter,this.uploadUrl="admin/uploadPicture",this.url="customer/findById",null!=this.id&&null!=this.id||(this.customer=new r.a)}ngOnInit(){null==this.id||null==this.id||this.getCustomer(this.id)}uploadFinished(e){this.pic_location=e,this.customer.picture=e}getCustomer(e){this.dbService.getDataWithQuery(this.url,this.authService.current_user,"id="+this.id).subscribe(e=>{this.customer=e.data,this.is_loading=!1,this.is_loaded=!0,this.error=!1},e=>{this.is_loading=!1,this.error=!0,this.is_loaded=!1})}submit(){this.notify.showLoading();let e=new FormData;for(let t in this.customer)e.append(t,this.customer[t]);null!=this.id&&null!=this.id||e.append("createdAt",this.dbService.getToday()),e.append("display_name",this.authService.current_user.display_name),this.dbService.postData(e,"customer/save",this.authService.current_user).subscribe(e=>{this.notify.hideLoading(),"-1"===e.status?this.notify.failNotification("Unable to authenticate. Please login again"):"-9"===e.status?this.notify.showNotification("You are not permitted to perform this action","fail",3e3):(this.customer.id=e.status,this.notify.successNotification("Customer saved successfully"),this.onFinish.emit(this.customer),this.customer=new r.a)},e=>{this.notify.hideLoading(),this.notify.noConnectionNotification()})}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](s.a),i["\u0275\u0275directiveInject"](o.a),i["\u0275\u0275directiveInject"](a.a))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-customer-form"]],inputs:{id:"id"},outputs:{onFinish:"onFinish"},decls:36,vars:5,consts:[["ngNativeValidate","",3,"ngSubmit"],["n","ngForm"],[1,"row"],[1,"col-sm-6"],["required","","type","text","name","name",3,"ngModel","ngModelChange"],["required","","type","text","name","phone",3,"ngModel","ngModelChange"],["name","sex",3,"ngModel","ngModelChange"],["value","Male"],["value","Female"],["name","email","type","email",3,"ngModel","ngModelChange"],["name","date_of_birth","type","date",3,"ngModel","ngModelChange"],["type","submit","name","submit","value","Submit",1,"btn","btn-success"]],template:function(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"form",0,1),i["\u0275\u0275listener"]("ngSubmit",(function(){return t.submit()})),i["\u0275\u0275elementStart"](2,"b"),i["\u0275\u0275text"](3,"Fields marked * are required"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](4,"div",2),i["\u0275\u0275elementStart"](5,"div",3),i["\u0275\u0275elementStart"](6,"label"),i["\u0275\u0275text"](7,"Name*"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](8,"br"),i["\u0275\u0275elementStart"](9,"input",4),i["\u0275\u0275listener"]("ngModelChange",(function(e){return t.customer.name=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](10,"div",3),i["\u0275\u0275elementStart"](11,"label"),i["\u0275\u0275text"](12,"Phone*"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](13,"br"),i["\u0275\u0275elementStart"](14,"input",5),i["\u0275\u0275listener"]("ngModelChange",(function(e){return t.customer.phone=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](15,"div",3),i["\u0275\u0275elementStart"](16,"label"),i["\u0275\u0275text"](17,"Sex"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](18,"br"),i["\u0275\u0275elementStart"](19,"select",6),i["\u0275\u0275listener"]("ngModelChange",(function(e){return t.customer.sex=e})),i["\u0275\u0275elementStart"](20,"option",7),i["\u0275\u0275text"](21,"Male"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](22,"option",8),i["\u0275\u0275text"](23,"Female"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](24,"div",3),i["\u0275\u0275elementStart"](25,"label"),i["\u0275\u0275text"](26,"Email"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](27,"br"),i["\u0275\u0275elementStart"](28,"input",9),i["\u0275\u0275listener"]("ngModelChange",(function(e){return t.customer.email=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](29,"div",3),i["\u0275\u0275elementStart"](30,"label"),i["\u0275\u0275text"](31,"Date of Birth"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](32,"br"),i["\u0275\u0275elementStart"](33,"input",10),i["\u0275\u0275listener"]("ngModelChange",(function(e){return t.customer.date_of_birth=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](34,"div",3),i["\u0275\u0275element"](35,"input",11),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e&&(i["\u0275\u0275advance"](9),i["\u0275\u0275property"]("ngModel",t.customer.name),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",t.customer.phone),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",t.customer.sex),i["\u0275\u0275advance"](9),i["\u0275\u0275property"]("ngModel",t.customer.email),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",t.customer.date_of_birth))},directives:[l.f,l.g,l.b,l.l,l.e,l.h,l.m,l.i,l.n],styles:[""]}),e})()}}]);