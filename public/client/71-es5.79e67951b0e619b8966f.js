function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{"7b8J":function(e,t,n){"use strict";n.r(t),n.d(t,"PermissionMatrixModule",(function(){return S}));var i=n("ofXK"),o=n("tyNb"),r=n("fXoL"),a=n("c92J"),s=n("1VJT"),l=n("ccyI");function c(e,t){1&e&&(r["\u0275\u0275elementStart"](0,"div"),r["\u0275\u0275element"](1,"img",10),r["\u0275\u0275text"](2," Loading... "),r["\u0275\u0275elementEnd"]())}function d(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"th"),r["\u0275\u0275text"](1),r["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate"](n.role_name)}}function m(e,t){if(1&e){var n=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"span",23),r["\u0275\u0275listener"]("click",(function(){r["\u0275\u0275restoreView"](n);var e=r["\u0275\u0275nextContext"]().$implicit,t=r["\u0275\u0275nextContext"]().$implicit;return r["\u0275\u0275nextContext"](2).addPermission(e.role_id,t.permission.permission_id,t)})),r["\u0275\u0275elementStart"](1,"em",24),r["\u0275\u0275element"](2,"i",25),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"]()}if(2&e){var i=r["\u0275\u0275nextContext"]().$implicit,o=r["\u0275\u0275nextContext"]().$implicit;r["\u0275\u0275advance"](1),r["\u0275\u0275propertyInterpolate2"]("title","click to grant permission: ",o.permission.name," to role: ",i.role_name,"")}}function f(e,t){if(1&e){var n=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"span",23),r["\u0275\u0275listener"]("click",(function(){r["\u0275\u0275restoreView"](n);var e=r["\u0275\u0275nextContext"]().$implicit,t=r["\u0275\u0275nextContext"]().$implicit;return r["\u0275\u0275nextContext"](2).removePermission(e.role_id,t.permission.permission_id,t)})),r["\u0275\u0275elementStart"](1,"em",26),r["\u0275\u0275element"](2,"i",15),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"]()}if(2&e){var i=r["\u0275\u0275nextContext"]().$implicit,o=r["\u0275\u0275nextContext"]().$implicit;r["\u0275\u0275advance"](1),r["\u0275\u0275propertyInterpolate2"]("title","click to remove permission: ",o.permission.name," from role: ",i.role_name,"")}}function u(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"td",20),r["\u0275\u0275template"](1,m,3,2,"span",21),r["\u0275\u0275template"](2,f,3,2,"ng-template",null,22,r["\u0275\u0275templateRefExtractor"]),r["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=r["\u0275\u0275reference"](3),o=r["\u0275\u0275nextContext"]().$implicit;r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",-1==o.roles.indexOf(n.role_id))("ngIfElse",i)}}function p(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"tr"),r["\u0275\u0275elementStart"](1,"td"),r["\u0275\u0275text"](2),r["\u0275\u0275element"](3,"br"),r["\u0275\u0275elementStart"](4,"em",18),r["\u0275\u0275text"](5),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275template"](6,u,4,2,"td",19),r["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=r["\u0275\u0275nextContext"](2);r["\u0275\u0275advance"](2),r["\u0275\u0275textInterpolate"](n.permission.name),r["\u0275\u0275advance"](3),r["\u0275\u0275textInterpolate"](n.permission.description),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngForOf",i.roles)}}function h(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"div"),r["\u0275\u0275elementStart"](1,"table",11),r["\u0275\u0275elementStart"](2,"caption"),r["\u0275\u0275elementStart"](3,"em",12),r["\u0275\u0275element"](4,"i",13),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](5," = Role does not currently have this permission, "),r["\u0275\u0275elementStart"](6,"em",14),r["\u0275\u0275element"](7,"i",15),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](8," = Role currently has this permission "),r["\u0275\u0275element"](9,"br"),r["\u0275\u0275elementStart"](10,"em"),r["\u0275\u0275text"](11,"Click on a "),r["\u0275\u0275elementStart"](12,"em",14),r["\u0275\u0275element"](13,"i",15),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](14," to remove a permission from the role, or click on a "),r["\u0275\u0275elementStart"](15,"em",12),r["\u0275\u0275element"](16,"i",16),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](17," to add that permission to the role"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](18,"thead"),r["\u0275\u0275elementStart"](19,"tr"),r["\u0275\u0275element"](20,"th"),r["\u0275\u0275template"](21,d,2,1,"th",17),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275template"](22,p,7,3,"tr",17),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"]()),2&e){var n=r["\u0275\u0275nextContext"]();r["\u0275\u0275advance"](21),r["\u0275\u0275property"]("ngForOf",n.roles),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngForOf",n.objects)}}function v(e,t){if(1&e){var n=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"div",3),r["\u0275\u0275text"](1," Unable to connect to server. Please check your connection. "),r["\u0275\u0275elementStart"](2,"a",4),r["\u0275\u0275listener"]("click",(function(){return r["\u0275\u0275restoreView"](n),r["\u0275\u0275nextContext"]().start()})),r["\u0275\u0275text"](3,"Try Again"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"]()}}var g,x,y,_=[{path:"",component:(g=function(){function e(t,n,i){_classCallCheck(this,e),this.dbService=t,this.notify=n,this.authService=i,this.objects=[],this.is_loading=!1,this.error=!1,this.is_loaded=!1,this.url="admin/permissionMatrix",this.roles=[],this.is_loading_roles=!1,this.error_roles=!1,this.is_loaded_roles=!1,-1==this.authService.current_user.permissions.indexOf("Manage Roles")&&(this.goBack(),this.notify.failNotification("You are not permitted to view this page"))}return _createClass(e,[{key:"ngOnInit",value:function(){this.start(),this.getRoles()}},{key:"start",value:function(){var e=this;this.is_loaded=!1,this.is_loading=!0,this.dbService.getData(this.url,this.authService.current_user).subscribe((function(t){"-1"===t.status&&(e.notify.failNotification("Internal server error. Please check to make sure the registration number does not already exist"),e.error=!0),"-9"===t.status?(e.notify.showNotification("You are not permitted to perform this action","fail",3e3),e.error=!0):(e.objects=t.data,e.is_loaded=!0,e.error=!1),e.is_loading=!1}),(function(t){e.notify.noConnectionNotification(),e.is_loaded=!1,e.is_loading=!1,e.error=!0}))}},{key:"getRoles",value:function(){var e=this;this.is_loaded=!1,this.is_loading=!0,this.dbService.getData("admin/getRoles",this.authService.current_user).subscribe((function(t){"-1"===t.status&&(e.notify.failNotification("Internal server error. Please check to make sure the registration number does not already exist"),e.error=!0),"-9"===t.status?(e.notify.showNotification("You are not permitted to perform this action","fail",3e3),e.error=!0):(e.roles=t.data,e.is_loaded_roles=!0,e.error_roles=!1),e.is_loading_roles=!1}),(function(t){e.notify.noConnectionNotification(),e.is_loaded_roles=!1,e.is_loading_roles=!1,e.error_roles=!0}))}},{key:"addPermission",value:function(e,t,n){var i=this;this.notify.showLoading();var o=new FormData;o.append("role_id",e),o.append("permission_id",t),this.dbService.postData(o,"admin/addRolePermission",this.authService.current_user).subscribe((function(t){i.notify.hideLoading(),"-1"===t.status?i.notify.failNotification("Unable to authenticate. Please login again"):"-9"===t.status?i.notify.showNotification("You are not permitted to perform this action","fail",3e3):(i.notify.successNotification("Permission added to role successfully"),n.roles.push(e))}),(function(e){i.notify.noConnectionNotification()}))}},{key:"removePermission",value:function(e,t,n){var i=this;this.notify.showLoading();var o=new FormData;o.append("role_id",e),o.append("permission_id",t),this.dbService.postData(o,"admin/deleteRolePermission",this.authService.current_user).subscribe((function(t){i.notify.hideLoading(),"-1"===t.status?i.notify.failNotification("Unable to authenticate. Please login again"):"-9"===t.status?i.notify.showNotification("You are not permitted to perform this action","fail",3e3):(i.notify.successNotification("Permission removed from role successfully"),n.roles.splice(n.roles.indexOf(e),1))}),(function(e){i.notify.noConnectionNotification()}))}},{key:"goBack",value:function(){window.history.back()}}]),e}(),g.\u0275fac=function(e){return new(e||g)(r["\u0275\u0275directiveInject"](a.a),r["\u0275\u0275directiveInject"](s.a),r["\u0275\u0275directiveInject"](l.a))},g.\u0275cmp=r["\u0275\u0275defineComponent"]({type:g,selectors:[["app-permission-matrix"]],decls:13,vars:3,consts:[[1,"content"],[1,"container-fluid"],[1,"block-header"],[1,""],[1,"btn","btn-primary",3,"click"],[1,"row","clear-fix"],[1,"card"],[1,"body","table-responsive"],[4,"ngIf"],["class","",4,"ngIf"],["src","../../assets/images/ripple.gif","height","50","alt","loading"],[1,"table","table-bordered","table-striped"],[1,"text-danger"],[1,"fa","fa-trash-alt"],[1,"text-success"],[1,"fa","fa-check"],[1,"fa","fa-remove"],[4,"ngFor","ngForOf"],[1,"text-muted"],["class","text-center",4,"ngFor","ngForOf"],[1,"text-center"],["class","fill_box",3,"click",4,"ngIf","ngIfElse"],["has_it",""],[1,"fill_box",3,"click"],[1,"text-danger",3,"title"],[1,"fa","fa-minus"],[1,"text-success",3,"title"]],template:function(e,t){1&e&&(r["\u0275\u0275elementStart"](0,"section",0),r["\u0275\u0275elementStart"](1,"div",1),r["\u0275\u0275elementStart"](2,"div",2),r["\u0275\u0275elementStart"](3,"h2",3),r["\u0275\u0275elementStart"](4,"a",4),r["\u0275\u0275listener"]("click",(function(){return t.goBack()})),r["\u0275\u0275text"](5,"Back"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](6," PERMISSION MATRIX "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](7,"div",5),r["\u0275\u0275elementStart"](8,"div",6),r["\u0275\u0275elementStart"](9,"div",7),r["\u0275\u0275template"](10,c,3,0,"div",8),r["\u0275\u0275template"](11,h,23,2,"div",8),r["\u0275\u0275template"](12,v,4,0,"div",9),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"]()),2&e&&(r["\u0275\u0275advance"](10),r["\u0275\u0275property"]("ngIf",t.is_loading),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",t.is_loaded&&t.is_loaded_roles),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",t.error))},directives:[i.j,i.i],styles:[""]}),g)}],b=((y=function e(){_classCallCheck(this,e)}).\u0275mod=r["\u0275\u0275defineNgModule"]({type:y}),y.\u0275inj=r["\u0275\u0275defineInjector"]({factory:function(e){return new(e||y)},imports:[[o.f.forChild(_)],o.f]}),y),S=((x=function e(){_classCallCheck(this,e)}).\u0275mod=r["\u0275\u0275defineNgModule"]({type:x}),x.\u0275inj=r["\u0275\u0275defineInjector"]({factory:function(e){return new(e||x)},imports:[[i.b,b]]}),x)}}]);