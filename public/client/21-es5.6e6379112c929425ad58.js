function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"4j6H":function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var i=n("fXoL"),a=n("c92J"),r=n("1VJT"),o=n("BbYg"),l=n("ccyI"),s=n("ofXK"),c=n("3Pt+"),d=n("hiAm"),m=n("tyNb");function u(e,t){1&e&&i["\u0275\u0275element"](0,"app-loading")}function h(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275elementStart"](1,"h4"),i["\u0275\u0275text"](2,"Not found"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]())}function p(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"option",17),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;i["\u0275\u0275propertyInterpolate"]("value",n.id),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"](" ",n.name," ")}}function f(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275elementStart"](1,"label"),i["\u0275\u0275text"](2,"Select Product"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](3,"select",15),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"](2).select_product=e}))("change",(function(){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"](2).productSelected()})),i["\u0275\u0275template"](4,p,2,2,"option",16),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){var a=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngModel",a.select_product),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngForOf",a.objects)}}function _(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",11),i["\u0275\u0275elementStart"](1,"div",12),i["\u0275\u0275elementStart"](2,"button",13),i["\u0275\u0275listener"]("click",(function(){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().addProduct()})),i["\u0275\u0275text"](3,"Add Product"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](4,u,1,0,"app-loading",14),i["\u0275\u0275template"](5,h,3,0,"div",14),i["\u0275\u0275template"](6,f,5,2,"div",14),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){var a=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("ngIf",a.is_searching),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",a.error_search),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",a.is_finished_search)}}function g(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275elementStart"](1,"b"),i["\u0275\u0275text"](2,"Not found"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]())}var v=function(e){return{"select-product-active":e}};function y(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"li",24),i["\u0275\u0275listener"]("click",(function(){i["\u0275\u0275restoreView"](n);var e=t.$implicit;return i["\u0275\u0275nextContext"](3).add(e)})),i["\u0275\u0275text"](1),i["\u0275\u0275element"](2,"br"),i["\u0275\u0275text"](3),i["\u0275\u0275elementEnd"]()}if(2&e){var a=t.$implicit,r=t.index,o=i["\u0275\u0275nextContext"](3);i["\u0275\u0275property"]("ngClass",i["\u0275\u0275pureFunction1"](7,v,r==o.arrowkeyLocation)),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"](" ",a.name," "),i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate5"](" [price: ",a.price,"/",a.unit,"] [stock: ",a.stock,"] [shelf: ",a.shelf,"] [expiry: ",a.expiry,"] ")}}function b(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",21),i["\u0275\u0275elementStart"](1,"ul",22),i["\u0275\u0275template"](2,y,4,9,"li",23),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e){var n=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngForOf",n.objects)}}function S(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275text"](1," Item not found. Check the spelling. Or "),i["\u0275\u0275elementStart"](2,"a",25),i["\u0275\u0275element"](3,"i",26),i["\u0275\u0275text"](4," click here to add a new product"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]())}function x(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",18),i["\u0275\u0275elementStart"](1,"input",19),i["\u0275\u0275listener"]("keyup",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().keyUp(e)}))("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().param=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](2,g,3,0,"div",14),i["\u0275\u0275template"](3,b,3,1,"div",20),i["\u0275\u0275template"](4,S,5,0,"div",14),i["\u0275\u0275elementEnd"]()}if(2&e){var a=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngModel",a.param),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",a.error_search),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",a.objects.length>0&&a.is_finished_search),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",a.objects.length<1&&a.is_finished_search)}}var E=function(){var e=function(){function e(t,n,a,r){_classCallCheck(this,e),this.dbService=t,this.notify=n,this.localforage=a,this.authService=r,this.onFinish=new i.EventEmitter,this.btn_text="Select",this.onAdd=new i.EventEmitter,this.type="search",this.show="no",this.param="",this.objects=[],this.selected=null,this.is_searching=!1,this.is_finished_search=!1,this.error_search=!1,this.added=[],this.filter_param="",this.filter_results=[],this.local_products=[],this.show_shelf=!0,this.show_expiry=!0,this.show_stock=!0,this.arrowkeyLocation=0,this.num_items=10,$(".search_results").on("click",(function(){$("#sales_search").focus()}))}return _createClass(e,[{key:"ngOnInit",value:function(){"list"!=this.type&&"select"!=this.type||this.list();var e=localStorage.getItem("show_select_product_expiry");this.show_expiry=null==e||"yes"==e;var t=localStorage.getItem("show_select_product_stock");this.show_stock=null==t||"yes"==t;var n=localStorage.getItem("show_select_product_shelf");this.show_shelf=null==n||"yes"==n}},{key:"hideSearchResults",value:function(){this.param="",this.objects.length=0,this.is_finished_search=!1}},{key:"ngOnChanges",value:function(){$("#sales_search").focus()}},{key:"productSelected",value:function(){for(var e=0;e<this.objects.length;e++)if(this.objects[e].id==this.select_product){this.onAdd.emit(this.objects[e]);break}}},{key:"addProduct",value:function(){$("#add_product_modal").modal("show")}},{key:"productAdded",value:function(e){e.price=parseFloat(e.price),this.objects.push(e),this.onAdd.emit(e),$("#add_product_modal").modal("hide")}},{key:"list",value:function(){var e=this;this.is_searching=!0,this.is_finished_search=!1,this.error_search=!1,this.dbService.getData("product/getList",this.authService.current_user).subscribe((function(t){"-1"===t.status?(e.is_searching=!1,e.is_finished_search=!1,e.error_search=!0):(e.objects=t.data,e.filter_results="yes"==e.show?e.objects:[],e.is_searching=!1,e.is_finished_search=!0,e.error_search=!1)}),(function(t){e.is_searching=!1,e.is_finished_search=!1,e.error_search=!1}))}},{key:"filterlist",value:function(){var e=this.filter_param;this.filter_results=null==e||null==e||e.length<1?"yes"==this.show?this.objects:[]:this.objects.filter((function(t){return t.name.toLowerCase().includes(e.toLowerCase())}))}},{key:"add",value:function(e){this.onAdd.emit(e),this.is_finished_search=!1,$("#sales_search").focus(),this.param="",this.objects=[],this.arrowkeyLocation=0}},{key:"search",value:function(){var e=this;if(""==this.param.trim()||null==this.param||null==this.param)return this.objects=[],void(this.is_finished_search=!1);this.is_searching=!0,this.is_finished_search=!1,this.error_search=!1,this.dbService.getDataWithQuery("product/search",this.authService.current_user,"param="+this.param+"&limit="+this.num_items).subscribe((function(t){"-1"===t.status?(e.is_searching=!1,e.is_finished_search=!1,e.error_search=!0):(e.objects=t.data,e.is_searching=!1,e.is_finished_search=!0,e.error_search=!1,e.selected=null)}),(function(t){e.is_searching=!1,e.is_finished_search=!1,e.error_search=!1}))}},{key:"localSearch",value:function(){var e=this;this.is_searching=!0,this.localforage.getItem(this.dbService.PRODUCT_LIST_KEY).subscribe((function(t){if(e.local_products=t,e.is_finished_search=!1,e.error_search=!1,e.param.length<1)return e.objects=[],e.is_searching=!1,e.is_finished_search=!1,e.error_search=!1,!1;if(null==e.local_products)return e.objects=[],e.notify.failNotification("No Products! Please refresh the page"),e.is_searching=!1,e.is_finished_search=!1,e.error_search=!1,!1;var n=e.param.toLowerCase().trim(),i=n.split(" "),a=e.local_products.filter((function(e){for(var t=0;t<i.length;t++)if(-1==e.name.toLowerCase().indexOf(i[t])&&e.barcode!=i[t])return!1;return!0}));a.sort((function(e,t){var i=e.name.toLowerCase(),a=t.name.toLowerCase();return i.indexOf(n)<a.indexOf(n)?-1:i>a?1:0})),e.objects=a.slice(0,a.length>e.num_items?e.num_items-1:a.length),e.is_searching=!1,e.is_finished_search=!0,e.error_search=!1}),(function(t){e.notify.failNotification("Failed to get products. Please refresh the page")}))}},{key:"select",value:function(e){this.selected=e,this.onFinish.emit(e)}},{key:"highlightObject",value:function(e){this.objects.map((function(e){e.selected=!1})),this.highlightedObject=e,e.selected=!0}},{key:"keyUp",value:function(e){switch(e.keyCode){case 38:0==this.arrowkeyLocation||this.arrowkeyLocation--,$(".search_results").scrollTop(0),$(".search_results").scrollTop($(".select-product-active:first").offset().top-$(".search_results").height()+10),console.log($(".select-product-active:first").offset().top-$(".search_results").height()),this.focusCursor();break;case 40:this.arrowkeyLocation==this.objects.length-1||this.arrowkeyLocation++,$(".search_results").scrollTop(0),$(".search_results").scrollTop($(".select-product-active:first").offset().top-$(".search_results").height()+10),console.log($(".select-product-active:first").offset().top-$(".search_results").height()),this.focusCursor();break;case 13:var t=this.objects[this.arrowkeyLocation];null!=t&&null!=t&&this.add(t);break;case 27:this.hideSearchResults();break;default:this.arrowkeyLocation=0,"offline"==this.dbService.ENVIRONMENT?this.search():this.localSearch()}}},{key:"focusCursor",value:function(){var e=$("#sales_search").val();$("#sales_search").val("").val(e)}},{key:"setShowStock",value:function(e){e.target.checked?(console.log("true"),this.show_stock=!0,localStorage.setItem("show_select_product_stock","yes")):(this.show_stock=!1,localStorage.setItem("show_select_product_stock","no"))}},{key:"showSettings",value:function(){$("#select_product_settings_modal").modal("show")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](a.a),i["\u0275\u0275directiveInject"](r.a),i["\u0275\u0275directiveInject"](o.LocalForageService),i["\u0275\u0275directiveInject"](l.a))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-select-product"]],inputs:{btn_text:"btn_text",type:"type",show:"show",timestamp:"timestamp"},outputs:{onFinish:"onFinish",onAdd:"onAdd"},features:[i["\u0275\u0275NgOnChangesFeature"]],decls:41,vars:6,consts:[["class","",4,"ngIf"],["class","focus_search",4,"ngIf"],["id","select_product_settings_modal","tabindex","-1","role","dialog",1,"modal","fade"],["role","document",1,"modal-dialog","modal"],[1,"modal-content"],[1,"modal-header"],[1,"modal-body"],[1,"form-group"],[3,"ngModel","change","ngModelChange"],["type","checkbox",3,"ngModel","change","ngModelChange"],["type","checkbox",3,"ngModel","ngModelChange"],[1,""],[1,"body"],[1,"btn","btn-inverse","btn-sm",3,"click"],[4,"ngIf"],["name","products",1,"product",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"focus_search"],["autofocus","","autocomplete","off","placeholder","Enter product names or barcode","required","","type","text","id","sales_search","name","search",3,"ngModel","keyup","ngModelChange"],["class","search_results ","id","search_results_list",4,"ngIf"],["id","search_results_list",1,"search_results"],[1,"list-group"],["tabindex","-1","class","list-group-item",3,"ngClass","click",4,"ngFor","ngForOf"],["tabindex","-1",1,"list-group-item",3,"ngClass","click"],["routerLink","/add_product"],[1,"feather","icon-plus"]],template:function(e,t){1&e&&(i["\u0275\u0275template"](0,_,7,3,"div",0),i["\u0275\u0275template"](1,x,5,4,"div",1),i["\u0275\u0275elementStart"](2,"div",2),i["\u0275\u0275elementStart"](3,"div",3),i["\u0275\u0275elementStart"](4,"div",4),i["\u0275\u0275elementStart"](5,"div",5),i["\u0275\u0275elementStart"](6,"h5"),i["\u0275\u0275text"](7,"Settings for Product Select"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](8,"div",6),i["\u0275\u0275elementStart"](9,"div",7),i["\u0275\u0275elementStart"](10,"label"),i["\u0275\u0275text"](11,"Number of Items to Display"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](12,"br"),i["\u0275\u0275elementStart"](13,"select",8),i["\u0275\u0275listener"]("change",(function(e){return t.keyUp(e)}))("ngModelChange",(function(e){return t.num_items=e})),i["\u0275\u0275elementStart"](14,"option"),i["\u0275\u0275text"](15,"10"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](16,"option"),i["\u0275\u0275text"](17,"25"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](18,"option"),i["\u0275\u0275text"](19,"50"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](20,"option"),i["\u0275\u0275text"](21,"100"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](22,"option"),i["\u0275\u0275text"](23,"250"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](24,"div",7),i["\u0275\u0275elementStart"](25,"label"),i["\u0275\u0275text"](26,"Extra Info to display for each"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](27,"br"),i["\u0275\u0275elementStart"](28,"label"),i["\u0275\u0275elementStart"](29,"input",9),i["\u0275\u0275listener"]("change",(function(e){return t.setShowStock(e)}))("ngModelChange",(function(e){return t.show_stock=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](30," Stock"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](31," \xa0 "),i["\u0275\u0275element"](32,"br"),i["\u0275\u0275elementStart"](33,"label"),i["\u0275\u0275elementStart"](34,"input",10),i["\u0275\u0275listener"]("ngModelChange",(function(e){return t.show_expiry=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](35," Expiry"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](36," \xa0 "),i["\u0275\u0275elementStart"](37,"label"),i["\u0275\u0275elementStart"](38,"input",10),i["\u0275\u0275listener"]("ngModelChange",(function(e){return t.show_shelf=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](39," Shelf"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](40," \xa0 "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e&&(i["\u0275\u0275property"]("ngIf","select"==t.type),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf","search"==t.type),i["\u0275\u0275advance"](12),i["\u0275\u0275property"]("ngModel",t.num_items),i["\u0275\u0275advance"](16),i["\u0275\u0275property"]("ngModel",t.show_stock),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",t.show_expiry),i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("ngModel",t.show_shelf))},directives:[s.j,c.m,c.e,c.h,c.i,c.n,c.a,d.a,s.i,c.b,c.l,s.h,m.e],styles:[".link[_ngcontent-%COMP%]{cursor:pointer;text-decoration:underline}"]}),e}()},TFay:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("fXoL"),a=n("mS1k"),r=n("c92J"),o=n("bgkY"),l=n("1VJT"),s=n("ccyI"),c=n("ofXK"),d=n("3Pt+"),m=n("jr2M");function u(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"option",24),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;i["\u0275\u0275propertyInterpolate"]("value",n),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate"](n)}}function h(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"input",25),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"](2).object.unit=e})),i["\u0275\u0275elementEnd"]()}if(2&e){var a=i["\u0275\u0275nextContext"](2);i["\u0275\u0275property"]("ngModel",a.object.unit)}}function p(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"input",26),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"](2).object.category=e})),i["\u0275\u0275elementEnd"]()}if(2&e){var a=i["\u0275\u0275nextContext"](2);i["\u0275\u0275property"]("ngModel",a.object.category)}}function f(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",5),i["\u0275\u0275elementStart"](1,"label"),i["\u0275\u0275text"](2,"Starting stock*"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](3,"br"),i["\u0275\u0275elementStart"](4,"input",27),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"](2).object.stock=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){var a=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("ngModel",a.object.stock)}}function _(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",5),i["\u0275\u0275elementStart"](1,"label"),i["\u0275\u0275text"](2,"Current stock*"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](3,"br"),i["\u0275\u0275elementStart"](4,"label"),i["\u0275\u0275elementStart"](5,"input",28),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"](2).change_stock=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](6," Update Current Stock"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](7,"input",29),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"](2).object.stock=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){var a=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",a.change_stock),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("disabled",!a.change_stock)("ngModel",a.object.stock)}}function g(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"form",1,2),i["\u0275\u0275listener"]("ngSubmit",(function(){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().submit()})),i["\u0275\u0275elementStart"](2,"div",3),i["\u0275\u0275elementStart"](3,"em"),i["\u0275\u0275text"](4,"Fields marked * are required"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](5,"div",4),i["\u0275\u0275elementStart"](6,"div",5),i["\u0275\u0275elementStart"](7,"label"),i["\u0275\u0275text"](8,"Product Name"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](9,"br"),i["\u0275\u0275elementStart"](10,"input",6),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().object.name=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](11,"div",5),i["\u0275\u0275elementStart"](12,"label"),i["\u0275\u0275text"](13,"Cost Price*"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](14,"br"),i["\u0275\u0275elementStart"](15,"input",7),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().object.cost_price=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](16,"div",5),i["\u0275\u0275elementStart"](17,"label"),i["\u0275\u0275text"](18," Selling Price*"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](19,"br"),i["\u0275\u0275elementStart"](20,"input",8),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().object.price=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](21,"div",4),i["\u0275\u0275elementStart"](22,"div",5),i["\u0275\u0275elementStart"](23,"label"),i["\u0275\u0275text"](24,"Unit"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](25,"br"),i["\u0275\u0275elementStart"](26,"select",9),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().unit_selected=e})),i["\u0275\u0275template"](27,u,2,2,"option",10),i["\u0275\u0275elementStart"](28,"option",11),i["\u0275\u0275text"](29,"Other"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](30,h,1,1,"input",12),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](31,"div",5),i["\u0275\u0275elementStart"](32,"label"),i["\u0275\u0275text"](33,"Category"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](34,"br"),i["\u0275\u0275elementStart"](35,"div"),i["\u0275\u0275elementStart"](36,"app-select-product-category",13),i["\u0275\u0275listener"]("onFinish",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().categorySelected(e)})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](37,p,1,1,"input",14),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](38,f,5,1,"div",15),i["\u0275\u0275template"](39,_,8,3,"div",15),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](40,"div",4),i["\u0275\u0275elementStart"](41,"div",5),i["\u0275\u0275elementStart"](42,"label"),i["\u0275\u0275text"](43,"Minimum stock*"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](44,"br"),i["\u0275\u0275elementStart"](45,"input",16),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().object.min_stock=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](46,"div",5),i["\u0275\u0275elementStart"](47,"label"),i["\u0275\u0275text"](48,"Maximum stock"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](49,"br"),i["\u0275\u0275elementStart"](50,"input",17),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().object.max_stock=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](51,"div",5),i["\u0275\u0275elementStart"](52,"label"),i["\u0275\u0275text"](53,"Closest expiry"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](54,"br"),i["\u0275\u0275elementStart"](55,"input",18),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().object.expiry=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](56,"div",4),i["\u0275\u0275elementStart"](57,"div",5),i["\u0275\u0275elementStart"](58,"label"),i["\u0275\u0275text"](59,"Shelf/Location"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](60,"br"),i["\u0275\u0275elementStart"](61,"input",19),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().object.shelf=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](62,"div",5),i["\u0275\u0275elementStart"](63,"label"),i["\u0275\u0275text"](64,"Barcode"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](65,"br"),i["\u0275\u0275elementStart"](66,"input",20),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().object.barcode=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](67,"div",5),i["\u0275\u0275elementStart"](68,"label"),i["\u0275\u0275text"](69,"Notes"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](70,"br"),i["\u0275\u0275elementStart"](71,"textarea",21),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().object.notes=e})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](72,"input",22),i["\u0275\u0275element"](73,"input",23),i["\u0275\u0275elementEnd"]()}if(2&e){var a=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](10),i["\u0275\u0275property"]("ngModel",a.object.name),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",a.object.cost_price),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",a.object.price),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("ngModel",a.unit_selected),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngForOf",a.units),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf","other"==a.unit_selected),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("selected",a.object.category),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf","other"==a.category_selected),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",null==a.id),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",null!==a.id),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("ngModel",a.object.min_stock),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",a.object.max_stock),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",a.object.expiry),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("ngModel",a.object.shelf),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",a.object.barcode),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",a.object.notes)}}var v=function(){var e=function(){function e(t,n,r,o){_classCallCheck(this,e),this.dbService=t,this.socket=n,this.notify=r,this.authService=o,this.error=!1,this.is_loading=!0,this.is_loaded=!1,this.onFinish=new i.EventEmitter,this.units=["ampoule","bottle","box","capsule","carton","glove","inhaler","pack","pessary","piece","roll","strip","suppository","syringe","tablet","tube","vial"],this.unit_selected="",this.category_selected="",this.uploadUrl="admin/uploadPicture",this.can_master_edit=!0,this.can_edit=!0,this.change_stock=!1,this.object=new a.a,this.units=this.dbService.units}return _createClass(e,[{key:"ngOnInit",value:function(){null==this.id||null==this.id||this.getobject(this.id)}},{key:"ngOnChanges",value:function(){null==this.id||null==this.id||this.getobject(this.id)}},{key:"getobject",value:function(e){var t=this;this.dbService.getDataWithQuery("product/findById",this.authService.current_user,"id="+this.id).subscribe((function(e){if(t.object=e.data,t.unit_selected=t.object.unit,t.pic_location=t.object.picture,null!=t.object.picture){var n=t.object.picture.split("/");t.object.picture=n.pop()}t.is_loading=!1,t.is_loaded=!0,t.error=!1}),(function(e){t.is_loading=!1,t.error=!0,t.is_loaded=!1}))}},{key:"categorySelected",value:function(e){this.category_selected=e,"other"!=this.category_selected&&(this.object.category=e)}},{key:"uploadFinished",value:function(e){this.pic_location=e,this.object.picture=e}},{key:"submit",value:function(){var e=this;this.notify.showLoading(),"other"!=this.unit_selected&&(this.object.unit=this.unit_selected);var t=new FormData;for(var n in this.object)t.append(n,this.object[n]);null!=this.id&&null!=this.id||t.append("createdAt",this.dbService.getToday()),t.append("display_name",this.authService.current_user.display_name),null!=this.object.notes&&null!=this.object.notes||t.append("notes",""),t.append("change_stock",this.change_stock?"yes":"no"),this.dbService.postData(t,"product/saveBranchDetails",this.authService.current_user).subscribe((function(t){e.notify.hideLoading(),"0"===t.status?e.notify.failNotification("Unable to authenticate. Please login again"):"-9"===t.status?e.notify.showNotification("You are not permitted to perform this action","fail",3e3):"-1"===t.status?e.notify.showNotification("Server error. Please contact admin","fail",3e3):(null!=e.id&&null!=e.id||(e.object.id=t.status),e.notify.successNotification("Product saved successfully"),e.socket.sendEvent({company_id:e.authService.current_user.company_id,parent_company_id:e.authService.current_user.parent_company,message:"Product update received:  ".concat(e.object.name),product:e.object,event:"product_update"}),e.onFinish.emit(e.object),e.object=new a.a)}),(function(t){e.notify.noConnectionNotification()}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](r.a),i["\u0275\u0275directiveInject"](o.a),i["\u0275\u0275directiveInject"](l.a),i["\u0275\u0275directiveInject"](s.a))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-product-form"]],inputs:{id:"id"},outputs:{onFinish:"onFinish"},features:[i["\u0275\u0275NgOnChangesFeature"]],decls:1,vars:1,consts:[["ngNativeValidate","",3,"ngSubmit",4,"ngIf"],["ngNativeValidate","",3,"ngSubmit"],["n","ngForm"],[1,""],[1,"row","bottom-margin"],[1,"col-md-4"],["required","","type","text","name","name",1,"form-control",3,"ngModel","ngModelChange"],["required","","type","text","name","cost_price",1,"form-control",3,"ngModel","ngModelChange"],["required","","type","text","name","price",3,"ngModel","ngModelChange"],["name","unit",1,"",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["value","other"],["class","form-control","type","text","name","unit",3,"ngModel","ngModelChange",4,"ngIf"],[3,"selected","onFinish"],["class","form-control","required","","type","text","name","category",3,"ngModel","ngModelChange",4,"ngIf"],["class","col-md-4",4,"ngIf"],["value","1","required","","type","text","name","min_stock",1,"form-control",3,"ngModel","ngModelChange"],["value","10","required","","type","text","name","max_stock",1,"form-control",3,"ngModel","ngModelChange"],["required","","type","date","name","expiry",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","shelf",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","barcode",1,"form-control",3,"ngModel","ngModelChange"],["name","notes","rows","3","cols","40",1,"form-control",3,"ngModel","ngModelChange"],["type","submit","name","submit","value","Submit",1,"btn","btn-success"],["type","reset","name","reset","value","Reset",1,"btn","btn-warning"],[3,"value"],["type","text","name","unit",1,"form-control",3,"ngModel","ngModelChange"],["required","","type","text","name","category",1,"form-control",3,"ngModel","ngModelChange"],["value","0","required","","type","text","name","stock",1,"form-control",3,"ngModel","ngModelChange"],["type","checkbox","name","change_stock",3,"ngModel","ngModelChange"],["required","","type","text","name","stock",1,"form-control",3,"disabled","ngModel","ngModelChange"]],template:function(e,t){1&e&&i["\u0275\u0275template"](0,g,74,16,"form",0),2&e&&i["\u0275\u0275property"]("ngIf",t.can_edit)},directives:[c.j,d.f,d.g,d.b,d.l,d.e,d.h,d.m,c.i,d.i,d.n,m.a,d.a],styles:[""]}),e}()},"a/do":function(e,t,n){"use strict";n.r(t),n.d(t,"NewSaleModule",(function(){return z}));var i=n("ofXK"),a=n("tyNb"),r=n("XC36"),o=function e(){_classCallCheck(this,e)},l=function e(){_classCallCheck(this,e)},s=n("fXoL"),c=n("c92J"),d=n("bgkY"),m=n("1VJT"),u=n("eJvr"),h=n("ccyI"),p=n("4j6H"),f=n("3Pt+"),_=n("yGzR"),g=n("TFay"),v=n("6QD7");function y(e,t){if(1&e&&s["\u0275\u0275element"](0,"option",67),2&e){var n=t.$implicit;s["\u0275\u0275propertyInterpolate2"]("value","",n.name," (",n.phone,")")}}function b(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"em",76),s["\u0275\u0275element"](1,"br"),s["\u0275\u0275element"](2,"i",77),s["\u0275\u0275text"](3," Possibly expired"),s["\u0275\u0275elementEnd"]())}function S(e,t){1&e&&s["\u0275\u0275element"](0,"i",78)}var x=function(e){return{"table-warning":e}};function E(e,t){if(1&e){var n=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"tr",68),s["\u0275\u0275elementStart"](1,"td"),s["\u0275\u0275text"](2),s["\u0275\u0275template"](3,b,4,0,"em",69),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](4,"td"),s["\u0275\u0275text"](5),s["\u0275\u0275element"](6,"br"),s["\u0275\u0275elementStart"](7,"button",70),s["\u0275\u0275listener"]("click",(function(){s["\u0275\u0275restoreView"](n);var e=t.$implicit;return s["\u0275\u0275nextContext"]().editItem(e)})),s["\u0275\u0275text"](8," ... "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](9,"button",71),s["\u0275\u0275listener"]("click",(function(){s["\u0275\u0275restoreView"](n);var e=t.$implicit;return s["\u0275\u0275nextContext"]().increment(e)})),s["\u0275\u0275text"](10," +1 "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](11,"button",72),s["\u0275\u0275listener"]("click",(function(){s["\u0275\u0275restoreView"](n);var e=t.$implicit;return s["\u0275\u0275nextContext"]().decrement(e)})),s["\u0275\u0275text"](12," -1 "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](13,"td"),s["\u0275\u0275text"](14),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](15,"td"),s["\u0275\u0275text"](16),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](17,"td"),s["\u0275\u0275text"](18),s["\u0275\u0275template"](19,S,1,0,"i",73),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](20,"td"),s["\u0275\u0275elementStart"](21,"button",74),s["\u0275\u0275listener"]("click",(function(){s["\u0275\u0275restoreView"](n);var e=t.$implicit;return s["\u0275\u0275nextContext"]().removeItem(e)})),s["\u0275\u0275element"](22,"i",75),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit;s["\u0275\u0275property"]("ngClass",s["\u0275\u0275pureFunction1"](8,x,i.stock<1||i.quantity>i.stock)),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",i.product_name," "),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",i.expired),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" ",i.quantity," "),s["\u0275\u0275advance"](9),s["\u0275\u0275textInterpolate"](i.price),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"]((i.price*i.quantity).toFixed(2)),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",i.stock," "),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",i.stock<1||i.quantity>i.stock)}}function k(e,t){if(1&e){var n=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"button",79),s["\u0275\u0275listener"]("click",(function(){return s["\u0275\u0275restoreView"](n),s["\u0275\u0275nextContext"]().applyDiscount()})),s["\u0275\u0275text"](1,"Apply Discount"),s["\u0275\u0275elementEnd"]()}}function C(e,t){if(1&e){var n=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"span"),s["\u0275\u0275text"](1),s["\u0275\u0275elementStart"](2,"button",80),s["\u0275\u0275listener"]("click",(function(){return s["\u0275\u0275restoreView"](n),s["\u0275\u0275nextContext"]().removeDiscount()})),s["\u0275\u0275element"](3,"i",75),s["\u0275\u0275text"](4," Remove"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){var i=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"]("Discount Applied: GHC ",i.discount," ")}}function w(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"option"),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate"](n)}}var I=function(e,t){return{"text-danger":e,"text-success":t}};function M(e,t){if(1&e){var n=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"span"),s["\u0275\u0275elementStart"](1,"b"),s["\u0275\u0275text"](2,"Cash Paid:"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"input",81),s["\u0275\u0275listener"]("focus",(function(){return s["\u0275\u0275restoreView"](n),s["\u0275\u0275nextContext"]().clearAmountPaid()}))("keydown",(function(e){return s["\u0275\u0275restoreView"](n),s["\u0275\u0275nextContext"]().keyUp(e)}))("ngModelChange",(function(e){return s["\u0275\u0275restoreView"](n),s["\u0275\u0275nextContext"]().amount_paid=e})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275text"](4," \xa0| \xa0 "),s["\u0275\u0275elementStart"](5,"b",68),s["\u0275\u0275text"](6),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){var i=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("disabled","Cash"!=i.payment_method)("ngModel",i.amount_paid),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngClass",s["\u0275\u0275pureFunction2"](4,I,i.amount_paid<i.discounted_total,i.amount_paid>i.discounted_total)),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" Change Due: GHC ",(i.amount_paid-i.discounted_total).toFixed(2),"")}}function j(e,t){if(1&e){var n=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"span"),s["\u0275\u0275elementStart"](1,"button",18),s["\u0275\u0275listener"]("click",(function(){return s["\u0275\u0275restoreView"](n),s["\u0275\u0275nextContext"]().showInsurerModal()})),s["\u0275\u0275text"](2,"Enter Insurance Details"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}}function F(e,t){if(1&e){var n=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"span"),s["\u0275\u0275elementStart"](1,"b"),s["\u0275\u0275text"](2,"Customer Name: "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"input",82),s["\u0275\u0275listener"]("keydown",(function(e){return s["\u0275\u0275restoreView"](n),s["\u0275\u0275nextContext"]().keyUp(e)}))("ngModelChange",(function(e){return s["\u0275\u0275restoreView"](n),s["\u0275\u0275nextContext"]().creditor_name=e})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){var i=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngModel",i.creditor_name)}}function N(e,t){if(1&e){var n=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"span"),s["\u0275\u0275elementStart"](1,"b"),s["\u0275\u0275text"](2,"Momo Reference: "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"input",83),s["\u0275\u0275listener"]("keydown",(function(e){return s["\u0275\u0275restoreView"](n),s["\u0275\u0275nextContext"]().keyUp(e)}))("ngModelChange",(function(e){return s["\u0275\u0275restoreView"](n),s["\u0275\u0275nextContext"]().momo_reference=e})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){var i=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngModel",i.momo_reference)}}function q(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"h5"),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){var n=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"]("Quantity for ",n.new_item.name,"")}}function O(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"span"),s["\u0275\u0275text"](1,"No held items"),s["\u0275\u0275elementEnd"]())}var V=function(e){return{"table-primary":e}};function T(e,t){if(1&e){var n=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"tr",89),s["\u0275\u0275listener"]("dblclick",(function(){s["\u0275\u0275restoreView"](n);var e=t.$implicit;return s["\u0275\u0275nextContext"](2).unhold(e)}))("click",(function(){s["\u0275\u0275restoreView"](n);var e=t.$implicit;return s["\u0275\u0275nextContext"](2).selectHeldItem(e)})),s["\u0275\u0275elementStart"](1,"td"),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"td"),s["\u0275\u0275text"](4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"td"),s["\u0275\u0275text"](6),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"td"),s["\u0275\u0275text"](8),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit,a=t.index,r=s["\u0275\u0275nextContext"](2);s["\u0275\u0275property"]("ngClass",s["\u0275\u0275pureFunction1"](5,V,r.selectedHeldItem==i)),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",a+1," "),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",i.user," "),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",i.time," "),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",i.items.length," ")}}function L(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"tr"),s["\u0275\u0275elementStart"](1,"td"),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"td"),s["\u0275\u0275text"](4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",n.product_name," "),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",n.quantity," ")}}function P(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"table",11),s["\u0275\u0275elementStart"](1,"thead"),s["\u0275\u0275elementStart"](2,"tr"),s["\u0275\u0275elementStart"](3,"th"),s["\u0275\u0275text"](4,"Item"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"th"),s["\u0275\u0275text"](6,"Quantity"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"tbody"),s["\u0275\u0275template"](8,L,5,2,"tr",21),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){var n=s["\u0275\u0275nextContext"](2);s["\u0275\u0275advance"](8),s["\u0275\u0275property"]("ngForOf",n.selectedHeldItem.items)}}function D(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",84),s["\u0275\u0275elementStart"](1,"div",85),s["\u0275\u0275elementStart"](2,"table",11),s["\u0275\u0275elementStart"](3,"thead"),s["\u0275\u0275elementStart"](4,"tr"),s["\u0275\u0275elementStart"](5,"th"),s["\u0275\u0275text"](6,"#"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"th"),s["\u0275\u0275text"](8,"Saved by"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](9,"th"),s["\u0275\u0275text"](10,"Date"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](11,"th"),s["\u0275\u0275text"](12,"Num. Items"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](13,"tbody"),s["\u0275\u0275template"](14,T,9,7,"tr",86),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](15,"div",87),s["\u0275\u0275template"](16,P,9,1,"table",88),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){var n=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](14),s["\u0275\u0275property"]("ngForOf",n.held_items),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",null!=n.selectedHeldItem)}}function H(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"option"),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate"](n)}}function A(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"tr"),s["\u0275\u0275elementStart"](1,"td"),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"td"),s["\u0275\u0275text"](4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"td"),s["\u0275\u0275text"](6),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"td"),s["\u0275\u0275text"](8),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](n.product.name),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](n.quantity),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](n.price),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",(n.quantity*n.price).toFixed(2)," ")}}var U,J,K,Y=[{path:"",component:(U=function(){function e(t,n,i,a,r){_classCallCheck(this,e),this.dbService=t,this.socket=n,this.notify=i,this.localforage=a,this.authService=r,this.items=[],this.held_items=[],this.new_item=null,this.selectedHeldItem=null,this.new_quantity="",this.sale_total=0,this.amount_paid=0,this.receipt_amount_paid=0,this.receipt_items=[],this.accept_amount=!1,this.invoice_items=[],this.receipt_total=0,this.time="",this.digital_address="",this.ts="",this.payment_method="Cash",this.key_state="none",this.insurer_id=null,this.insurance_member_name=null,this.insurance_member_id=null,this.momo_reference=null,this.creditor_name=null,this.discount=0,this.discounted_total=0,this.receipt_discount=0,this.receipt_discounted_total=0,this.customer_name="",this.shift="Shift 1",this.shifts=[],-1==this.authService.current_user.permissions.indexOf("Create Sales")&&(this.notify.failNotification("You are not permitted to view that page"),this.goBack()),this.company_address=r.current_user.company_address,this.company_phone=r.current_user.company_phone,this.company_name=r.current_user.company_name,this.cashier=r.current_user.display_name,this.digital_address=r.current_user.digital_address,this.dbService.setTitle("New Sales")}return _createClass(e,[{key:"keyEvent",value:function(e){if(e.ctrlKey&&13==e.keyCode||35==e.keyCode)switch(console.log(this.payment_method),this.payment_method){case"Cash":0==this.amount_paid||null==this.amount_paid?(this.amount_paid=null,$("#amount_paid").focus(),$("#amount_paid").tooltip({title:"Enter the amount paid"})):this.saveLocalItems();break;case"Mobile Money":console.log(this.momo_reference),null==this.momo_reference||null==this.momo_reference||""==this.momo_reference.trim()?this.alertMomo():this.saveLocalItems();break;case"Credit":null==this.creditor_name||null==this.creditor_name||""==this.creditor_name.trim()?this.alertCredit():this.saveLocalItems()}else if("Home"==e.code)console.log("home"),this.ts=this.dbService.getToday("timestamp_string");else if(27==e.keyCode)switch(this.key_state){case"item_quantity":this.rejectItem();break;case"alert_change":$("#sale_confirm_modal").modal("hide");break;case"held_items":$("#held_items_modal").modal("hide");break;case"discount_modal":$("#discount_modal").modal("hide")}else if(13==e.keyCode)switch(this.key_state){case"alert_change":this.acceptAmount(),this.key_state="";break;case"show_change":this.finishSale(),this.key_state="";break;case"held_items":this.unholdSelected(),this.key_state=""}else if(40==e.keyCode)switch(this.key_state){case"held_items":var t,n=this.held_items.indexOf(this.selectedHeldItem);t=n==this.held_items.length-1?0:n+1,this.selectedHeldItem=this.held_items[t]}else if(38==e.keyCode)switch(this.key_state){case"held_items":var i,a=this.held_items.indexOf(this.selectedHeldItem),r=this.held_items.length-1;i=0==a?r:a-1,this.selectedHeldItem=this.held_items[i]}}},{key:"ngOnInit",value:function(){this.ts=this.dbService.getToday(),this.held_items=JSON.parse(localStorage.getItem("heldItems")),null==this.held_items&&(this.held_items=[]),this.getShifts(),$("#sales_search").focus(),this.getCustomers()}},{key:"getCustomers",value:function(){var e=this;this.dbService.getData("customer/getList",this.authService.current_user).subscribe((function(t){"1"==t.status&&(e.customer_objects=t.data)}),(function(t){e.new_item.stock=0,e.notify.failNotification("Unable to get customers. Check connection")}))}},{key:"getShifts",value:function(){var e=this;this.dbService.getData("admin/getSetting?setting=number_of_shifts",this.authService.current_user).subscribe((function(t){if("1"==t.status){for(var n=0;n<t.data;n++)e.shifts.push("Shift ".concat(n+1));var i=sessionStorage.getItem("shift");null==i?$("#select_shift_modal").modal({keyboard:!1,backdrop:"static"}):e.shift=i}}),(function(t){e.new_item.stock=0,e.notify.failNotification("Unable to get customers. Check connection")}))}},{key:"setShift",value:function(){$("#select_shift_modal").modal("hide"),sessionStorage.setItem("shift",this.shift),$("#shift").tooltip({title:"You can change your shift here any time"}),$("#shift").tooltip("show"),setTimeout((function(){$("#shift").tooltip("hide")}),3e3)}},{key:"shiftChanged",value:function(){sessionStorage.setItem("shift",this.shift)}},{key:"productSelected",value:function(e){if(this.new_item=e,this.new_item.stock=e.stock,"number"!=typeof e.price)return this.notify.failNotification("Price not defined."),!1;for(var t=!1,n=0;n<this.items.length;n++)if(this.items[n].product_id==e.id){t=!0;break}if(t)return this.notify.failNotification("Item is already in the list"),!1;this.getItemStock(),this.showQuantityModal()}},{key:"showQuantityModal",value:function(){this.key_state="item_quantity",$("#quantity_modal").modal({backdrop:"static",keyboard:!1}),$("#quantity_modal").on("shown.bs.modal",(function(){$("#new_quantity").focus()}))}},{key:"getItemStock",value:function(){var e=this,t=this.new_item.id;this.dbService.getData("product/getStock?id="+this.new_item.id,this.authService.current_user).subscribe((function(n){if("1"==n.status){e.new_item.stock=n.data;for(var i=0;i<e.items.length;i++)if(e.items[i].product_id==t){e.items[i].stock=n.data;break}}}),(function(t){e.new_item.stock=0,e.notify.failNotification("Unable to get stock. Check connection")}))}},{key:"acceptItem",value:function(){if(isNaN(this.new_quantity))return alert("Only numbers allowed for quantity"),!1;var e=new r.a;e.product_name=this.new_item.name,e.product_id=this.new_item.id,e.price=this.new_item.price,e.cost_price=this.new_item.cost_price,e.quantity=this.new_quantity,e.total=this.new_quantity*this.new_item.price,e.stock=this.new_item.stock,e.product=this.new_item,e.expired=this.new_item.expired,this.items.push(e),this.getTotal(),$("#quantity_modal").modal("hide"),this.new_quantity="",this.ts=this.dbService.getToday("timestamp_string")}},{key:"rejectItem",value:function(){$("#quantity_modal").modal("hide"),this.new_quantity="",this.ts=this.dbService.getToday("timestamp_string")}},{key:"getTotal",value:function(){var e=0;this.items.map((function(t){e+=t.quantity*t.price})),this.sale_total=e,this.receipt_total=e,this.discounted_total=e-this.discount,this.receipt_discount=this.discount-0,this.receipt_discounted_total=e-this.discount}},{key:"removeItem",value:function(e){this.items.splice(this.items.indexOf(e),1),this.getTotal(),this.ts=this.dbService.getToday("timestamp_string")}},{key:"editItem",value:function(e){this.new_item=e.product,this.items.splice(this.items.indexOf(e),1),this.getTotal(),this.new_item=e.product,this.new_quantity=e.quantity,$("#quantity_modal").modal({backdrop:"static",keyboard:!1}),$("#quantity_modal").on("shown.bs.modal",(function(){$("#qtt").focus()}))}},{key:"showInsurerModal",value:function(){$("#insurance_modal").modal({backdrop:"static",keyboard:!1})}},{key:"alertMomo",value:function(){return $("#momo_reference").focus(),$("#momo_reference").tooltip({title:"Enter the reference/transaction number"}),!1}},{key:"alertCredit",value:function(){return $("#creditor_name").focus(),$("#creditor_name").tooltip({title:"Enter the customer name or number"}),!1}},{key:"setInsurer",value:function(e){this.insurer_id=e.name}},{key:"setQuantities",value:function(){var e=0,t=this;$(".quantities").each((function(){t.items[e].quantity=$(this).val(),e++})),this.getTotal()}},{key:"alert",value:function(){this.key_state="alert_change",$("#sale_confirm_modal").modal({backdrop:"static",keyboard:!1})}},{key:"acceptAmount",value:function(){this.accept_amount=!0,this.saveLocalItems()}},{key:"saveLocalItems",value:function(){var e=this;if("Insurance"==this.payment_method&&(this.dbService.isEmpty(this.insurer_id)||this.dbService.isEmpty(this.insurance_member_name)||this.dbService.isEmpty(this.insurance_member_name)))return this.showInsurerModal(),!1;if("Mobile Money"==this.payment_method&&this.dbService.isEmpty(this.momo_reference))return this.alertMomo(),!1;if("Credit"==this.payment_method&&null==this.creditor_name)return this.alertCredit(),!1;if(null==this.items||null==this.items||this.items.length<1)return this.notify.failNotification("Please add at least one product"),!1;if(this.amount_paid<this.discounted_total&&!this.accept_amount&&"Cash"==this.payment_method)return this.alert(),!1;if(isNaN(this.amount_paid)&&"Cash"==this.payment_method)return alert("Only numbers allowed for amount paid"),!1;this.notify.showLoading(),this.receipt_items=[];for(var t=0;t<this.items.length;t++)this.receipt_items.push(this.items[t]);if(this.accept_amount=!1,"Cash"!=this.payment_method?(this.receipt_amount_paid=this.sale_total,this.amount_paid=this.sale_total):this.receipt_amount_paid=this.amount_paid,"offline"==this.dbService.ENVIRONMENT){var n=[],i=[],a=[],r=[],o=[];this.ts=this.dbService.getToday("timestamp_string"),this.time=this.dbService.getToday("timestamp"),console.log(this.time);for(var s=0;s<this.items.length;s++){var c=this.items[s];n.push(c.product_id),i.push(c.price),a.push(c.quantity),r.push(c.product_name),o.push(c.cost_price)}var d=new FormData;d.append("products",n.join("||")),d.append("prices",i.join("||")),d.append("cost_prices",o.join("||")),d.append("quantities",a.join("||")),d.append("product_names",r.join("||")),d.append("amount_paid",this.amount_paid.toString()),d.append("discount",this.discount.toString()),d.append("created_by",this.authService.current_user.id),d.append("date",this.dbService.getToday()),d.append("created_on",this.dbService.getToday("timestamp")),d.append("display_name",this.authService.current_user.display_name),d.append("payment_method",this.payment_method),d.append("shift",this.shift),"Insurance"==this.payment_method&&(d.append("insurance_provider",this.insurer_id),d.append("insurance_member_name",this.insurance_member_name),d.append("insurance_member_id",this.insurance_member_id)),"Mobile Money"===this.payment_method&&d.append("momo_reference",this.momo_reference),"Credit"===this.payment_method&&d.append("creditor_name",this.creditor_name),this.dbService.postData(d,"sale/saveBulk",this.authService.current_user).subscribe((function(t){if(e.notify.hideLoading(),"0"===t.status)e.notify.failNotification("Unable to authenticate. Please login again");else if("-1"===t.status)alert("Server error. Please try again` ");else if("-9"===t.status)e.notify.showNotification("You are not permitted to perform this action","fail",3e3);else{if(e.customer_name="",e.selected_code=t.code,localStorage.setItem("receipt_total",JSON.stringify(e.sale_total)),e.notify.hideLoading(),e.notify.successNotification("Sales synced successfully"),e.amount_paid>e.sale_total)return $("#change_modal").modal({backdrop:"static",keyboard:!1}),$("#change_modal").on("shown.bs.modal",(function(){$("#finish_sale_btn").focus()})),!1;e.finishSale()}}),(function(t){e.notify.hideLoading(),e.notify.noConnectionNotification(),console.log(t)}))}else{var m,u=new l;u.display_name=this.authService.current_user.display_name,u.date=this.dbService.getToday(),u.created_on=this.dbService.getToday("timestamp"),u.created_by=this.authService.current_user.id,u.payment_method=this.payment_method,u.amount_paid=this.amount_paid,u.items=this.items,u.company_id=this.authService.current_user.company_id,u.code=this.authService.current_user.id+""+this.dbService.getToday("timestamp_string"),u.insurance_provider=this.insurer_id,u.insurance_member_name=this.insurance_member_name,u.insurance_member_id=this.insurance_member_id,u.momo_reference=this.momo_reference,u.creditor_name=this.creditor_name,u.discount=this.discount,this.time=this.dbService.getToday("timestamp"),this.selected_code=u.code,this.localforage.getItem(this.dbService.OFFLINE_SALES_KEY).subscribe((function(t){if((m=null!=t?t:[]).push(u),e.localforage.setItem(e.dbService.OFFLINE_SALES_KEY,m),e.dbService.unsynced_sales.next(m),localStorage.setItem("receipt_total",JSON.stringify(e.sale_total)),e.notify.hideLoading(),e.saveItems(u.code),e.amount_paid>e.sale_total)return $("#change_modal").modal({backdrop:"static",keyboard:!1}),$("#change_modal").on("shown.bs.modal",(function(){$("#finish_sale_btn").focus()})),!1;e.customer_name="",e.finishSale()}),(function(t){e.notify.hideLoading(),m=[],console.log("local forage new sales save error",t),m.push(u),e.localforage.setItem(e.dbService.OFFLINE_SALES_KEY,m),e.selected_code=u.code,localStorage.setItem("receipt_total",JSON.stringify(e.sale_total))}))}}},{key:"saveItems",value:function(e){var t=this,n=[],i=[],a=[],r=[],o=[];this.ts=this.dbService.getToday("timestamp_string");for(var l=0;l<this.items.length;l++){var s=this.items[l];n.push(s.product_id),i.push(s.price),a.push(s.quantity),r.push(s.product_name),o.push(s.cost_price)}var c=new FormData;c.append("products",n.join("||")),c.append("prices",i.join("||")),c.append("cost_prices",o.join("||")),c.append("quantities",a.join("||")),c.append("code",e),c.append("product_names",r.join("||")),c.append("amount_paid",this.amount_paid.toString()),c.append("discount",this.discount.toString()),c.append("created_by",this.authService.current_user.id),c.append("date",this.dbService.getToday()),c.append("created_on",this.dbService.getToday("timestamp")),c.append("display_name",this.authService.current_user.display_name),c.append("payment_method",this.payment_method),c.append("customer",this.customer_name),c.append("shift",this.shift),"Insurance"==this.payment_method&&(c.append("insurance_provider",this.insurer_id),c.append("insurance_member_name",this.insurance_member_name),c.append("insurance_member_id",this.insurance_member_id)),"Mobile Money"===this.payment_method&&c.append("momo_reference",this.momo_reference),"Credit"===this.payment_method&&c.append("creditor_name",this.creditor_name),this.dbService.postData(c,"sale/saveBulk",this.authService.current_user).subscribe((function(n){t.notify.hideLoading(),"0"===n.status?t.notify.failNotification("Unable to authenticate. Please login again"):"-1"===n.status?alert("Server error. Please click the `Upload Sales menu in the top bar to try again` "):"-9"===n.status?t.notify.showNotification("You are not permitted to perform this action","fail",3e3):(t.notify.hideLoading(),t.notify.successNotification("Sales synced successfully"),t.localforage.getItem(t.dbService.OFFLINE_SALES_KEY).subscribe((function(n){var i=n;console.log(i.length);for(var a=0;a<i.length;a++)if(i[a].code==e){i.splice(a,1);break}t.socket.sendEvent({company_id:t.authService.current_user.company_id,parent_company_id:t.authService.current_user.parent_company.id,message:"New sale",event:"new_sale"}),t.localforage.setItem(t.dbService.OFFLINE_SALES_KEY,i),t.dbService.unsynced_sales.next(i)})))}),(function(e){t.notify.hideLoading(),t.notify.noConnectionNotification(),console.log(e)}))}},{key:"sync",value:function(){}},{key:"increment",value:function(e){null!=e&&null!=e?(e.quantity=(parseFloat(e.quantity)+1).toString(),this.getTotal()):(this.dbService.isEmpty(this.new_quantity)&&(this.new_quantity=0),this.new_quantity++,$("#new_quantity").focus(),this.focusCursor())}},{key:"decrement",value:function(e){null!=e&&null!=e?parseFloat(e.quantity)>1&&(e.quantity=(parseFloat(e.quantity)-1).toString(),this.getTotal()):(this.dbService.isEmpty(this.new_quantity)&&(this.new_quantity=0),parseFloat(this.new_quantity)>1&&this.new_quantity--,$("#new_quantity").focus(),this.focusCursor())}},{key:"keyChangeQuantity",value:function(e){40==e.keyCode?this.decrement():38==e.keyCode&&this.increment(),this.focusCursor()}},{key:"closeHeld",value:function(){$("#held_items_modal").modal("hide"),this.key_state=""}},{key:"finishSale",value:function(){this.amount_paid=0,this.insurance_member_id="",this.insurance_member_name="",this.momo_reference="",this.discount=0,this._discount=null,this.discounted_total=0,this.notify.showLoading();var e=this;setTimeout((function(){e.notify.hideLoading(),e.print(),e.items=[],e.getTotal()}),100),this.ts=this.dbService.getToday("timestamp_string"),this.payment_method="Cash"}},{key:"cancel",value:function(){this.items=[],this.amount_paid=0,this.getTotal()}},{key:"goBack",value:function(){window.history.back()}},{key:"keyUp",value:function(e){switch(e.keyCode){case 13:this.saveLocalItems()}}},{key:"print",value:function(){var e,t,n=0;this.receipt_items.map((function(e){n+=e.quantity*e.product.price})),this.receipt_total=n,e=document.getElementById("invoice").innerHTML,(t=window.open("","_blank","top=0,left=0,height=100%,width=auto")).document.open(),t.document.write('\n          <html>\n            <head>\n              <title>Invoice</title>\n              <style>\n              body{\n                font-size: 13px;\n              }\n              #invoice { page-break-after: always; }\n    #invoice:last-child { page-break-after: avoid; }\n\n\n    table{\n        width: 100%;\n        border: 1px solid #e9ecef;\n        font-size: 13px !important;\n    }\n\n    .small-margin{\n      margin-bottom: 10px;\n    }\n\n    .table-bordered{border:1px solid #dee2e6}.table-bordered td,.table-bordered th{border:1px solid #dee2e6}.table-bordered thead td,.table-bordered thead th{border-bottom-width:2px}\n           .center{\n             text-align:center\n           }\n           .text-left{text-align:left!important}.text-right{text-align:right!important; float:right}\n           .text-center{text-align:center!important}\n           @media (min-width:576px){.text-sm-left{text-align:left!important}\n           .text-sm-right{text-align:right!important}\n           .text-sm-center{text-align:center!important}}\n           @media (min-width:768px){.text-md-left{text-align:left!important}\n           .text-md-right{text-align:right!important}\n           .text-md-center{text-align:center!important}}@media (min-width:992px){.text-lg-left{text-align:left!important}.text-lg-right{text-align:right!important}.text-lg-center{text-align:center!important}}@media (min-width:1200px){.text-xl-left{text-align:left!important}.text-xl-right{text-align:right!important}.text-xl-center{text-align:center!important}}.text-lowercase{text-transform:lowercase!important}.text-uppercase{text-transform:uppercase!important}.text-capitalize{text-transform:capitalize!important}\n\n           .row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-15px;margin-left:-15px}\n              </style>\n            </head>\n        <body onload="window.print();window.close()"><div id="invoice">'.concat(e,"</div> </body>\n          </html>")),t.document.close(),this.ts=this.dbService.getToday("timestamp_string")}},{key:"holdItems",value:function(){var e=new o;e.items=this.items,e.user=this.authService.current_user.display_name,e.time=this.dbService.getToday("timestamp"),this.held_items.push(e),localStorage.setItem("heldItems",JSON.stringify(this.held_items)),this.items=[],this.getTotal(),this.ts=this.dbService.getToday("timestamp_string")}},{key:"viewHeldItems",value:function(){$("#held_items_modal").modal({backdrop:"static",keyboard:!1}),this.held_items.length>0&&(this.selectedHeldItem=this.held_items[0]),this.key_state="held_items"}},{key:"selectHeldItem",value:function(e){this.selectedHeldItem=e}},{key:"unhold",value:function(e){this.items=e.items,this.held_items.splice(this.held_items.indexOf(e),1),localStorage.setItem("heldItems",JSON.stringify(this.held_items)),$("#held_items_modal").modal("hide"),this.getTotal()}},{key:"deleteHeldItem",value:function(){this.held_items.splice(this.held_items.indexOf(this.selectedHeldItem),1),this.selectedHeldItem=null,localStorage.setItem("heldItems",JSON.stringify(this.held_items))}},{key:"unholdSelected",value:function(){this.unhold(this.selectedHeldItem)}},{key:"clearHeldItems",value:function(){localStorage.removeItem("heldItems"),this.selectedHeldItem=null,this.held_items=[],$("#held_items_modal").modal("hide")}},{key:"productAdded",value:function(e){}},{key:"clearAmountPaid",value:function(){0!=this.amount_paid&&null!=this.amount_paid||(this.amount_paid=null,$("#amount_paid").focus(),$("#amount_paid").tooltip({title:"Enter the amount paid"}))}},{key:"ngOnDestroy",value:function(){this.items.length>0&&(this.holdItems(),this.notify.successNotification("Receipt held automatically"))}},{key:"focusCursor",value:function(){var e=$("#new_quantity").val();$("#new_quantity").val("").val(e)}},{key:"applyDiscount",value:function(){$("#discount_modal").modal({backdrop:"static",keyboard:!1}),$("#discount_modal").on("shown.bs.modal",(function(){$("#_discount").focus()})),this.key_state="discount_modal"}},{key:"acceptDiscount",value:function(){$("#discount_modal").modal("hide"),this.discount=this._discount,this.getTotal()}},{key:"rejectDiscount",value:function(){$("#discount_modal").modal("hide"),this._discount=null}},{key:"removeDiscount",value:function(){this.discount=0,this.getTotal()}},{key:"search",value:function(){var e=this;""==this.customer_name?this.getCustomers():this.dbService.getDataWithQuery("customer/search",this.authService.current_user,"param="+this.customer_name).subscribe((function(t){"-1"===t.status||(e.customer_objects=t.data)}),(function(e){}))}}]),e}(),U.\u0275fac=function(e){return new(e||U)(s["\u0275\u0275directiveInject"](c.a),s["\u0275\u0275directiveInject"](d.a),s["\u0275\u0275directiveInject"](m.a),s["\u0275\u0275directiveInject"](u.a),s["\u0275\u0275directiveInject"](h.a))},U.\u0275cmp=s["\u0275\u0275defineComponent"]({type:U,selectors:[["app-new-sale"]],hostBindings:function(e,t){1&e&&s["\u0275\u0275listener"]("keydown",(function(e){return t.keyEvent(e)}),!1,s["\u0275\u0275resolveWindow"])},decls:261,vars:46,consts:[[1,"content"],[1,"container"],[1,"row"],[1,"col-md-3"],[1,"col-md-6"],[3,"timestamp","type","onAdd"],["id","customer_field","placeholder","Customer name","type","text","list","customer_list",1,"form-control",3,"ngModel","keyup","ngModelChange"],["id","customer_list"],[3,"value",4,"ngFor","ngForOf"],[1,"col-12"],[1,"card","card-body","table-responsive","sales_items"],[1,"table","table-striped","table-bordered","table-hover"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"card-body"],["class","btn btn-sm btn-info",3,"click",4,"ngIf"],[4,"ngIf"],[1,""],[1,"btn","btn-info","btn-sm",3,"disabled","click"],[1,"btn","btn-info","btn-sm",3,"click"],[1,"text-danger"],["id","shift","name","shift",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["name","payment_method","id","payment_method",3,"ngModel","ngModelChange"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-success",3,"click"],["id","sale_confirm_modal","tabindex","-1","role","dialog",1,"modal","fade"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-body"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-success",3,"click"],["type","button","data-dismiss","modal",1,"btn","btn-danger"],["id","quantity_modal","tabindex","-1","role","dialog",1,"modal","fade"],["role","document",1,"modal-dialog","modal-sm"],["ngNativeValidate","",3,"ngSubmit"],["n","ngForm"],["autocomplete","off","required","","id","new_quantity","name","new_quantity",3,"ngModel","keyup","ngModelChange"],["type","button",1,"btn","btn-sm","btn-info",3,"click"],["type","button",1,"btn","btn-sm","btn-warning",3,"click"],["type","submit",1,"btn","btn-success"],["type","button",1,"btn","btn-danger",3,"click"],["id","discount_modal","tabindex","-1","role","dialog",1,"modal","fade"],["autocomplete","off","required","","id","_discount","name","_discount",3,"ngModel","ngModelChange"],["id","change_modal","tabindex","-1","role","dialog",1,"modal","fade"],["id","finish_sale_btn","type","button","data-dismiss","modal",1,"btn","btn-success",3,"click"],["id","insurance_modal","tabindex","-1","role","dialog",1,"modal","fade"],[1,"modal-header"],[3,"onFinish"],["type","text","name","insurance_member_name",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","insurance_member_id",1,"form-control",3,"ngModel","ngModelChange"],["type","submit","data-dismiss","modal",1,"btn","btn-success"],["id","held_items_modal","tabindex","-1","role","dialog",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg"],["class","row fixed_height",4,"ngIf"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"],["type","button","data-dismiss","modal",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-warning",3,"click"],["id","select_shift_modal","tabindex","-1","role","dialog",1,"modal","fade"],["name","shift",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-success",3,"click"],["id","add_new_product_modal","tabindex","-1","role","dialog",1,"modal"],["id","invoice"],[1,"text-left"],[1,"text-right"],[1,"text-center"],[1,"table"],[3,"bc-value","bc-height","bc-font-size","bc-display-value"],[3,"value"],[3,"ngClass"],["class","text-muted",4,"ngIf"],["title","custom quantity",1,"btn","btn-info","btn-sm",3,"click"],["title","increase quantity by 1",1,"btn","btn-info","btn-sm",3,"click"],["title","decrease quantity by 1",1,"btn","btn-info","btn-sm",3,"click"],["title","The quantity entered is more than the current stock","class","text-danger fa fa-exclamation-triangle",4,"ngIf"],[1,"btn","btn-warning","btn-sm",3,"click"],[1,"fa","fa-remove"],[1,"text-muted"],["title","Item expired",1,"fa","fa-calendar","text-danger"],["title","The quantity entered is more than the current stock",1,"text-danger","fa","fa-exclamation-triangle"],[1,"btn","btn-sm","btn-info",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],["id","amount_paid","size","10","autocomplete","off","type","text","name","amount_paid","value","0",3,"disabled","ngModel","focus","keydown","ngModelChange"],["id","creditor_name","type","text","name","creditor_name",3,"ngModel","keydown","ngModelChange"],["id","momo_reference","type","text","name","momo_reference",3,"ngModel","keydown","ngModelChange"],[1,"row","fixed_height"],[1,"col-7"],[3,"ngClass","dblclick","click",4,"ngFor","ngForOf"],[1,"col-5"],["class","table table-striped table-bordered table-hover",4,"ngIf"],[3,"ngClass","dblclick","click"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"section",0),s["\u0275\u0275elementStart"](1,"div",1),s["\u0275\u0275elementStart"](2,"div",2),s["\u0275\u0275elementStart"](3,"div",3),s["\u0275\u0275elementStart"](4,"h4"),s["\u0275\u0275text"](5,"New Sales Receipt"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](6,"div",4),s["\u0275\u0275elementStart"](7,"app-select-product",5),s["\u0275\u0275listener"]("onAdd",(function(e){return t.productSelected(e)})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](8,"div",3),s["\u0275\u0275elementStart"](9,"input",6),s["\u0275\u0275listener"]("keyup",(function(){return t.search()}))("ngModelChange",(function(e){return t.customer_name=e})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](10,"datalist",7),s["\u0275\u0275template"](11,y,1,2,"option",8),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](12,"div",2),s["\u0275\u0275elementStart"](13,"div",9),s["\u0275\u0275elementStart"](14,"div",10),s["\u0275\u0275elementStart"](15,"table",11),s["\u0275\u0275elementStart"](16,"thead"),s["\u0275\u0275elementStart"](17,"tr"),s["\u0275\u0275elementStart"](18,"th"),s["\u0275\u0275text"](19,"Product"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](20,"th"),s["\u0275\u0275text"](21,"Quantity"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](22,"th"),s["\u0275\u0275text"](23,"Price"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](24,"th"),s["\u0275\u0275text"](25,"Total"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](26,"th"),s["\u0275\u0275text"](27,"On-hand"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](28,"th"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](29,"tbody"),s["\u0275\u0275template"](30,E,23,10,"tr",12),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](31,"div",13),s["\u0275\u0275elementStart"](32,"div"),s["\u0275\u0275elementStart"](33,"b"),s["\u0275\u0275text"](34),s["\u0275\u0275elementEnd"](),s["\u0275\u0275text"](35," | "),s["\u0275\u0275template"](36,k,2,0,"button",14),s["\u0275\u0275template"](37,C,5,1,"span",15),s["\u0275\u0275elementStart"](38,"span",16),s["\u0275\u0275elementStart"](39,"button",17),s["\u0275\u0275listener"]("click",(function(){return t.holdItems()})),s["\u0275\u0275text"](40,"Hold"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](41,"button",18),s["\u0275\u0275listener"]("click",(function(){return t.viewHeldItems()})),s["\u0275\u0275text"](42),s["\u0275\u0275elementEnd"](),s["\u0275\u0275text"](43," \xa0 "),s["\u0275\u0275elementStart"](44,"label",19),s["\u0275\u0275text"](45,"Shift:"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](46,"select",20),s["\u0275\u0275listener"]("ngModelChange",(function(e){return t.shift=e})),s["\u0275\u0275template"](47,w,2,1,"option",21),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](48,"div",16),s["\u0275\u0275elementStart"](49,"b"),s["\u0275\u0275text"](50),s["\u0275\u0275elementEnd"](),s["\u0275\u0275text"](51," | "),s["\u0275\u0275elementStart"](52,"b"),s["\u0275\u0275text"](53,"Method"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](54,"select",22),s["\u0275\u0275listener"]("ngModelChange",(function(e){return t.payment_method=e})),s["\u0275\u0275elementStart"](55,"option"),s["\u0275\u0275text"](56,"Cash"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](57,"option"),s["\u0275\u0275text"](58,"Mobile Money"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](59,"option"),s["\u0275\u0275text"](60,"Cheque"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](61,"option"),s["\u0275\u0275text"](62,"POS"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](63,"option"),s["\u0275\u0275text"](64,"Credit"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](65,"option"),s["\u0275\u0275text"](66,"Insurance"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](67,"option"),s["\u0275\u0275text"](68,"Other"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275text"](69," \xa0| "),s["\u0275\u0275template"](70,M,7,7,"span",15),s["\u0275\u0275template"](71,j,3,0,"span",15),s["\u0275\u0275template"](72,F,4,1,"span",15),s["\u0275\u0275template"](73,N,4,1,"span",15),s["\u0275\u0275elementStart"](74,"span",16),s["\u0275\u0275elementStart"](75,"button",23),s["\u0275\u0275listener"]("click",(function(){return t.cancel()})),s["\u0275\u0275text"](76,"Cancel"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](77,"button",24),s["\u0275\u0275listener"]("click",(function(){return t.saveLocalItems()})),s["\u0275\u0275text"](78,"Save"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](79,"div",25),s["\u0275\u0275elementStart"](80,"div",26),s["\u0275\u0275elementStart"](81,"div",27),s["\u0275\u0275elementStart"](82,"div",28),s["\u0275\u0275elementStart"](83,"h5"),s["\u0275\u0275text"](84,"The amount paid is less than the total cost. Continue?"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](85,"div",29),s["\u0275\u0275elementStart"](86,"button",30),s["\u0275\u0275listener"]("click",(function(){return t.acceptAmount()})),s["\u0275\u0275text"](87,"Accept"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](88,"button",31),s["\u0275\u0275text"](89,"Reject"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](90,"div",32),s["\u0275\u0275elementStart"](91,"div",33),s["\u0275\u0275elementStart"](92,"div",27),s["\u0275\u0275elementStart"](93,"form",34,35),s["\u0275\u0275listener"]("ngSubmit",(function(){return t.acceptItem()})),s["\u0275\u0275elementStart"](95,"div",28),s["\u0275\u0275template"](96,q,2,1,"h5",15),s["\u0275\u0275elementStart"](97,"input",36),s["\u0275\u0275listener"]("keyup",(function(e){return t.keyChangeQuantity(e)}))("ngModelChange",(function(e){return t.new_quantity=e})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](98,"br"),s["\u0275\u0275elementStart"](99,"button",37),s["\u0275\u0275listener"]("click",(function(){return t.increment()})),s["\u0275\u0275text"](100,"+1"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](101,"button",38),s["\u0275\u0275listener"]("click",(function(){return t.decrement()})),s["\u0275\u0275text"](102,"-1"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](103,"div",29),s["\u0275\u0275elementStart"](104,"button",39),s["\u0275\u0275text"](105,"Accept"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](106,"button",40),s["\u0275\u0275listener"]("click",(function(){return t.rejectItem()})),s["\u0275\u0275text"](107,"Cancel"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](108,"div",41),s["\u0275\u0275elementStart"](109,"div",33),s["\u0275\u0275elementStart"](110,"div",27),s["\u0275\u0275elementStart"](111,"form",34,35),s["\u0275\u0275listener"]("ngSubmit",(function(){return t.acceptDiscount()})),s["\u0275\u0275elementStart"](113,"div",28),s["\u0275\u0275elementStart"](114,"h5"),s["\u0275\u0275text"](115,"Enter Discount Amount:"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](116,"input",42),s["\u0275\u0275listener"]("ngModelChange",(function(e){return t._discount=e})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](117,"div",29),s["\u0275\u0275elementStart"](118,"button",39),s["\u0275\u0275text"](119,"Accept"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](120,"button",40),s["\u0275\u0275listener"]("click",(function(){return t.rejectDiscount()})),s["\u0275\u0275text"](121,"Cancel"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](122,"div",43),s["\u0275\u0275elementStart"](123,"div",26),s["\u0275\u0275elementStart"](124,"div",27),s["\u0275\u0275elementStart"](125,"div",28),s["\u0275\u0275elementStart"](126,"h5"),s["\u0275\u0275text"](127),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](128,"div",29),s["\u0275\u0275elementStart"](129,"button",44),s["\u0275\u0275listener"]("click",(function(){return t.finishSale()})),s["\u0275\u0275text"](130,"OK"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](131,"div",45),s["\u0275\u0275elementStart"](132,"div",26),s["\u0275\u0275elementStart"](133,"div",27),s["\u0275\u0275elementStart"](134,"div",46),s["\u0275\u0275elementStart"](135,"h5"),s["\u0275\u0275text"](136,"Insurance Details"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](137,"div",28),s["\u0275\u0275elementStart"](138,"form",34),s["\u0275\u0275listener"]("ngSubmit",(function(){return t.finishSale()})),s["\u0275\u0275elementStart"](139,"div"),s["\u0275\u0275elementStart"](140,"label"),s["\u0275\u0275text"](141,"Insurance provider"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](142,"app-select-insurer",47),s["\u0275\u0275listener"]("onFinish",(function(e){return t.setInsurer(e)})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](143,"div"),s["\u0275\u0275elementStart"](144,"label"),s["\u0275\u0275text"](145,"Member Name"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](146,"input",48),s["\u0275\u0275listener"]("ngModelChange",(function(e){return t.insurance_member_name=e})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](147,"div"),s["\u0275\u0275elementStart"](148,"label"),s["\u0275\u0275text"](149,"Member Id Number"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](150,"input",49),s["\u0275\u0275listener"]("ngModelChange",(function(e){return t.insurance_member_id=e})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](151,"button",50),s["\u0275\u0275text"](152,"OK"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](153,"button",31),s["\u0275\u0275text"](154,"Cancel"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](155,"div",29),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](156,"div",51),s["\u0275\u0275elementStart"](157,"div",52),s["\u0275\u0275elementStart"](158,"div",27),s["\u0275\u0275elementStart"](159,"div",46),s["\u0275\u0275text"](160," Held Items "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](161,"div",28),s["\u0275\u0275template"](162,O,2,0,"span",15),s["\u0275\u0275template"](163,D,17,2,"div",53),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](164,"div",29),s["\u0275\u0275elementStart"](165,"button",54),s["\u0275\u0275listener"]("click",(function(){return t.unholdSelected()})),s["\u0275\u0275text"](166,"Unhold Selected"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](167,"button",55),s["\u0275\u0275listener"]("click",(function(){return t.deleteHeldItem()})),s["\u0275\u0275text"](168,"Delete Selected"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](169,"button",40),s["\u0275\u0275listener"]("click",(function(){return t.clearHeldItems()})),s["\u0275\u0275text"](170,"Delete All"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](171,"button",56),s["\u0275\u0275listener"]("click",(function(){return t.closeHeld()})),s["\u0275\u0275text"](172,"Close"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](173,"div",57),s["\u0275\u0275elementStart"](174,"div",26),s["\u0275\u0275elementStart"](175,"div",27),s["\u0275\u0275elementStart"](176,"div",28),s["\u0275\u0275elementStart"](177,"h5"),s["\u0275\u0275text"](178,"Select your shift"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](179,"select",58),s["\u0275\u0275listener"]("ngModelChange",(function(e){return t.shift=e})),s["\u0275\u0275template"](180,H,2,1,"option",21),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](181,"br"),s["\u0275\u0275elementStart"](182,"em"),s["\u0275\u0275text"](183,"The selected shift will be applied till you logout. You may change it at any time"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](184,"div",29),s["\u0275\u0275elementStart"](185,"button",59),s["\u0275\u0275listener"]("click",(function(){return t.setShift()})),s["\u0275\u0275text"](186,"OK"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](187,"div",60),s["\u0275\u0275elementStart"](188,"div",52),s["\u0275\u0275elementStart"](189,"div",27),s["\u0275\u0275elementStart"](190,"div",46),s["\u0275\u0275elementStart"](191,"h5"),s["\u0275\u0275text"](192,"Add new product"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](193,"div",28),s["\u0275\u0275elementStart"](194,"app-product-form",47),s["\u0275\u0275listener"]("onFinish",(function(e){return t.productAdded(e)})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](195,"div",29),s["\u0275\u0275elementStart"](196,"button",31),s["\u0275\u0275text"](197,"Cancel"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](198,"div",61),s["\u0275\u0275elementStart"](199,"div"),s["\u0275\u0275elementStart"](200,"div"),s["\u0275\u0275elementStart"](201,"span",62),s["\u0275\u0275text"](202),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](203,"span",63),s["\u0275\u0275text"](204),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](205,"br"),s["\u0275\u0275elementStart"](206,"div",64),s["\u0275\u0275elementStart"](207,"b"),s["\u0275\u0275text"](208),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](209,"br"),s["\u0275\u0275text"](210),s["\u0275\u0275element"](211,"br"),s["\u0275\u0275text"](212),s["\u0275\u0275element"](213,"br"),s["\u0275\u0275text"](214),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](215,"br"),s["\u0275\u0275elementStart"](216,"b"),s["\u0275\u0275text"](217,"Cashier:"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275text"](218),s["\u0275\u0275element"](219,"hr"),s["\u0275\u0275elementStart"](220,"table",65),s["\u0275\u0275elementStart"](221,"thead"),s["\u0275\u0275elementStart"](222,"tr"),s["\u0275\u0275elementStart"](223,"th"),s["\u0275\u0275text"](224,"Item Name"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](225,"th"),s["\u0275\u0275text"](226,"Qty"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](227,"th"),s["\u0275\u0275text"](228,"Price"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](229,"th"),s["\u0275\u0275text"](230,"Ext. Price"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](231,"tbody"),s["\u0275\u0275template"](232,A,9,4,"tr",21),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](233,"br"),s["\u0275\u0275element"](234,"br"),s["\u0275\u0275elementStart"](235,"div"),s["\u0275\u0275elementStart"](236,"span",63),s["\u0275\u0275text"](237),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](238,"br"),s["\u0275\u0275elementStart"](239,"span",63),s["\u0275\u0275text"](240),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](241,"br"),s["\u0275\u0275elementStart"](242,"span",63),s["\u0275\u0275text"](243,"Local Sales Tax: 0% Tax: + 0.00 "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](244,"br"),s["\u0275\u0275elementStart"](245,"b",63),s["\u0275\u0275text"](246),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](247,"br"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](248,"div",64),s["\u0275\u0275text"](249),s["\u0275\u0275element"](250,"br"),s["\u0275\u0275elementStart"](251,"b",16),s["\u0275\u0275text"](252),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](253,"br"),s["\u0275\u0275element"](254,"ngx-barcode",66),s["\u0275\u0275element"](255,"br"),s["\u0275\u0275elementStart"](256,"b",64),s["\u0275\u0275text"](257,"Thanks for shopping with us!"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](258,"div",64),s["\u0275\u0275text"](259," Druglane Pharmacy POS Software - 0207085244 "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](260,"br"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](7),s["\u0275\u0275property"]("timestamp",t.ts)("type","search"),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngModel",t.customer_name),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngForOf",t.customer_objects),s["\u0275\u0275advance"](19),s["\u0275\u0275property"]("ngForOf",t.items),s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate1"]("Total: GHC ",t.sale_total.toFixed(2)," "),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",0==t.discount),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.discount>0),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("disabled",t.items.length<1),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate1"]("Held Items (",t.held_items.length,")"),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("ngModel",t.shift),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngForOf",t.shifts),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate1"]("Amount to be paid: GHC ",t.discounted_total.toFixed(2)," "),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("ngModel",t.payment_method),s["\u0275\u0275advance"](16),s["\u0275\u0275property"]("ngIf","Cash"==t.payment_method),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf","Insurance"==t.payment_method),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf","Credit"==t.payment_method),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf","Mobile Money"==t.payment_method),s["\u0275\u0275advance"](23),s["\u0275\u0275property"]("ngIf",null!=t.new_item),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngModel",t.new_quantity),s["\u0275\u0275advance"](19),s["\u0275\u0275property"]("ngModel",t._discount),s["\u0275\u0275advance"](11),s["\u0275\u0275textInterpolate1"]("Change due: GHC ",(t.amount_paid-t.sale_total).toFixed(2)," "),s["\u0275\u0275advance"](19),s["\u0275\u0275property"]("ngModel",t.insurance_member_name),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("ngModel",t.insurance_member_id),s["\u0275\u0275advance"](12),s["\u0275\u0275property"]("ngIf",t.held_items.length<1),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.held_items.length>0),s["\u0275\u0275advance"](16),s["\u0275\u0275property"]("ngModel",t.shift),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngForOf",t.shifts),s["\u0275\u0275advance"](22),s["\u0275\u0275textInterpolate1"]("",t.time," "),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("#",t.selected_code,""),s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate1"]("",t.company_name," "),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" ",t.company_address," "),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" DIGITAL ADDRESS ",t.digital_address," "),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" ",t.company_phone," "),s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate1"](" ",t.cashier," "),s["\u0275\u0275advance"](14),s["\u0275\u0275property"]("ngForOf",t.receipt_items),s["\u0275\u0275advance"](5),s["\u0275\u0275textInterpolate1"](" Subtotal: ",t.receipt_total.toFixed(2)," "),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate1"](" Discount: ",t.receipt_discount.toFixed(2)," "),s["\u0275\u0275advance"](6),s["\u0275\u0275textInterpolate1"](" RECEIPT TOTAL: ",t.receipt_discounted_total.toFixed(2)," "),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate2"](" ",t.payment_method," GHC ",t.receipt_amount_paid," "),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate1"](" Change: ",(t.receipt_amount_paid-t.receipt_discounted_total).toFixed(2)," "),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("bc-value",t.selected_code)("bc-height",35)("bc-font-size",13)("bc-display-value",!0))},directives:[p.a,f.b,f.e,f.h,i.i,i.j,f.m,f.i,f.n,f.f,f.g,f.l,_.a,g.a,v.a,i.h],styles:[""]}),U)}],B=((J=function e(){_classCallCheck(this,e)}).\u0275mod=s["\u0275\u0275defineNgModule"]({type:J}),J.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(e){return new(e||J)},imports:[[a.f.forChild(Y)],a.f]}),J),Q=n("nEHF"),R=n("rNAZ"),X=n("nBlB"),z=((K=function e(){_classCallCheck(this,e)}).\u0275mod=s["\u0275\u0275defineNgModule"]({type:K}),K.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(e){return new(e||K)},imports:[[i.b,B,Q.a,R.a,X.a]]}),K)},hiAm:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("fXoL"),a=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-loading"]],decls:2,vars:0,consts:[[1,"fa","fa-spin","fa-spinner"]],template:function(e,t){1&e&&(i["\u0275\u0275element"](0,"i",0),i["\u0275\u0275text"](1," Loading..."))},styles:[""]}),e}()},jr2M:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var i=n("fXoL"),a=n("c92J"),r=n("1VJT"),o=n("ccyI"),l=n("ofXK"),s=n("3Pt+");function c(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"option",4),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;i["\u0275\u0275propertyInterpolate"]("value",n),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"]("",n," ")}}function d(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"span"),i["\u0275\u0275elementStart"](1,"select",1),i["\u0275\u0275listener"]("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().selected=e}))("change",(function(){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().item_selected()})),i["\u0275\u0275template"](2,c,2,2,"option",2),i["\u0275\u0275elementStart"](3,"option",3),i["\u0275\u0275text"](4,"Other"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){var a=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngModel",a.selected),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngForOf",a.objects)}}var m=function(){var e=function(){function e(t,n,a){_classCallCheck(this,e),this.dbService=t,this.notify=n,this.authService=a,this.objects=[],this.is_loading=!1,this.error=!1,this.is_loaded=!1,this.onFinish=new i.EventEmitter,this.selected=null}return _createClass(e,[{key:"ngOnInit",value:function(){this.start()}},{key:"start",value:function(){var e=this;this.is_loaded=!1,this.is_loading=!0,this.dbService.getData("product/getCategories",this.authService.current_user).subscribe((function(t){"-1"===t.status&&(e.notify.failNotification(t.message),e.error=!0),"-9"===t.status?(e.notify.failNotification(t.message),e.error=!0):(e.objects=t.data,e.is_loaded=!0,e.error=!1),e.is_loading=!1}),(function(t){e.notify.noConnectionNotification()}))}},{key:"item_selected",value:function(){this.onFinish.emit(this.selected)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](a.a),i["\u0275\u0275directiveInject"](r.a),i["\u0275\u0275directiveInject"](o.a))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-select-product-category"]],inputs:{selected:"selected"},outputs:{onFinish:"onFinish"},decls:1,vars:1,consts:[[4,"ngIf"],["name","selected",1,"",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],["value","other"],[3,"value"]],template:function(e,t){1&e&&i["\u0275\u0275template"](0,d,5,2,"span",0),2&e&&i["\u0275\u0275property"]("ngIf",t.is_loaded)},directives:[l.j,s.m,s.e,s.h,l.i,s.i,s.n],styles:[""]}),e}()},mS1k:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function e(){_classCallCheck(this,e)}},nBlB:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("ofXK"),a=n("nEHF"),r=n("fXoL"),o=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275mod=r["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=r["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.b,a.a]]}),e}()},rNAZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("ofXK"),a=n("nEHF"),r=n("6QD7"),o=n("fXoL"),l=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275mod=o["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=o["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.b,a.a,r.b],r.b]}),e}()}}]);