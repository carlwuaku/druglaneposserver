(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{gSie:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("fXoL"),s=i("c92J"),a=i("ccyI"),o=i("ofXK");function r(e,t){if(1&e&&n["\u0275\u0275element"](0,"img",1),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275propertyInterpolate2"]("src","",e.base_url,"",e.logo,"",n["\u0275\u0275sanitizeUrl"]),n["\u0275\u0275propertyInterpolate"]("height",e.height)}}let c=(()=>{class e{constructor(e,t){this.dbService=e,this.authService=t,this.height=50,this.show_logo="no",this.dbService.server_address.subscribe(e=>{this.base_url=e})}ngOnInit(){this.dbService.getData("admin/getLogo",this.authService.current_user).subscribe(e=>{this.logo=e.data},e=>{}),this.dbService.getData("admin/getSetting?setting=receipt_logo",this.authService.current_user).subscribe(e=>{this.show_logo=e.data},e=>{})}}return e.\u0275fac=function(t){return new(t||e)(n["\u0275\u0275directiveInject"](s.a),n["\u0275\u0275directiveInject"](a.a))},e.\u0275cmp=n["\u0275\u0275defineComponent"]({type:e,selectors:[["app-receipt-logo"]],inputs:{height:"height"},decls:2,vars:1,consts:[["alt","logo",3,"src","height",4,"ngIf"],["alt","logo",3,"src","height"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,r,1,3,"img",0),n["\u0275\u0275element"](1,"br")),2&e&&n["\u0275\u0275property"]("ngIf","yes"==t.show_logo)},directives:[o.j],styles:[""]}),e})()},hiAm:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");let s=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n["\u0275\u0275defineComponent"]({type:e,selectors:[["app-loading"]],decls:2,vars:0,consts:[[1,"fa","fa-spin","fa-spinner"]],template:function(e,t){1&e&&(n["\u0275\u0275element"](0,"i",0),n["\u0275\u0275text"](1," Loading..."))},styles:[""]}),e})()},mrQn:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(){this.status="Pending"}}},n49D:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("fXoL"),s=i("4AQi");let a=(()=>{class e{constructor(e){this.excel=e,this.objects=[],this.filename="download"}ngOnInit(){}export(){this.excel.exportAsExcelFile(this.objects,this.filename)}}return e.\u0275fac=function(t){return new(t||e)(n["\u0275\u0275directiveInject"](s.a))},e.\u0275cmp=n["\u0275\u0275defineComponent"]({type:e,selectors:[["app-export-to-excel"]],inputs:{objects:"objects",filename:"filename"},decls:3,vars:0,consts:[[1,"btn","btn-sm","btn-success",3,"click"],[1,"fa","fa-file-excel-o"]],template:function(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"button",0),n["\u0275\u0275listener"]("click",(function(){return t.export()})),n["\u0275\u0275element"](1,"i",1),n["\u0275\u0275text"](2," Export To Excel"),n["\u0275\u0275elementEnd"]())},styles:[""]}),e})()},pEcs:function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));var n=i("fXoL");class s{constructor(){}}var a=i("c92J"),o=i("ccyI"),r=i("1VJT"),c=i("ofXK"),l=i("3Pt+"),d=i("hiAm");function h(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",8),n["\u0275\u0275listener"]("click",(function(){return n["\u0275\u0275restoreView"](e),n["\u0275\u0275nextContext"](3).addItem()})),n["\u0275\u0275element"](1,"i",9),n["\u0275\u0275elementEnd"]()}}function u(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"button",10),n["\u0275\u0275listener"]("click",(function(){return n["\u0275\u0275restoreView"](e),n["\u0275\u0275nextContext"](3).list()})),n["\u0275\u0275element"](1,"i",11),n["\u0275\u0275elementEnd"]()}}function p(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"option",12),n["\u0275\u0275text"](1),n["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;n["\u0275\u0275propertyInterpolate"]("value",e.id),n["\u0275\u0275advance"](1),n["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function f(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"span"),n["\u0275\u0275template"](1,h,2,0,"button",4),n["\u0275\u0275template"](2,u,2,0,"button",5),n["\u0275\u0275elementStart"](3,"select",6),n["\u0275\u0275listener"]("ngModelChange",(function(t){return n["\u0275\u0275restoreView"](e),n["\u0275\u0275nextContext"](2).selected_item=t}))("change",(function(){return n["\u0275\u0275restoreView"](e),n["\u0275\u0275nextContext"](2).itemSelected()})),n["\u0275\u0275template"](4,p,2,2,"option",7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()}if(2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.show_add),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.show_add),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngModel",e.selected_item),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.objects)}}function m(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"span",2),n["\u0275\u0275template"](1,f,5,4,"span",3),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.is_loaded)}}function g(e,t){1&e&&n["\u0275\u0275element"](0,"app-loading")}function y(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div"),n["\u0275\u0275elementStart"](1,"h4"),n["\u0275\u0275text"](2,"Not found"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]())}function b(e,t){if(1&e){const e=n["\u0275\u0275getCurrentView"]();n["\u0275\u0275elementStart"](0,"a",18),n["\u0275\u0275listener"]("click",(function(){n["\u0275\u0275restoreView"](e);const i=t.$implicit;return n["\u0275\u0275nextContext"](3).add(i)})),n["\u0275\u0275elementStart"](1,"b"),n["\u0275\u0275text"](2),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](3,"i",19),n["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;n["\u0275\u0275advance"](2),n["\u0275\u0275textInterpolate1"]("",e.name," ")}}function v(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",16),n["\u0275\u0275template"](1,b,4,1,"a",17),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"](2);n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngForOf",e.objects)}}function _(e,t){if(1&e&&(n["\u0275\u0275elementStart"](0,"div",13),n["\u0275\u0275elementStart"](1,"div",14),n["\u0275\u0275template"](2,g,1,0,"app-loading",3),n["\u0275\u0275template"](3,y,3,0,"div",3),n["\u0275\u0275template"](4,v,2,1,"div",15),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e){const e=n["\u0275\u0275nextContext"]();n["\u0275\u0275advance"](2),n["\u0275\u0275property"]("ngIf",e.is_searching),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.error_search),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf",e.is_finished_search)}}let S=(()=>{class e{constructor(e,t,i){this.dbService=e,this.authService=t,this.notify=i,this.onFinish=new n.EventEmitter,this.btn_text="Select",this.onAdd=new n.EventEmitter,this.type="select",this.show_add=!0,this.param="",this.selected=null,this.is_searching=!1,this.is_finished_search=!1,this.error_search=!1,this.is_loaded=!1,this.added=[]}ngOnInit(){console.log(this.type),"list"!=this.type&&"select"!=this.type||this.list(),"emit"==this.type&&this.getAll()}itemSelected(){for(var e=0;e<this.objects.length;e++)if(this.objects[e].id==this.selected_item){this.onFinish.emit(this.objects[e]);break}}itemAdded(e){this.objects.push(e),$("#add_vendor_modal").modal("hide"),this.onFinish.emit(e)}list(){this.is_loaded=!1,this.notify.showLoading(),this.dbService.getData("admin/getBranches?only_others=yes",this.authService.current_user).subscribe(e=>{this.notify.hideLoading(),"-1"===e.status||(this.objects=e.data,this.is_loaded=!0)},e=>{this.notify.hideLoading(),this.notify.noConnectionNotification()})}getAll(){this.is_loaded=!1,this.notify.showLoading();let e="admin/getBranches?only_others=no";"admin"==this.authService.current_user.type&&(e+="&parent_company_id="+this.authService.current_user.parent_company_id),this.dbService.getData(e,this.authService.current_user).subscribe(e=>{this.notify.hideLoading(),"-1"===e.status||(this.objects=e.data,this.onFinish.emit(this.objects),this.is_loaded=!0)},e=>{this.notify.hideLoading(),this.notify.noConnectionNotification()})}add(e){this.added.push(e),this.onAdd.emit(e),e.is_selected=!0}select(e){this.selected=e,this.onFinish.emit(e)}addItem(){this.notify.showLoading();let e=window.prompt("Enter name of branch");if(this.dbService.isEmpty(e))return this.notify.failNotification("name is required"),!1;let t=window.prompt("Enter phone number of branch");if(this.dbService.isEmpty(t))return this.notify.failNotification("Phone number is required"),!1;let i=new FormData;i.append("name",e),i.append("phone",t),this.dbService.postData(i,"admin/saveBranch",this.authService.current_user).subscribe(i=>{if(this.notify.hideLoading(),"-1"===i.status)this.notify.failNotification("Server error. Please try again");else if("-1"===i.status)this.notify.failNotification("Unable to authenticate. Please login again");else if("-9"===i.status)this.notify.showNotification("You are not permitted to perform this action","fail",3e3);else{let n=new s;n.id=i.status,n.name=e,n.phone=t,this.objects.push(n),this.notify.successNotification("Branch added successfully"),this.selected_item=n.id,this.itemSelected()}},e=>{this.notify.noConnectionNotification()})}}return e.\u0275fac=function(t){return new(t||e)(n["\u0275\u0275directiveInject"](a.a),n["\u0275\u0275directiveInject"](o.a),n["\u0275\u0275directiveInject"](r.a))},e.\u0275cmp=n["\u0275\u0275defineComponent"]({type:e,selectors:[["app-select-branch"]],inputs:{btn_text:"btn_text",type:"type",show_add:"show_add",selected_item:"selected_item"},outputs:{onFinish:"onFinish",onAdd:"onAdd"},decls:2,vars:2,consts:[["class","",4,"ngIf"],["class","card",4,"ngIf"],[1,""],[4,"ngIf"],["type","button","class","btn btn-sm btn-primary",3,"click",4,"ngIf"],["type","button","class","btn btn-sm btn-info",3,"click",4,"ngIf"],["name","vendors",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fa","fa-plus"],["type","button",1,"btn","btn-sm","btn-info",3,"click"],[1,"fa","fa-refresh"],[3,"value"],[1,"card"],[1,"body"],["class","list-group",4,"ngIf"],[1,"list-group"],["class","list-group-item",3,"click",4,"ngFor","ngForOf"],[1,"list-group-item",3,"click"],[1,"fa","fa-plus","pull-right"]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,m,2,1,"span",0),n["\u0275\u0275template"](1,_,5,3,"div",1)),2&e&&(n["\u0275\u0275property"]("ngIf","select"==t.type),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("ngIf","list"==t.type))},directives:[c.j,l.m,l.e,l.h,c.i,l.i,l.n,d.a],styles:[""]}),e})()},rfqN:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("fXoL"),s=i("c92J"),a=i("1VJT"),o=i("ccyI"),r=i("ofXK"),c=i("n49D"),l=i("nVU4");const d=["agGrid"];function h(e,t){1&e&&(n["\u0275\u0275elementStart"](0,"div",1),n["\u0275\u0275elementStart"](1,"h4"),n["\u0275\u0275text"](2,"No results"),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]())}let u=(()=>{class e{constructor(e,t,i){this.dbService=e,this.notify=t,this.authService=i,this.objects=[],this.show_options=!0,this.type="",this.receipt="",this.onReturn=new n.EventEmitter,this.can_view=!0,this.can_edit=!0,this.can_create=!0,this.can_delete=!0,this.edit_keys=["quantity"],this.offset=0,this.summary=[],this.overall_total=0,this.quantity_error=!1,this.columnDefs=[{headerName:"Product",field:"product_name",sortable:!0,filter:!0,checkboxSelection:!1},{headerName:"Quantity",field:"quantity",sortable:!0,filter:!0},{headerName:"Price",field:"price",sortable:!0,filter:!0},{headerName:"Total Amount",field:"total",sortable:!0,filter:!0},{headerName:"Receipt",field:"code",sortable:!0,filter:!0},{headerName:"Date",field:"date",sortable:!0,filter:!0}],this.rowData=[],this.selected_items=[],-1==this.authService.current_user.permissions.indexOf("Delete Transfers")&&(this.can_delete=!1),this.defaultColDef={resizable:!0}}ngOnInit(){this.prep()}onGridReady(e){this.gridApi=e.api,this.agGrid.api.sizeColumnsToFit()}onSelectionChanged(e){var t=this.gridApi.getSelectedRows();this.selected_items=t}ngOnChanges(){this.prep()}prep(){this.objects.map(e=>{e.total=e.price*e.quantity}),this.calculateTotals()}startEdit(e){this.selected=e,this.new_quantity=this.selected.quantity,$("#edit_sale_modal").modal({backdrop:"static",keyboard:!1})}returnSelected(){$("#return_sale_modal").modal({backdrop:"static",keyboard:!1})}getSelectedRows(){const e=this.agGrid.api.getSelectedNodes().map(e=>e.data).map(e=>e.product_name+" "+e.price).join(", ");alert(`Selected nodes: ${e}`)}checkQuantity(){this.quantity_error=!1,parseInt(this.new_quantity)>this.selected.quantity&&(this.quantity_error=!0,this.new_quantity=this.selected.quantity)}saveReturns(){if(null==this.selected_items||null==this.selected_items||this.selected_items.length<1)return this.notify.failNotification("Please add at least one product"),!1;this.notify.showLoading();for(var e=[],t=[],i=[],n=[],s="RFS-"+this.dbService.getToday("timestamp_string"),a=0;a<this.selected_items.length;a++){var o=this.selected_items[a];e.push(o.product_id),t.push(o.price),i.push(-1*o.quantity),n.push(o.product_name)}let r=new FormData;r.append("products",e.join("||")),r.append("prices",t.join("||")),r.append("quantities",i.join("||")),r.append("code",s),r.append("product_names",n.join("||")),r.append("amount_paid","0"),r.append("created_by",this.authService.current_user.id),r.append("date",this.dbService.getToday()),r.append("display_name",this.authService.current_user.display_name),r.append("payment_method","Return"),this.dbService.postData(r,"sale/saveBulk",this.authService.current_user).subscribe(e=>{this.notify.hideLoading(),"-1"===e.status?this.notify.failNotification("Unable to authenticate. Please login again"):"-9"===e.status?this.notify.showNotification("You are not permitted to perform this action","fail",3e3):($("#return_sale_modal").modal("hide"),this.agGrid.api.deselectAll(),this.selected_items=[],this.notify.hideLoading(),this.onReturn.emit(e.code),this.notify.successNotification("Items returned successfully"))},e=>{this.notify.hideLoading(),this.notify.noConnectionNotification(),console.log(e)})}saveQuantity(){$("#edit_sale_modal").modal("hide");let e=new FormData;this.notify.showLoading();var t=-1*parseFloat(this.new_quantity);e.append("quantities",t.toString()),e.append("products",this.selected.product.id),e.append("prices",this.selected.price.toFixed(2)),e.append("product_name",this.selected.product.name),e.append("created_by",this.authService.current_user.id),e.append("date",this.dbService.getToday()),this.dbService.postData(e,"sale/saveBulk",this.authService.current_user).subscribe(e=>{switch(this.notify.hideLoading(),e.status){case"0":this.notify.failNotification("You are not logged in");break;case"-1":this.notify.failNotification("server error. Contact admin");break;case"-9":this.notify.failNotification("You are not permitted ");break;default:this.notify.successNotification("sale edited successfully"),this.calculateTotals()}},e=>{this.notify.noConnectionNotification()})}delete(e){if(window.confirm("Sure you want to delete this sale? You cannot undo this")){let t=new FormData;this.notify.showLoading(),t.append("id",e.id),t.append("display_name",this.authService.current_user.display_name),t.append("code",e.code),t.append("name",e.product.name),this.dbService.postData(t,"sale/deleteItem",this.authService.current_user).subscribe(t=>{this.notify.hideLoading(),"1"===t.status&&(this.objects.splice(this.objects.indexOf(e),1),this.notify.showNotification("Sale deleted successfully","success",3e3),this.calculateTotals())},e=>{this.notify.noConnectionNotification()})}}calculateTotals(){var e=0;this.objects.map(t=>{e+=t.price*t.quantity}),this.overall_total=e}}return e.\u0275fac=function(t){return new(t||e)(n["\u0275\u0275directiveInject"](s.a),n["\u0275\u0275directiveInject"](a.a),n["\u0275\u0275directiveInject"](o.a))},e.\u0275cmp=n["\u0275\u0275defineComponent"]({type:e,selectors:[["app-transfer-history"]],viewQuery:function(e,t){var i;1&e&&n["\u0275\u0275viewQuery"](d,!0),2&e&&n["\u0275\u0275queryRefresh"](i=n["\u0275\u0275loadQuery"]())&&(t.agGrid=i.first)},inputs:{objects:"objects",show_options:"show_options",type:"type",receipt:"receipt",offset:"offset"},outputs:{onReturn:"onReturn"},features:[n["\u0275\u0275NgOnChangesFeature"]],decls:11,vars:6,consts:[["class","",4,"ngIf"],[1,""],["id","sales_details"],[1,"well"],[1,"text-danger"],[3,"objects"],["rowSelection","single",1,"ag-theme-balham",2,"width","100%","height","400px","font-family","Muli","font-size","15px",3,"rowData","columnDefs","defaultColDef","selectionChanged","gridReady"],["agGrid",""]],template:function(e,t){1&e&&(n["\u0275\u0275template"](0,h,3,0,"div",0),n["\u0275\u0275elementStart"](1,"div",1),n["\u0275\u0275elementStart"](2,"div",2),n["\u0275\u0275elementStart"](3,"div",3),n["\u0275\u0275elementStart"](4,"b"),n["\u0275\u0275text"](5,"Overall Total: "),n["\u0275\u0275elementStart"](6,"span",4),n["\u0275\u0275text"](7),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275element"](8,"app-export-to-excel",5),n["\u0275\u0275elementStart"](9,"ag-grid-angular",6,7),n["\u0275\u0275listener"]("selectionChanged",(function(e){return t.onSelectionChanged(e)}))("gridReady",(function(e){return t.onGridReady(e)})),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"](),n["\u0275\u0275elementEnd"]()),2&e&&(n["\u0275\u0275property"]("ngIf",t.objects.length<1),n["\u0275\u0275advance"](7),n["\u0275\u0275textInterpolate1"]("GHC ",t.overall_total.toFixed(2),""),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("objects",t.objects),n["\u0275\u0275advance"](1),n["\u0275\u0275property"]("rowData",t.objects)("columnDefs",t.columnDefs)("defaultColDef",t.defaultColDef))},directives:[r.j,c.a,l.AgGridAngular],styles:[""]}),e})()},wDHj:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("ofXK"),s=i("nEHF"),a=i("6QD7"),o=i("fXoL");let r=(()=>{class e{}return e.\u0275mod=o["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=o["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[n.b,s.a,a.b],a.b]}),e})()}}]);