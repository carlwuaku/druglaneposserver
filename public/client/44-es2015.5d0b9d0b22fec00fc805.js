(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{hiAm:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("fXoL");let o=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n["\u0275\u0275defineComponent"]({type:e,selectors:[["app-loading"]],decls:2,vars:0,consts:[[1,"fa","fa-spin","fa-spinner"]],template:function(e,t){1&e&&(n["\u0275\u0275element"](0,"i",0),n["\u0275\u0275text"](1," Loading..."))},styles:[""]}),e})()},icKv:function(e,t,i){"use strict";i.r(t),i.d(t,"DbIssuesModule",(function(){return y}));var n=i("ofXK"),o=i("tyNb"),s=i("fXoL"),a=i("ccyI"),r=i("1VJT"),c=i("c92J"),l=i("nVU4"),d=i("hiAm");const u=["productsGrid"];function h(e,t){1&e&&s["\u0275\u0275element"](0,"app-loading")}const f=[{path:"",component:(()=>{class e{constructor(e,t,i,n){this.authService=e,this.notify=i,this.dbService=n,this.refresh=new s.EventEmitter,this.rowDataClicked1={},this.columnDefs=[{headerName:"#",valueGetter:"node.rowIndex + 1",checkboxSelection:!0,autoHeight:!0,cellClass:"bordered"},{headerName:"Name",field:"name",sortable:!0,filter:!0,cellClass:"bordered"},{headerName:"Duplicate count",field:"total",sortable:!0,filter:!0,cellClass:"bordered"}],this.offset=0,this.objects=[],this.is_loading=!1,this.is_loaded=!1,this.quick_option="this_month",this.selected_items=[],null!=t.snapshot.params.quick_option&&null!=t.snapshot.params.quick_option&&(this.quick_option=t.snapshot.params.quick_option),-1==this.authService.current_user.permissions.indexOf("View Inventory")&&(this.notify.failNotification("You are not permitted to view the page"),this.dbService.goBackHome()),this.dbService.setTitle("Database Maintenance"),this.defaultColDef={flex:1,minWidth:100,resizable:!0,headerCheckboxSelection:this.isFirstColumn,checkboxSelection:this.isFirstColumn}}ngOnInit(){this.getData()}ngOnChanges(){this.getData()}onGridReady(e){this.gridApi=e.api}onSelectionChanged(e){var t=this.gridApi.getSelectedRows();this.selected_items=t}getData(){this.is_loading=!0,this.notify.showLoading(),this.dbService.getData("product/getDuplicateList?company_id="+this.authService.current_user.company_id,this.authService.current_user).subscribe(e=>{this.objects=e.data,this.notify.hideLoading(),this.is_loading=!1},e=>{this.is_loading=!1,this.notify.noConnectionNotification()})}submit(){if(this.selected_items.length<1)return alert("Please select some items first"),!1;if(!window.confirm("Sure you want to merge the selected products? This operation cannot be undone"))return!1;this.notify.showLoading();let e=new FormData,t=[];this.selected_items.map(e=>{t.push(e.id)}),e.append("ids",t.join("|||")),this.dbService.postData(e,"product/mergeDuplicates",this.authService.current_user).subscribe(e=>{this.notify.hideLoading(),"-1"===e.status?this.notify.failNotification("Server error. Please check that you filled the form correctly and try again"):"0"===e.status?this.notify.failNotification("Unable to authenticate. Login and try again"):"-9"===e.status?this.notify.showNotification("You are not permitted to perform this action","fail",3e3):this.notify.successNotification("Items merged saved successfully"),this.getData()},e=>{this.notify.hideLoading(),this.notify.noConnectionNotification()})}goBack(){window.history.back()}isFirstColumn(e){return e.columnApi.getAllDisplayedColumns()[0]===e.column}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](a.a),s["\u0275\u0275directiveInject"](o.a),s["\u0275\u0275directiveInject"](r.a),s["\u0275\u0275directiveInject"](c.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-db-issues"]],viewQuery:function(e,t){var i;1&e&&s["\u0275\u0275viewQuery"](u,!0),2&e&&s["\u0275\u0275queryRefresh"](i=s["\u0275\u0275loadQuery"]())&&(t.agGrid=i.first)},outputs:{refresh:"refresh"},features:[s["\u0275\u0275NgOnChangesFeature"]],decls:17,vars:6,consts:[[1,"content"],[1,"container"],[1,"row"],[1,"col-12"],[1,"card","card-body"],[1,"card-header"],[1,"btn","btn-success",3,"click"],[1,"card-body"],[4,"ngIf"],["rowSelection","multiple",1,"ag-theme-balham",2,"width","100%","height","400px","font-family","Muli","font-size","15px",3,"rowData","columnDefs","suppressMenuHide","defaultColDef","gridReady","selectionChanged"],["productsGrid",""]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"section",0),s["\u0275\u0275elementStart"](1,"div",1),s["\u0275\u0275elementStart"](2,"div",2),s["\u0275\u0275elementStart"](3,"div",3),s["\u0275\u0275elementStart"](4,"h5"),s["\u0275\u0275text"](5,"Duplicate Products"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](6,"div",4),s["\u0275\u0275elementStart"](7,"div",5),s["\u0275\u0275elementStart"](8,"button",6),s["\u0275\u0275listener"]("click",(function(){return t.submit()})),s["\u0275\u0275text"](9,"Merge Selected"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](10,"div",7),s["\u0275\u0275template"](11,h,1,0,"app-loading",8),s["\u0275\u0275elementStart"](12,"h5"),s["\u0275\u0275text"](13),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](14,"table"),s["\u0275\u0275elementStart"](15,"ag-grid-angular",9,10),s["\u0275\u0275listener"]("gridReady",(function(e){return t.onGridReady(e)}))("selectionChanged",(function(e){return t.onSelectionChanged(e)})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](11),s["\u0275\u0275property"]("ngIf",t.is_loading),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",t.objects.length," Items "),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("rowData",t.objects)("columnDefs",t.columnDefs)("suppressMenuHide",!0)("defaultColDef",t.defaultColDef))},directives:[n.j,l.AgGridAngular,d.a],styles:[""]}),e})()}];let m=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.f.forChild(f)],o.f]}),e})();var p=i("nEHF"),g=i("nBlB");let y=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[n.b,m,p.a,g.a]]}),e})()},nBlB:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("ofXK"),o=i("nEHF"),s=i("fXoL");let a=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[n.b,o.a]]}),e})()}}]);