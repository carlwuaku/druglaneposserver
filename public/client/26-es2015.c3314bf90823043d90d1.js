(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{SqMz:function(e,t,n){"use strict";n.r(t),n.d(t,"ProductDetailsModule",(function(){return G}));var a=n("ofXK"),i=n("tyNb"),s=n("fXoL"),r=n("c92J"),l=n("1VJT"),d=n("ccyI"),o=n("thd7"),c=n("iuVp"),m=n("6CxU"),h=n("hiAm"),p=n("STgK"),u=n("rfqN");function f(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"button",49),s["\u0275\u0275element"](1,"i",50),s["\u0275\u0275text"](2," Edit"),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275propertyInterpolate1"]("routerLink","/edit_product/",e.id,"")}}function _(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"button",51),s["\u0275\u0275listener"]("click",(function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().delete()})),s["\u0275\u0275element"](1,"i",52),s["\u0275\u0275text"](2," Delete"),s["\u0275\u0275elementEnd"]()}}function v(e,t){1&e&&s["\u0275\u0275element"](0,"app-loading")}function S(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"div"),s["\u0275\u0275elementStart"](1,"h4"),s["\u0275\u0275text"](2,"Product not found. Error"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]())}function b(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",2),s["\u0275\u0275elementStart"](1,"div",53),s["\u0275\u0275elementStart"](2,"div",54),s["\u0275\u0275elementStart"](3,"span",55),s["\u0275\u0275element"](4,"i",56),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"div",57),s["\u0275\u0275elementStart"](6,"span",58),s["\u0275\u0275text"](7,"Current Stock"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](8,"span",59),s["\u0275\u0275text"](9),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](10,"div",53),s["\u0275\u0275elementStart"](11,"div",54),s["\u0275\u0275elementStart"](12,"span",55),s["\u0275\u0275element"](13,"i",60),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](14,"div",57),s["\u0275\u0275elementStart"](15,"span",58),s["\u0275\u0275text"](16,"Stock Value"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](17,"span",59),s["\u0275\u0275text"](18),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](19,"div",53),s["\u0275\u0275elementStart"](20,"div",54),s["\u0275\u0275elementStart"](21,"span",61),s["\u0275\u0275element"](22,"i",60),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](23,"div",57),s["\u0275\u0275elementStart"](24,"span",58),s["\u0275\u0275text"](25,"Sold This Month"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](26,"span",59),s["\u0275\u0275text"](27),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](28,"div",53),s["\u0275\u0275elementStart"](29,"div",54),s["\u0275\u0275elementStart"](30,"span",62),s["\u0275\u0275element"](31,"i",60),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](32,"div",57),s["\u0275\u0275elementStart"](33,"span",58),s["\u0275\u0275text"](34,"Sold Last Month"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](35,"span",59),s["\u0275\u0275text"](36),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](9),s["\u0275\u0275textInterpolate"](e.object.stock),s["\u0275\u0275advance"](9),s["\u0275\u0275textInterpolate"](e.object.stock_value),s["\u0275\u0275advance"](9),s["\u0275\u0275textInterpolate2"]("",e.object.this_month_quantity," (GH\xa2 ",e.object.this_month_amount,") "),s["\u0275\u0275advance"](9),s["\u0275\u0275textInterpolate2"]("",e.object.last_month_quantity," (GH\xa2 ",e.object.last_month_amount,")")}}function g(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"tr"),s["\u0275\u0275elementStart"](1,"td"),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"td"),s["\u0275\u0275text"](4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"td"),s["\u0275\u0275text"](6),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"td"),s["\u0275\u0275text"](8),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](9,"td"),s["\u0275\u0275text"](10),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](11,"td"),s["\u0275\u0275text"](12),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](13,"td"),s["\u0275\u0275text"](14),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=t.index;s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",n+1," "),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",e.batch_number," "),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](e.expiry),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](e.quantity),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](e.purchase_code),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](e.barcode),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",e.quantity_sold," ")}}function y(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",2),s["\u0275\u0275elementStart"](1,"div",63),s["\u0275\u0275elementStart"](2,"table",64),s["\u0275\u0275elementStart"](3,"tr"),s["\u0275\u0275elementStart"](4,"td"),s["\u0275\u0275text"](5,"Name"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](6,"td"),s["\u0275\u0275text"](7),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](8,"tr"),s["\u0275\u0275elementStart"](9,"td"),s["\u0275\u0275text"](10,"Category"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](11,"td"),s["\u0275\u0275text"](12),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](13,"tr"),s["\u0275\u0275elementStart"](14,"td"),s["\u0275\u0275text"](15,"Current Stock"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](16,"td"),s["\u0275\u0275text"](17),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](18,"tr"),s["\u0275\u0275elementStart"](19,"td"),s["\u0275\u0275text"](20,"Selling Price"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](21,"td"),s["\u0275\u0275text"](22),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](23,"tr"),s["\u0275\u0275elementStart"](24,"td"),s["\u0275\u0275text"](25,"Unit"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](26,"td"),s["\u0275\u0275text"](27),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](28,"tr"),s["\u0275\u0275elementStart"](29,"td"),s["\u0275\u0275text"](30,"Cost Price"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](31,"td"),s["\u0275\u0275text"](32),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](33,"tr"),s["\u0275\u0275elementStart"](34,"td"),s["\u0275\u0275text"](35,"Expiry Date"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](36,"td"),s["\u0275\u0275text"](37),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](38,"tr"),s["\u0275\u0275elementStart"](39,"td"),s["\u0275\u0275text"](40,"Notes"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](41,"td"),s["\u0275\u0275text"](42),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](43,"tr"),s["\u0275\u0275elementStart"](44,"td"),s["\u0275\u0275text"](45,"Size"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](46,"td"),s["\u0275\u0275text"](47),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](48,"tr"),s["\u0275\u0275elementStart"](49,"td"),s["\u0275\u0275text"](50,"Shelf/Location"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](51,"td"),s["\u0275\u0275text"](52),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](53,"tr"),s["\u0275\u0275elementStart"](54,"td"),s["\u0275\u0275text"](55,"Barcode"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](56,"td"),s["\u0275\u0275text"](57),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](58,"div",63),s["\u0275\u0275elementStart"](59,"h6"),s["\u0275\u0275text"](60,"Batches"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](61,"table",32),s["\u0275\u0275elementStart"](62,"thead"),s["\u0275\u0275elementStart"](63,"tr"),s["\u0275\u0275elementStart"](64,"th"),s["\u0275\u0275text"](65,"#"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](66,"th"),s["\u0275\u0275text"](67,"Batch Number"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](68,"th"),s["\u0275\u0275text"](69,"Expiry Date"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](70,"th"),s["\u0275\u0275text"](71,"Quantity"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](72,"th"),s["\u0275\u0275text"](73,"Purchase Invoice"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](74,"th"),s["\u0275\u0275text"](75,"Barcode"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](76,"th"),s["\u0275\u0275text"](77,"Quantity Sold"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](78,"tbody"),s["\u0275\u0275template"](79,g,15,7,"tr",33),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](7),s["\u0275\u0275textInterpolate1"]("",e.object.name," "),s["\u0275\u0275advance"](5),s["\u0275\u0275textInterpolate1"]("",e.object.category," "),s["\u0275\u0275advance"](5),s["\u0275\u0275textInterpolate1"]("",e.object.stock," "),s["\u0275\u0275advance"](5),s["\u0275\u0275textInterpolate1"]("",e.object.price," "),s["\u0275\u0275advance"](5),s["\u0275\u0275textInterpolate1"]("",e.object.unit," "),s["\u0275\u0275advance"](5),s["\u0275\u0275textInterpolate1"]("",e.object.cost_price," "),s["\u0275\u0275advance"](5),s["\u0275\u0275textInterpolate1"]("",e.object.expiry," "),s["\u0275\u0275advance"](5),s["\u0275\u0275textInterpolate1"]("",e.object.notes," "),s["\u0275\u0275advance"](5),s["\u0275\u0275textInterpolate1"]("",e.object.size," "),s["\u0275\u0275advance"](5),s["\u0275\u0275textInterpolate1"]("",e.object.shelf," "),s["\u0275\u0275advance"](5),s["\u0275\u0275textInterpolate1"]("",e.object.barcode," "),s["\u0275\u0275advance"](22),s["\u0275\u0275property"]("ngForOf",e.object.batches)}}function E(e,t){1&e&&s["\u0275\u0275element"](0,"app-loading")}function x(e,t){1&e&&s["\u0275\u0275element"](0,"app-loading")}function I(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"tr"),s["\u0275\u0275elementStart"](1,"td"),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"td"),s["\u0275\u0275text"](4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"td"),s["\u0275\u0275text"](6),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"td"),s["\u0275\u0275text"](8),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](9,"td"),s["\u0275\u0275text"](10),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](11,"td"),s["\u0275\u0275elementStart"](12,"a",65),s["\u0275\u0275text"](13),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](14,"td"),s["\u0275\u0275text"](15),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](16,"td"),s["\u0275\u0275text"](17),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=t.index;s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",n+1," "),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",e.date," "),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](e.price),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](e.quantity),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](e.vendor_name),s["\u0275\u0275advance"](2),s["\u0275\u0275propertyInterpolate1"]("routerLink","/view_invoice/",e.code,"/purchase"),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"]("",e.code," "),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](e.markup),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",e.display_name," ")}}function w(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",66),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" Sales Invoice: #",e.selected_item.invoice," ")}}function j(e,t){1&e&&s["\u0275\u0275element"](0,"app-loading")}function k(e,t){if(1&e&&s["\u0275\u0275element"](0,"app-sales-history",67),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275property"]("show_return",!1)("objects",e.sale_invoice_objects)}}function D(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",66),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" Purchase Invoice - #",e.selected_item.invoice," ")}}function C(e,t){1&e&&s["\u0275\u0275element"](0,"app-loading")}function N(e,t){if(1&e&&s["\u0275\u0275element"](0,"app-purchase-history",68),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275property"]("objects",e.purchase_invoice_objects)}}function q(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",66),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" Transfer Invoice - #",e.selected_item.invoice," ")}}function L(e,t){1&e&&s["\u0275\u0275element"](0,"app-loading")}function P(e,t){if(1&e&&s["\u0275\u0275element"](0,"app-transfer-history",68),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275property"]("objects",e.transfer_invoice_objects)}}const T=[{path:"",component:(()=>{class e{constructor(e,t,n,a){this.dbService=t,this.notify=n,this.authService=a,this.error=!1,this.is_loading=!0,this.is_loaded=!1,this.orders=[],this.is_loading_orders=!0,this.is_loaded_orders=!1,this.sales=[],this.is_loading_sales=!0,this.is_loaded_sales=!1,this.purchases=[],this.is_loading_purchases=!0,this.is_loaded_purchases=!1,this.prices=[],this.is_loading_prices=!0,this.is_loaded_prices=!1,this.stock_changes=[],this.branches=[],-1==this.authService.current_user.permissions.indexOf("View Inventory")&&(this.notify.failNotification("You are not permitted to view the page"),this.goBack()),this.user_type=this.authService.current_user.type,this.dbService.setTitle("Product Details"),this.id=e.snapshot.params.id}ngOnInit(){this.getObject(this.id)}getObject(e){this.is_loading=!0,this.is_loaded=!1,this.error=!1,this.dbService.getDataWithQuery("product/findById",this.authService.current_user,"id="+this.id+"&company_id="+this.authService.current_user.company_id+"&user_type="+this.authService.current_user.type).subscribe(e=>{"1"==e.status?(this.object=e.data,this.is_loading=!1,this.is_loaded=!0,this.error=!1,this.getChanges()):(this.is_loading=!1,this.is_loaded=!1,this.error=!0)},e=>{this.is_loading=!1,this.error=!0,this.is_loaded=!1})}getOrders(){this.dbService.getDataWithQuery("order/getList",this.authService.current_user,"product="+this.object.name).subscribe(e=>{this.orders=e.data,this.is_loading_orders=!1,this.is_loaded_orders=!0},e=>{this.is_loading_orders=!1,this.is_loaded_orders=!1})}getSales(){this.dbService.getDataWithQuery("sale/getProductSales",this.authService.current_user,"product="+this.object.id+"&company_id="+this.authService.current_user.company_id).subscribe(e=>{this.sales=e.data,this.is_loading_sales=!1,this.is_loaded_sales=!0},e=>{this.is_loading_sales=!1,this.is_loaded_sales=!1})}getChanges(){this.dbService.getDataWithQuery("product/getStockChanges",this.authService.current_user,"product="+this.object.id+"&company_id="+this.authService.current_user.company_id).subscribe(e=>{if("-1"==e.status);else{this.dbService.sortObjects(e.data,"timestamp");var t=0;e.data.map(e=>{switch(e.type){case"sale":e.previous_stock=t,e.new_stock=t-=parseInt(e.quantity);break;case"stock_adjustment":e.previous_stock=t,e.new_stock=t=parseInt(e.quantity);break;case"purchase":case"transfer":e.previous_stock=t,e.new_stock=t+=parseInt(e.quantity)}}),this.stock_changes=e.data}this.is_loading_purchases=!1,this.is_loaded_purchases=!0},e=>{this.is_loading_purchases=!1,this.is_loaded_purchases=!1})}showDetails(e){switch(e.type){case"purchase":this.showPurchaseInvoiceDetails(e);break;case"transfer":this.showTransferInvoiceDetails(e);break;case"sale":default:this.showSalesInvoiceDetails(e.invoice)}}showSalesInvoiceDetails(e){$("#sale_details_modal").modal("show"),this.is_loaded_sales_details=!1,this.is_loading_sales_details=!0,this.dbService.getData("sale/getSaleDetails?code="+e+"&company_id="+this.authService.current_user.company_id,this.authService.current_user).subscribe(e=>{this.sale_invoice_objects=e.data,this.sale_invoice_objects.map(e=>{}),this.is_loaded_sales_details=!0,this.is_loading_sales_details=!1},e=>{this.is_loaded_sales_details=!0,this.is_loading_sales_details=!1,this.notify.failNotification("Unable to get sales")})}showPurchaseInvoiceDetails(e){$("#purchase_details_modal").modal("show"),this.selected_item=e,this.is_loaded_purchase_details=!1,this.is_loading_purchase_details=!0,this.dbService.getData("purchase/getDetails?code="+e.invoice+"&company_id="+this.authService.current_user.company_id,this.authService.current_user).subscribe(e=>{this.purchase_invoice_objects=e.data,this.purchase_invoice_objects.map(e=>{}),this.is_loaded_purchase_details=!0,this.is_loading_purchase_details=!1},e=>{this.is_loaded_purchase_details=!0,this.is_loading_purchase_details=!1,this.notify.failNotification("Unable to get purchases invoice")})}showTransferInvoiceDetails(e){$("#transfer_details_modal").modal("show"),this.selected_item=e,this.is_loaded_transfer_details=!1,this.is_loading_transfer_details=!0,this.dbService.getData("transfer/getDetails?code="+e.invoice+"&company_id="+this.authService.current_user.company_id,this.authService.current_user).subscribe(e=>{this.transfer_invoice_objects=e.data,this.transfer_invoice_objects.map(e=>{}),this.is_loaded_transfer_details=!0,this.is_loading_transfer_details=!1},e=>{this.is_loaded_transfer_details=!0,this.is_loading_transfer_details=!1,this.notify.failNotification("Unable to get transfers")})}goBack(){window.history.back()}getBranchDetails(){this.is_loading_branches=!0,this.notify.showLoading(),this.dbService.getData("product/getBranchProductDetails?only_others=no&product_id="+this.id,this.authService.current_user).subscribe(e=>{this.notify.hideLoading(),"-1"===e.status||(this.branches=e.data,this.is_loading_branches=!1)},e=>{this.is_loading_branches=!0,this.notify.hideLoading(),this.notify.noConnectionNotification()})}salesSelected(e){this.showSalesInvoiceDetails(e[0].code)}delete(){if(window.confirm("Sure you want to delete the selected products?")){var e=[this.id];let t=new FormData;this.notify.showLoading(),t.append("id",e.toString()),this.dbService.postData(t,"product/delete",this.authService.current_user).subscribe(e=>{switch(this.notify.hideLoading(),e.status){case"0":this.notify.failNotification("Error: You are not logged in");break;case"-9":this.notify.failNotification("Error: You are not permitted");break;case"-1":$("#erase_modal").modal("show");break;default:this.goBack(),this.notify.showNotification("Products deleted successfully","success",3e3)}},e=>{this.notify.noConnectionNotification()})}}erase(){$("#erase_modal").modal("hide");var e=[this.id];let t=new FormData;this.notify.showLoading(),t.append("id",e.toString()),this.dbService.postData(t,"product/erase",this.authService.current_user).subscribe(e=>{switch(this.notify.hideLoading(),e.status){case"0":this.notify.failNotification("Error: You are not logged in");break;case"-9":this.notify.failNotification("Error: You are not permitted");break;case"-1":alert("Server error! Please try again or contact admin");break;default:this.goBack(),this.notify.showNotification("Products deleted successfully","success",3e3)}},e=>{this.notify.noConnectionNotification()})}showPriceHistory(){this.is_loaded_prices=!1,this.is_loading_prices=!0,this.dbService.getData("purchase/getProductPurchases?product="+this.id+"&company_id="+this.authService.current_user.company_id,this.authService.current_user).subscribe(e=>{this.prices=e.data,this.is_loaded_prices=!0,this.is_loading_prices=!1},e=>{this.is_loaded_prices=!1,this.is_loading_prices=!1,this.notify.failNotification("Unable to get price history")})}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](i.a),s["\u0275\u0275directiveInject"](r.a),s["\u0275\u0275directiveInject"](l.a),s["\u0275\u0275directiveInject"](d.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-product-details"]],decls:125,vars:21,consts:[[1,"content"],[1,"container"],[1,"row"],[1,"col-12"],["class","btn btn-sm btn-primary",3,"routerLink",4,"ngIf"],[1,"btn","btn-sm","btn-info",3,"click"],[1,"fa","fa-refresh"],["class","btn btn-sm btn-danger",3,"click",4,"ngIf"],[4,"ngIf"],["class","row",4,"ngIf"],["role","tablist",1,"nav","nav-tabs","md-tabs"],[1,"nav-item"],["role","tab","href","#details","data-toggle","tab",1,"nav-link","active"],[1,"slide"],["role","tab","href","#purchase","data-toggle","tab",1,"nav-link"],["role","tab","href","#consumption","data-toggle","tab",1,"nav-link"],[1,"nav-item",3,"click"],["role","tab","href","#sales","data-toggle","tab",1,"nav-link"],["role","tab","href","#prices","data-toggle","tab",1,"nav-link"],[1,"tab-content","tabs","card-block"],["role","tabpanel","id","details",1,"tab-pane","active"],[1,"card"],[1,"card-body"],["role","tabpanel","id","purchase",1,"tab-pane"],[1,"card-header"],[1,"fa","fa-info"],[3,"id"],["role","tabpanel","id","consumption",1,"tab-pane"],["role","tabpanel","id","sales",1,"tab-pane"],[3,"objects","onFinish"],["role","tabpanel","id","prices",1,"tab-pane"],[1,"card-body","table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[4,"ngFor","ngForOf"],["id","sale_details_modal","tabindex","-1","role","dialog",1,"modal","fade"],["role","document",1,"modal-dialog"],[1,"modal-content"],["class","modal-header",4,"ngIf"],[1,"modal-body"],[3,"show_return","objects",4,"ngIf"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-danger"],["id","purchase_details_modal","tabindex","-1","role","dialog",1,"modal","fade"],[3,"objects",4,"ngIf"],["id","transfer_details_modal","tabindex","-1","role","dialog",1,"modal","fade"],["id","erase_modal","tabindex","-1","role","dialog",1,"modal","fade"],[1,"modal-header","text-danger"],["data-dismiss","modal",1,"btn","btn-danger","btn-sm"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"btn","btn-sm","btn-primary",3,"routerLink"],[1,"fa","fa-edit"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fa","fa-remove"],[1,"col-md-3","col-sm-6","col-12"],[1,"info-box"],[1,"info-box-icon","bg-warning"],[1,"fa","fa-database"],[1,"info-box-content"],[1,"info-box-text"],[1,"info-box-number"],[1,"fa","fa-dollar"],[1,"info-box-icon","bg-info"],[1,"info-box-icon","bg-success"],[1,"col-md-4"],[1,"table","table-striped","table-bordered"],[3,"routerLink"],[1,"modal-header"],[3,"show_return","objects"],[3,"objects"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"section",0),s["\u0275\u0275elementStart"](1,"div",1),s["\u0275\u0275elementStart"](2,"div",2),s["\u0275\u0275elementStart"](3,"div",3),s["\u0275\u0275elementStart"](4,"h5"),s["\u0275\u0275text"](5,"Product Details "),s["\u0275\u0275template"](6,f,3,1,"button",4),s["\u0275\u0275elementStart"](7,"button",5),s["\u0275\u0275listener"]("click",(function(){return t.ngOnInit()})),s["\u0275\u0275element"](8,"i",6),s["\u0275\u0275text"](9," Refresh"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](10,_,3,0,"button",7),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](11,v,1,0,"app-loading",8),s["\u0275\u0275template"](12,S,3,0,"div",8),s["\u0275\u0275template"](13,b,37,6,"div",9),s["\u0275\u0275elementStart"](14,"ul",10),s["\u0275\u0275elementStart"](15,"li",11),s["\u0275\u0275elementStart"](16,"a",12),s["\u0275\u0275text"](17,"DETAILS"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](18,"div",13),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](19,"li",11),s["\u0275\u0275elementStart"](20,"a",14),s["\u0275\u0275text"](21,"STOCK CHANGES"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](22,"li",11),s["\u0275\u0275elementStart"](23,"a",15),s["\u0275\u0275text"](24,"PRODUCT CONSUMPTION"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](25,"li",16),s["\u0275\u0275listener"]("click",(function(){return t.getSales()})),s["\u0275\u0275elementStart"](26,"a",17),s["\u0275\u0275text"](27,"SALES"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](28,"div",13),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](29,"li",16),s["\u0275\u0275listener"]("click",(function(){return t.showPriceHistory()})),s["\u0275\u0275elementStart"](30,"a",18),s["\u0275\u0275text"](31,"PRICE HISTORY"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](32,"div",13),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](33,"div",19),s["\u0275\u0275elementStart"](34,"div",20),s["\u0275\u0275elementStart"](35,"div",21),s["\u0275\u0275elementStart"](36,"div",22),s["\u0275\u0275template"](37,y,80,12,"div",9),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](38,"div",23),s["\u0275\u0275elementStart"](39,"div",21),s["\u0275\u0275elementStart"](40,"div",24),s["\u0275\u0275element"](41,"i",25),s["\u0275\u0275text"](42," Click an invoice number for more details "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](43,"div",22),s["\u0275\u0275element"](44,"app-product-history",26),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](45,"div",27),s["\u0275\u0275elementStart"](46,"div",21),s["\u0275\u0275elementStart"](47,"div",24),s["\u0275\u0275text"](48," Choose a period to view the quantities purchased, sold, and transferred for this product "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](49,"div",22),s["\u0275\u0275element"](50,"app-product-consumption-single",26),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](51,"div",28),s["\u0275\u0275template"](52,E,1,0,"app-loading",8),s["\u0275\u0275elementStart"](53,"div",21),s["\u0275\u0275elementStart"](54,"div",22),s["\u0275\u0275elementStart"](55,"app-sales-history",29),s["\u0275\u0275listener"]("onFinish",(function(e){return t.salesSelected(e)})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](56,"div",30),s["\u0275\u0275template"](57,x,1,0,"app-loading",8),s["\u0275\u0275elementStart"](58,"div",21),s["\u0275\u0275elementStart"](59,"div",31),s["\u0275\u0275elementStart"](60,"table",32),s["\u0275\u0275elementStart"](61,"thead"),s["\u0275\u0275elementStart"](62,"tr"),s["\u0275\u0275elementStart"](63,"th"),s["\u0275\u0275text"](64,"#"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](65,"th"),s["\u0275\u0275text"](66,"Date"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](67,"th"),s["\u0275\u0275text"](68,"Price"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](69,"th"),s["\u0275\u0275text"](70,"Quantity"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](71,"th"),s["\u0275\u0275text"](72,"Vendor"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](73,"th"),s["\u0275\u0275text"](74,"Invoice"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](75,"th"),s["\u0275\u0275text"](76,"Markup"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](77,"th"),s["\u0275\u0275text"](78,"By"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](79,"tbody"),s["\u0275\u0275template"](80,I,18,9,"tr",33),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](81,"div",34),s["\u0275\u0275elementStart"](82,"div",35),s["\u0275\u0275elementStart"](83,"div",36),s["\u0275\u0275template"](84,w,2,1,"div",37),s["\u0275\u0275elementStart"](85,"div",38),s["\u0275\u0275template"](86,j,1,0,"app-loading",8),s["\u0275\u0275template"](87,k,1,2,"app-sales-history",39),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](88,"div",40),s["\u0275\u0275elementStart"](89,"button",41),s["\u0275\u0275text"](90,"Close"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](91,"div",42),s["\u0275\u0275elementStart"](92,"div",35),s["\u0275\u0275elementStart"](93,"div",36),s["\u0275\u0275template"](94,D,2,1,"div",37),s["\u0275\u0275elementStart"](95,"div",38),s["\u0275\u0275template"](96,C,1,0,"app-loading",8),s["\u0275\u0275template"](97,N,1,1,"app-purchase-history",43),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](98,"div",40),s["\u0275\u0275elementStart"](99,"button",41),s["\u0275\u0275text"](100,"Close"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](101,"div",44),s["\u0275\u0275elementStart"](102,"div",35),s["\u0275\u0275elementStart"](103,"div",36),s["\u0275\u0275template"](104,q,2,1,"div",37),s["\u0275\u0275elementStart"](105,"div",38),s["\u0275\u0275template"](106,L,1,0,"app-loading",8),s["\u0275\u0275template"](107,P,1,1,"app-transfer-history",43),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](108,"div",40),s["\u0275\u0275elementStart"](109,"button",41),s["\u0275\u0275text"](110,"Close"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](111,"div",45),s["\u0275\u0275elementStart"](112,"div",35),s["\u0275\u0275elementStart"](113,"div",36),s["\u0275\u0275elementStart"](114,"div",46),s["\u0275\u0275elementStart"](115,"h5"),s["\u0275\u0275text"](116,"Attention - Delete Product"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](117,"br"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](118,"div",38),s["\u0275\u0275text"](119," This product has previous records. Do you really want to delete it? The system will also delete every record of the item in sales, purchases, transfers, stock adjustment "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](120,"div",40),s["\u0275\u0275elementStart"](121,"button",47),s["\u0275\u0275text"](122,"Cancel"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](123,"button",48),s["\u0275\u0275listener"]("click",(function(){return t.erase()})),s["\u0275\u0275text"](124,"Continue to Delete"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](6),s["\u0275\u0275property"]("ngIf","admin"!=t.user_type),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("ngIf","admin"!=t.user_type),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.is_loading),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.error),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.is_loaded),s["\u0275\u0275advance"](24),s["\u0275\u0275property"]("ngIf",t.is_loaded),s["\u0275\u0275advance"](7),s["\u0275\u0275property"]("id",t.id),s["\u0275\u0275advance"](6),s["\u0275\u0275property"]("id",t.id),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",t.is_loading_sales_details),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("objects",t.sales),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",t.is_loading_prices),s["\u0275\u0275advance"](23),s["\u0275\u0275property"]("ngForOf",t.prices),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("ngIf",null!=t.selected_item),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",t.is_loading_sales_details),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.is_loaded_sales_details),s["\u0275\u0275advance"](7),s["\u0275\u0275property"]("ngIf",null!=t.selected_item),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",t.is_loading_purchase_details),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.is_loaded_purchase_details),s["\u0275\u0275advance"](7),s["\u0275\u0275property"]("ngIf",null!=t.selected_item),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",t.is_loading_transfer_details),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.is_loaded_transfer_details))},directives:[a.j,o.a,c.a,m.a,a.i,i.d,h.a,i.e,p.a,u.a],styles:[""]}),e})()}];let O=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.f.forChild(T)],i.f]}),e})();var F=n("nEHF"),R=n("nBlB"),B=n("rNAZ"),Q=n("wDHj");let G=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.b,O,F.a,R.a,B.a,Q.a]]}),e})()},mS1k:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));class a{constructor(){this.active_ingredients=[]}}},nBlB:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("ofXK"),i=n("nEHF"),s=n("fXoL");let r=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.b,i.a]]}),e})()},rfqN:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n("fXoL"),i=n("c92J"),s=n("1VJT"),r=n("ccyI"),l=n("ofXK"),d=n("n49D"),o=n("nVU4");const c=["agGrid"];function m(e,t){1&e&&(a["\u0275\u0275elementStart"](0,"div",1),a["\u0275\u0275elementStart"](1,"h4"),a["\u0275\u0275text"](2,"No results"),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]())}let h=(()=>{class e{constructor(e,t,n){this.dbService=e,this.notify=t,this.authService=n,this.objects=[],this.show_options=!0,this.type="",this.receipt="",this.onReturn=new a.EventEmitter,this.can_view=!0,this.can_edit=!0,this.can_create=!0,this.can_delete=!0,this.edit_keys=["quantity"],this.offset=0,this.summary=[],this.overall_total=0,this.quantity_error=!1,this.columnDefs=[{headerName:"Product",field:"product_name",sortable:!0,filter:!0,checkboxSelection:!1},{headerName:"Quantity",field:"quantity",sortable:!0,filter:!0},{headerName:"Price",field:"price",sortable:!0,filter:!0},{headerName:"Total Amount",field:"total",sortable:!0,filter:!0},{headerName:"Receipt",field:"code",sortable:!0,filter:!0},{headerName:"Date",field:"date",sortable:!0,filter:!0}],this.rowData=[],this.selected_items=[],-1==this.authService.current_user.permissions.indexOf("Delete Transfers")&&(this.can_delete=!1),this.defaultColDef={resizable:!0}}ngOnInit(){this.prep()}onGridReady(e){this.gridApi=e.api,this.agGrid.api.sizeColumnsToFit()}onSelectionChanged(e){var t=this.gridApi.getSelectedRows();this.selected_items=t}ngOnChanges(){this.prep()}prep(){this.objects.map(e=>{e.total=e.price*e.quantity}),this.calculateTotals()}startEdit(e){this.selected=e,this.new_quantity=this.selected.quantity,$("#edit_sale_modal").modal({backdrop:"static",keyboard:!1})}returnSelected(){$("#return_sale_modal").modal({backdrop:"static",keyboard:!1})}getSelectedRows(){const e=this.agGrid.api.getSelectedNodes().map(e=>e.data).map(e=>e.product_name+" "+e.price).join(", ");alert(`Selected nodes: ${e}`)}checkQuantity(){this.quantity_error=!1,parseInt(this.new_quantity)>this.selected.quantity&&(this.quantity_error=!0,this.new_quantity=this.selected.quantity)}saveReturns(){if(null==this.selected_items||null==this.selected_items||this.selected_items.length<1)return this.notify.failNotification("Please add at least one product"),!1;this.notify.showLoading();for(var e=[],t=[],n=[],a=[],i="RFS-"+this.dbService.getToday("timestamp_string"),s=0;s<this.selected_items.length;s++){var r=this.selected_items[s];e.push(r.product_id),t.push(r.price),n.push(-1*r.quantity),a.push(r.product_name)}let l=new FormData;l.append("products",e.join("||")),l.append("prices",t.join("||")),l.append("quantities",n.join("||")),l.append("code",i),l.append("product_names",a.join("||")),l.append("amount_paid","0"),l.append("created_by",this.authService.current_user.id),l.append("date",this.dbService.getToday()),l.append("display_name",this.authService.current_user.display_name),l.append("payment_method","Return"),this.dbService.postData(l,"sale/saveBulk",this.authService.current_user).subscribe(e=>{this.notify.hideLoading(),"-1"===e.status?this.notify.failNotification("Unable to authenticate. Please login again"):"-9"===e.status?this.notify.showNotification("You are not permitted to perform this action","fail",3e3):($("#return_sale_modal").modal("hide"),this.agGrid.api.deselectAll(),this.selected_items=[],this.notify.hideLoading(),this.onReturn.emit(e.code),this.notify.successNotification("Items returned successfully"))},e=>{this.notify.hideLoading(),this.notify.noConnectionNotification(),console.log(e)})}saveQuantity(){$("#edit_sale_modal").modal("hide");let e=new FormData;this.notify.showLoading();var t=-1*parseFloat(this.new_quantity);e.append("quantities",t.toString()),e.append("products",this.selected.product.id),e.append("prices",this.selected.price.toFixed(2)),e.append("product_name",this.selected.product.name),e.append("created_by",this.authService.current_user.id),e.append("date",this.dbService.getToday()),this.dbService.postData(e,"sale/saveBulk",this.authService.current_user).subscribe(e=>{switch(this.notify.hideLoading(),e.status){case"0":this.notify.failNotification("You are not logged in");break;case"-1":this.notify.failNotification("server error. Contact admin");break;case"-9":this.notify.failNotification("You are not permitted ");break;default:this.notify.successNotification("sale edited successfully"),this.calculateTotals()}},e=>{this.notify.noConnectionNotification()})}delete(e){if(window.confirm("Sure you want to delete this sale? You cannot undo this")){let t=new FormData;this.notify.showLoading(),t.append("id",e.id),t.append("display_name",this.authService.current_user.display_name),t.append("code",e.code),t.append("name",e.product.name),this.dbService.postData(t,"sale/deleteItem",this.authService.current_user).subscribe(t=>{this.notify.hideLoading(),"1"===t.status&&(this.objects.splice(this.objects.indexOf(e),1),this.notify.showNotification("Sale deleted successfully","success",3e3),this.calculateTotals())},e=>{this.notify.noConnectionNotification()})}}calculateTotals(){var e=0;this.objects.map(t=>{e+=t.price*t.quantity}),this.overall_total=e}}return e.\u0275fac=function(t){return new(t||e)(a["\u0275\u0275directiveInject"](i.a),a["\u0275\u0275directiveInject"](s.a),a["\u0275\u0275directiveInject"](r.a))},e.\u0275cmp=a["\u0275\u0275defineComponent"]({type:e,selectors:[["app-transfer-history"]],viewQuery:function(e,t){var n;1&e&&a["\u0275\u0275viewQuery"](c,!0),2&e&&a["\u0275\u0275queryRefresh"](n=a["\u0275\u0275loadQuery"]())&&(t.agGrid=n.first)},inputs:{objects:"objects",show_options:"show_options",type:"type",receipt:"receipt",offset:"offset"},outputs:{onReturn:"onReturn"},features:[a["\u0275\u0275NgOnChangesFeature"]],decls:11,vars:6,consts:[["class","",4,"ngIf"],[1,""],["id","sales_details"],[1,"well"],[1,"text-danger"],[3,"objects"],["rowSelection","single",1,"ag-theme-balham",2,"width","100%","height","400px","font-family","Muli","font-size","15px",3,"rowData","columnDefs","defaultColDef","selectionChanged","gridReady"],["agGrid",""]],template:function(e,t){1&e&&(a["\u0275\u0275template"](0,m,3,0,"div",0),a["\u0275\u0275elementStart"](1,"div",1),a["\u0275\u0275elementStart"](2,"div",2),a["\u0275\u0275elementStart"](3,"div",3),a["\u0275\u0275elementStart"](4,"b"),a["\u0275\u0275text"](5,"Overall Total: "),a["\u0275\u0275elementStart"](6,"span",4),a["\u0275\u0275text"](7),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275element"](8,"app-export-to-excel",5),a["\u0275\u0275elementStart"](9,"ag-grid-angular",6,7),a["\u0275\u0275listener"]("selectionChanged",(function(e){return t.onSelectionChanged(e)}))("gridReady",(function(e){return t.onGridReady(e)})),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()),2&e&&(a["\u0275\u0275property"]("ngIf",t.objects.length<1),a["\u0275\u0275advance"](7),a["\u0275\u0275textInterpolate1"]("GHC ",t.overall_total.toFixed(2),""),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("objects",t.objects),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("rowData",t.objects)("columnDefs",t.columnDefs)("defaultColDef",t.defaultColDef))},directives:[l.j,d.a,o.AgGridAngular],styles:[""]}),e})()},wDHj:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("ofXK"),i=n("nEHF"),s=n("6QD7"),r=n("fXoL");let l=(()=>{class e{}return e.\u0275mod=r["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=r["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.b,i.a,s.b],s.b]}),e})()}}]);