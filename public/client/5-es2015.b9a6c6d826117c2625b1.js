(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"4j6H":function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var i=n("fXoL"),r=n("c92J"),s=n("1VJT"),o=n("BbYg"),a=n("ccyI"),c=n("ofXK"),l=n("hiAm"),d=n("3Pt+"),h=n("tyNb");function u(e,t){1&e&&i["\u0275\u0275element"](0,"app-loading")}function p(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275elementStart"](1,"h4"),i["\u0275\u0275text"](2,"Not found"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]())}function m(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"option",9),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;i["\u0275\u0275propertyInterpolate"]("value",e.id),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function f(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275elementStart"](1,"label"),i["\u0275\u0275text"](2,"Select Product"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](3,"select",7),i["\u0275\u0275listener"]("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).select_product=t}))("change",(function(){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).productSelected()})),i["\u0275\u0275template"](4,m,2,2,"option",8),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngModel",e.select_product),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngForOf",e.objects)}}function g(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",3),i["\u0275\u0275elementStart"](1,"div",4),i["\u0275\u0275elementStart"](2,"button",5),i["\u0275\u0275listener"]("click",(function(){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().addProduct()})),i["\u0275\u0275text"](3,"Add Product"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](4,u,1,0,"app-loading",6),i["\u0275\u0275template"](5,p,3,0,"div",6),i["\u0275\u0275template"](6,f,5,2,"div",6),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("ngIf",e.is_searching),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.error_search),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.is_finished_search)}}function _(e,t){1&e&&i["\u0275\u0275element"](0,"app-loading")}function b(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275elementStart"](1,"h4"),i["\u0275\u0275text"](2,"Not found"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]())}function v(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"a",17),i["\u0275\u0275listener"]("click",(function(){i["\u0275\u0275restoreView"](e);const n=t.$implicit;return i["\u0275\u0275nextContext"](3).add(n)})),i["\u0275\u0275elementStart"](1,"b"),i["\u0275\u0275text"](2),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate3"]("",e.name," [price: ",e.price,"/",e.unit,"]")}}function y(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",13),i["\u0275\u0275elementStart"](1,"div",14),i["\u0275\u0275elementStart"](2,"input",15),i["\u0275\u0275listener"]("keyup",(function(){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).filterlist()}))("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).filter_param=t})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](3,v,3,3,"a",16),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngModel",e.filter_param),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngForOf",e.filter_results)}}function x(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",10),i["\u0275\u0275elementStart"](1,"div",11),i["\u0275\u0275elementStart"](2,"button",5),i["\u0275\u0275listener"]("click",(function(){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().addProduct()})),i["\u0275\u0275text"](3,"Add Product"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](4,_,1,0,"app-loading",6),i["\u0275\u0275template"](5,b,3,0,"div",6),i["\u0275\u0275template"](6,y,4,2,"div",12),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("ngIf",e.is_searching),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.error_search),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.is_finished_search)}}function S(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275elementStart"](1,"b"),i["\u0275\u0275text"](2,"Not found"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]())}const C=function(e){return{"select-product-active":e}};function j(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"li",23),i["\u0275\u0275listener"]("click",(function(){i["\u0275\u0275restoreView"](e);const n=t.$implicit;return i["\u0275\u0275nextContext"](3).add(n)})),i["\u0275\u0275text"](1),i["\u0275\u0275element"](2,"br"),i["\u0275\u0275text"](3),i["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=t.index,r=i["\u0275\u0275nextContext"](3);i["\u0275\u0275property"]("ngClass",i["\u0275\u0275pureFunction1"](5,C,n==r.arrowkeyLocation)),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"](" ",e.name," "),i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate3"](" [price: ",e.price,"/",e.unit,"] [stock: ",e.stock,"] ")}}function E(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",21),i["\u0275\u0275elementStart"](1,"ul",13),i["\u0275\u0275template"](2,j,4,7,"li",22),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e){const e=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngForOf",e.objects)}}function w(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275text"](1," Item not found. Check the spelling. Or "),i["\u0275\u0275elementStart"](2,"a",24),i["\u0275\u0275element"](3,"i",25),i["\u0275\u0275text"](4," click here to add a new product"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]())}function M(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",18),i["\u0275\u0275elementStart"](1,"input",19),i["\u0275\u0275listener"]("keyup",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().keyUp(t)}))("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().param=t})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](2,S,3,0,"div",6),i["\u0275\u0275template"](3,E,3,1,"div",20),i["\u0275\u0275template"](4,w,5,0,"div",6),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngModel",e.param),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.error_search),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.objects.length>0&&e.is_finished_search),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.objects.length<1&&e.is_finished_search)}}let I=(()=>{class e{constructor(e,t,n,r){this.dbService=e,this.notify=t,this.localforage=n,this.authService=r,this.onFinish=new i.EventEmitter,this.btn_text="Select",this.onAdd=new i.EventEmitter,this.type="search",this.show="no",this.param="",this.objects=[],this.selected=null,this.is_searching=!1,this.is_finished_search=!1,this.error_search=!1,this.added=[],this.filter_param="",this.filter_results=[],this.local_products=[],this.arrowkeyLocation=0,$(".search_results").on("click",(function(){$("#sales_search").focus()}))}ngOnInit(){"list"!=this.type&&"select"!=this.type||this.list()}hideSearchResults(){this.param="",this.objects.length=0,this.is_finished_search=!1}ngOnChanges(){console.log(this.timestamp),$("#sales_search").focus()}productSelected(){for(let e=0;e<this.objects.length;e++)if(this.objects[e].id==this.select_product){this.onAdd.emit(this.objects[e]);break}}addProduct(){$("#add_product_modal").modal("show")}productAdded(e){console.log(e),e.price=parseFloat(e.price),this.objects.push(e),this.onAdd.emit(e),$("#add_product_modal").modal("hide")}list(){this.is_searching=!0,this.is_finished_search=!1,this.error_search=!1,this.dbService.getData("product/getList",this.authService.current_user).subscribe(e=>{"-1"===e.status?(this.is_searching=!1,this.is_finished_search=!1,this.error_search=!0):(this.objects=e.data,this.filter_results="yes"==this.show?this.objects:[],this.is_searching=!1,this.is_finished_search=!0,this.error_search=!1)},e=>{this.is_searching=!1,this.is_finished_search=!1,this.error_search=!1})}filterlist(){let e=this.filter_param;this.filter_results=null==e||null==e||e.length<1?"yes"==this.show?this.objects:[]:this.objects.filter((function(t){return t.name.toLowerCase().includes(e.toLowerCase())}))}add(e){this.onAdd.emit(e),console.log(e),this.is_finished_search=!1,$("#sales_search").focus(),this.param="",this.objects=[],this.arrowkeyLocation=0}search(){if(""==this.param.trim()||null==this.param||null==this.param)return this.objects=[],void(this.is_finished_search=!1);this.is_searching=!0,this.is_finished_search=!1,this.error_search=!1,this.dbService.getDataWithQuery("product/search",this.authService.current_user,"param="+this.param+"&limit=10").subscribe(e=>{"-1"===e.status?(this.is_searching=!1,this.is_finished_search=!1,this.error_search=!0):(this.objects=e.data,this.is_searching=!1,this.is_finished_search=!0,this.error_search=!1,this.selected=null)},e=>{this.is_searching=!1,this.is_finished_search=!1,this.error_search=!1})}localSearch(){this.is_searching=!0,this.localforage.getItem(this.dbService.PRODUCT_LIST_KEY).subscribe(e=>{if(this.local_products=e,this.is_finished_search=!1,this.error_search=!1,this.param.length<1)return this.objects=[],this.is_searching=!1,this.is_finished_search=!1,this.error_search=!1,!1;if(null==this.local_products)return this.objects=[],this.notify.failNotification("No Products! Please refresh the page"),this.is_searching=!1,this.is_finished_search=!1,this.error_search=!1,!1;var t=this.param.toLowerCase().trim();console.log(this.param);let n=t.split(" ");var i=this.local_products.filter((function(e){for(let t=0;t<n.length;t++)if(-1==e.name.toLowerCase().indexOf(n[t])&&e.barcode!=n[t])return!1;return!0}));i.sort((function(e,n){let i=e.name.toLowerCase(),r=n.name.toLowerCase();return i.indexOf(t)<r.indexOf(t)?-1:i>r?1:0})),this.objects=i.slice(0,i.length>10?9:i.length),this.is_searching=!1,this.is_finished_search=!0,this.error_search=!1},e=>{this.notify.failNotification("Failed to get products. Please refresh the page")})}select(e){this.selected=e,this.onFinish.emit(e)}highlightObject(e){this.objects.map(e=>{e.selected=!1}),this.highlightedObject=e,e.selected=!0}keyUp(e){switch(e.keyCode){case 38:0==this.arrowkeyLocation||this.arrowkeyLocation--,$(".search_results").scrollTop(0),$(".search_results").scrollTop($(".select-product-active:first").offset().top-$(".search_results").height()+10),console.log($(".select-product-active:first").offset().top-$(".search_results").height()),this.focusCursor();break;case 40:this.arrowkeyLocation==this.objects.length-1||this.arrowkeyLocation++,$(".search_results").scrollTop(0),$(".search_results").scrollTop($(".select-product-active:first").offset().top-$(".search_results").height()+10),console.log($(".select-product-active:first").offset().top-$(".search_results").height()),this.focusCursor();break;case 13:let e=this.objects[this.arrowkeyLocation];null!=e&&null!=e&&this.add(e);break;case 27:this.hideSearchResults();break;default:this.arrowkeyLocation=0,"offline"==this.dbService.ENVIRONMENT?this.search():this.localSearch()}}focusCursor(){let e=$("#sales_search").val();$("#sales_search").val("").val(e)}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](r.a),i["\u0275\u0275directiveInject"](s.a),i["\u0275\u0275directiveInject"](o.LocalForageService),i["\u0275\u0275directiveInject"](a.a))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-select-product"]],inputs:{btn_text:"btn_text",type:"type",show:"show",timestamp:"timestamp"},outputs:{onFinish:"onFinish",onAdd:"onAdd"},features:[i["\u0275\u0275NgOnChangesFeature"]],decls:3,vars:3,consts:[["class","",4,"ngIf"],["class","card z-depth-bottom-1",4,"ngIf"],["class","focus_search",4,"ngIf"],[1,""],[1,"body"],[1,"btn","btn-inverse","btn-sm",3,"click"],[4,"ngIf"],["name","products",1,"product",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"card","z-depth-bottom-1"],[1,"card-body"],["class","list-group",4,"ngIf"],[1,"list-group"],[1,"list-group-item"],["placeholder","Search...","type","text","name","filter_param",1,"form-control",3,"ngModel","keyup","ngModelChange"],["class","list-group-item",3,"click",4,"ngFor","ngForOf"],[1,"list-group-item",3,"click"],[1,"focus_search"],["autofocus","","autocomplete","off","placeholder","Enter product names or barcode","required","","type","text","id","sales_search","name","search",3,"ngModel","keyup","ngModelChange"],["class","search_results ","id","search_results_list",4,"ngIf"],["id","search_results_list",1,"search_results"],["tabindex","-1","class","list-group-item",3,"ngClass","click",4,"ngFor","ngForOf"],["tabindex","-1",1,"list-group-item",3,"ngClass","click"],["routerLink","/add_product"],[1,"feather","icon-plus"]],template:function(e,t){1&e&&(i["\u0275\u0275template"](0,g,7,3,"div",0),i["\u0275\u0275template"](1,x,7,3,"div",1),i["\u0275\u0275template"](2,M,5,4,"div",2)),2&e&&(i["\u0275\u0275property"]("ngIf","select"==t.type),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf","list"==t.type),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf","search"==t.type))},directives:[c.j,l.a,d.m,d.e,d.h,c.i,d.i,d.n,d.b,d.l,c.h,h.e],styles:[".link[_ngcontent-%COMP%]{cursor:pointer;text-decoration:underline}"]}),e})()},"5G6A":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{constructor(){}}},TFay:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var i=n("fXoL"),r=n("mS1k"),s=n("c92J"),o=n("bgkY"),a=n("1VJT"),c=n("ccyI"),l=n("ofXK"),d=n("3Pt+"),h=n("jr2M");function u(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"option",23),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;i["\u0275\u0275propertyInterpolate"]("value",e),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate"](e)}}function p(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"input",24),i["\u0275\u0275listener"]("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).object.unit=t})),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"](2);i["\u0275\u0275property"]("ngModel",e.object.unit)}}function m(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"input",25),i["\u0275\u0275listener"]("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).object.category=t})),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"](2);i["\u0275\u0275property"]("ngModel",e.object.category)}}function f(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",5),i["\u0275\u0275elementStart"](1,"label"),i["\u0275\u0275text"](2,"Starting stock*"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](3,"br"),i["\u0275\u0275elementStart"](4,"input",26),i["\u0275\u0275listener"]("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).object.stock=t})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("ngModel",e.object.stock)}}function g(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"form",1,2),i["\u0275\u0275listener"]("ngSubmit",(function(){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().submit()})),i["\u0275\u0275elementStart"](2,"div",3),i["\u0275\u0275elementStart"](3,"em"),i["\u0275\u0275text"](4,"Fields marked * are required"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](5,"div",4),i["\u0275\u0275elementStart"](6,"div",5),i["\u0275\u0275elementStart"](7,"label"),i["\u0275\u0275text"](8,"Product Name"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](9,"br"),i["\u0275\u0275elementStart"](10,"input",6),i["\u0275\u0275listener"]("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().object.name=t})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](11,"div",5),i["\u0275\u0275elementStart"](12,"label"),i["\u0275\u0275text"](13,"Cost Price*"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](14,"br"),i["\u0275\u0275elementStart"](15,"input",7),i["\u0275\u0275listener"]("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().object.cost_price=t})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](16,"div",5),i["\u0275\u0275elementStart"](17,"label"),i["\u0275\u0275text"](18," Selling Price*"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](19,"br"),i["\u0275\u0275elementStart"](20,"input",8),i["\u0275\u0275listener"]("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().object.price=t})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](21,"div",4),i["\u0275\u0275elementStart"](22,"div",5),i["\u0275\u0275elementStart"](23,"label"),i["\u0275\u0275text"](24,"Unit"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](25,"br"),i["\u0275\u0275elementStart"](26,"select",9),i["\u0275\u0275listener"]("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().unit_selected=t})),i["\u0275\u0275template"](27,u,2,2,"option",10),i["\u0275\u0275elementStart"](28,"option",11),i["\u0275\u0275text"](29,"Other"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](30,p,1,1,"input",12),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](31,"div",5),i["\u0275\u0275elementStart"](32,"label"),i["\u0275\u0275text"](33,"Category"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](34,"br"),i["\u0275\u0275elementStart"](35,"div"),i["\u0275\u0275elementStart"](36,"app-select-product-category",13),i["\u0275\u0275listener"]("onFinish",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().categorySelected(t)})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](37,m,1,1,"input",14),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](38,"div",5),i["\u0275\u0275elementStart"](39,"label"),i["\u0275\u0275text"](40,"Minimum stock*"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](41,"br"),i["\u0275\u0275elementStart"](42,"input",15),i["\u0275\u0275listener"]("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().object.min_stock=t})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](43,"div",4),i["\u0275\u0275template"](44,f,5,1,"div",16),i["\u0275\u0275elementStart"](45,"div",5),i["\u0275\u0275elementStart"](46,"label"),i["\u0275\u0275text"](47,"Maximum stock"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](48,"br"),i["\u0275\u0275elementStart"](49,"input",17),i["\u0275\u0275listener"]("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().object.max_stock=t})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](50,"div",5),i["\u0275\u0275elementStart"](51,"label"),i["\u0275\u0275text"](52,"Closest expiry"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](53,"br"),i["\u0275\u0275elementStart"](54,"input",18),i["\u0275\u0275listener"]("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().object.expiry=t})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](55,"div",4),i["\u0275\u0275elementStart"](56,"div",5),i["\u0275\u0275elementStart"](57,"label"),i["\u0275\u0275text"](58,"Barcode"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](59,"br"),i["\u0275\u0275elementStart"](60,"input",19),i["\u0275\u0275listener"]("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().object.barcode=t})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](61,"div",5),i["\u0275\u0275elementStart"](62,"label"),i["\u0275\u0275text"](63,"Notes"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](64,"br"),i["\u0275\u0275elementStart"](65,"textarea",20),i["\u0275\u0275listener"]("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().object.notes=t})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275element"](66,"input",21),i["\u0275\u0275element"](67,"input",22),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](10),i["\u0275\u0275property"]("ngModel",e.object.name),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",e.object.cost_price),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",e.object.price),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("ngModel",e.unit_selected),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngForOf",e.units),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf","other"==e.unit_selected),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("selected",e.object.category),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf","other"==e.category_selected),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",e.object.min_stock),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngIf",null==e.id),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",e.object.max_stock),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",e.object.expiry),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("ngModel",e.object.barcode),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngModel",e.object.notes)}}let _=(()=>{class e{constructor(e,t,n,s){this.dbService=e,this.socket=t,this.notify=n,this.authService=s,this.error=!1,this.is_loading=!0,this.is_loaded=!1,this.onFinish=new i.EventEmitter,this.units=["ampoule","bottle","box","capsule","carton","glove","inhaler","pack","pessary","piece","roll","strip","suppository","syringe","tablet","tube","vial"],this.unit_selected="",this.category_selected="",this.uploadUrl="admin/uploadPicture",this.can_master_edit=!0,this.can_edit=!0,this.object=new r.a,this.units=this.dbService.units}ngOnInit(){null==this.id||null==this.id||this.getobject(this.id)}ngOnChanges(){null==this.id||null==this.id||this.getobject(this.id)}getobject(e){this.dbService.getDataWithQuery("product/findById",this.authService.current_user,"id="+this.id).subscribe(e=>{if(this.object=e.data,this.unit_selected=this.object.unit,this.pic_location=this.object.picture,null!=this.object.picture){var t=this.object.picture.split("/");this.object.picture=t.pop()}this.is_loading=!1,this.is_loaded=!0,this.error=!1},e=>{this.is_loading=!1,this.error=!0,this.is_loaded=!1})}categorySelected(e){this.category_selected=e,"other"!=this.category_selected&&(this.object.category=e)}uploadFinished(e){this.pic_location=e,this.object.picture=e}submit(){this.notify.showLoading(),"other"!=this.unit_selected&&(this.object.unit=this.unit_selected);let e=new FormData;for(let t in this.object)e.append(t,this.object[t]);null!=this.id&&null!=this.id||e.append("createdAt",this.dbService.getToday()),e.append("display_name",this.authService.current_user.display_name),null!=this.object.notes&&null!=this.object.notes||e.append("notes",""),this.dbService.postData(e,"product/saveBranchDetails",this.authService.current_user).subscribe(e=>{this.notify.hideLoading(),"0"===e.status?this.notify.failNotification("Unable to authenticate. Please login again"):"-9"===e.status?this.notify.showNotification("You are not permitted to perform this action","fail",3e3):"-1"===e.status?this.notify.showNotification("Server error. Please contact admin","fail",3e3):(null!=this.id&&null!=this.id||(this.object.id=e.status),this.notify.successNotification("Product saved successfully"),this.socket.sendEvent({company_id:this.authService.current_user.company_id,parent_company_id:this.authService.current_user.parent_company,message:`Product update received:  ${this.object.name}`,product:this.object,event:"product_update"}),this.onFinish.emit(this.object),this.object=new r.a)},e=>{this.notify.noConnectionNotification()})}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](s.a),i["\u0275\u0275directiveInject"](o.a),i["\u0275\u0275directiveInject"](a.a),i["\u0275\u0275directiveInject"](c.a))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-product-form"]],inputs:{id:"id"},outputs:{onFinish:"onFinish"},features:[i["\u0275\u0275NgOnChangesFeature"]],decls:1,vars:1,consts:[["ngNativeValidate","",3,"ngSubmit",4,"ngIf"],["ngNativeValidate","",3,"ngSubmit"],["n","ngForm"],[1,""],[1,"row","bottom-margin"],[1,"col-md-4"],["required","","type","text","name","name",1,"form-control",3,"ngModel","ngModelChange"],["required","","type","text","name","cost_price",1,"form-control",3,"ngModel","ngModelChange"],["required","","type","text","name","price",3,"ngModel","ngModelChange"],["name","unit",1,"",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["value","other"],["class","form-control","type","text","name","unit",3,"ngModel","ngModelChange",4,"ngIf"],[3,"selected","onFinish"],["class","form-control","required","","type","text","name","category",3,"ngModel","ngModelChange",4,"ngIf"],["value","1","required","","type","text","name","min_stock",1,"form-control",3,"ngModel","ngModelChange"],["class","col-md-4",4,"ngIf"],["value","10","required","","type","text","name","max_stock",1,"form-control",3,"ngModel","ngModelChange"],["required","","type","date","name","expiry",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","barcode",1,"form-control",3,"ngModel","ngModelChange"],["name","notes","rows","3","cols","40",1,"form-control",3,"ngModel","ngModelChange"],["type","submit","name","submit","value","Submit",1,"btn","btn-success"],["type","reset","name","reset","value","Reset",1,"btn","btn-warning"],[3,"value"],["type","text","name","unit",1,"form-control",3,"ngModel","ngModelChange"],["required","","type","text","name","category",1,"form-control",3,"ngModel","ngModelChange"],["value","0","required","","type","text","name","stock",1,"form-control",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&i["\u0275\u0275template"](0,g,68,14,"form",0),2&e&&i["\u0275\u0275property"]("ngIf",t.can_edit)},directives:[l.j,d.f,d.g,d.b,d.l,d.e,d.h,d.m,l.i,d.i,d.n,h.a],styles:[""]}),e})()},hiAm:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("fXoL");let r=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-loading"]],decls:2,vars:0,consts:[[1,"fa","fa-spin","fa-spinner"]],template:function(e,t){1&e&&(i["\u0275\u0275element"](0,"i",0),i["\u0275\u0275text"](1," Loading..."))},styles:[""]}),e})()},jr2M:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("fXoL"),r=n("c92J"),s=n("1VJT"),o=n("ccyI"),a=n("ofXK"),c=n("3Pt+");function l(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"option",4),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;i["\u0275\u0275propertyInterpolate"]("value",e),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"]("",e," ")}}function d(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"span"),i["\u0275\u0275elementStart"](1,"select",1),i["\u0275\u0275listener"]("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().selected=t}))("change",(function(){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().item_selected()})),i["\u0275\u0275template"](2,l,2,2,"option",2),i["\u0275\u0275elementStart"](3,"option",3),i["\u0275\u0275text"](4,"Other"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngModel",e.selected),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngForOf",e.objects)}}let h=(()=>{class e{constructor(e,t,n){this.dbService=e,this.notify=t,this.authService=n,this.objects=[],this.is_loading=!1,this.error=!1,this.is_loaded=!1,this.onFinish=new i.EventEmitter,this.selected=null}ngOnInit(){this.start()}start(){this.is_loaded=!1,this.is_loading=!0,this.dbService.getData("product/getCategories",this.authService.current_user).subscribe(e=>{"-1"===e.status&&(this.notify.failNotification(e.message),this.error=!0),"-9"===e.status?(this.notify.failNotification(e.message),this.error=!0):(this.objects=e.data,this.is_loaded=!0,this.error=!1),this.is_loading=!1},e=>{this.notify.noConnectionNotification()})}item_selected(){this.onFinish.emit(this.selected)}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](r.a),i["\u0275\u0275directiveInject"](s.a),i["\u0275\u0275directiveInject"](o.a))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-select-product-category"]],inputs:{selected:"selected"},outputs:{onFinish:"onFinish"},decls:1,vars:1,consts:[[4,"ngIf"],["name","selected",1,"",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],["value","other"],[3,"value"]],template:function(e,t){1&e&&i["\u0275\u0275template"](0,d,5,2,"span",0),2&e&&i["\u0275\u0275property"]("ngIf",t.is_loaded)},directives:[a.j,c.m,c.e,c.h,a.i,c.i,c.n],styles:[""]}),e})()},mS1k:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{constructor(){}}},"n+He":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{constructor(){}}},nBlB:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("ofXK"),r=n("nEHF"),s=n("fXoL");let o=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.b,r.a]]}),e})()},sGMU:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{constructor(){this.status="Pending"}}},wDHj:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("ofXK"),r=n("nEHF"),s=n("6QD7"),o=n("fXoL");let a=(()=>{class e{}return e.\u0275mod=o["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=o["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.b,r.a,s.b],s.b]}),e})()}}]);