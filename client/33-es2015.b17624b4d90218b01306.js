(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{rNAZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("ofXK"),a=n("nEHF"),i=n("6QD7"),o=n("fXoL");let l=(()=>{class e{}return e.\u0275mod=o["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=o["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[r.b,a.a,i.b],i.b]}),e})()},wxhZ:function(e,t,n){"use strict";n.r(t),n.d(t,"AddUserModule",(function(){return b}));var r=n("ofXK"),a=n("tyNb"),i=n("zmU/"),o=n("MCNt"),l=n("fXoL"),d=n("c92J"),s=n("1VJT"),m=n("ccyI"),c=n("3Pt+"),p=n("OA5k");function u(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",6),l["\u0275\u0275elementStart"](1,"app-add-role",27),l["\u0275\u0275listener"]("onFinish",(function(t){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().roleAdded(t)})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}}function h(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",28),l["\u0275\u0275text"](1," Please make sure passwords match "),l["\u0275\u0275elementEnd"]())}function f(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"option",29),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;l["\u0275\u0275propertyInterpolate"]("value",e.role_id),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",e.role_name," ")}}function g(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"td"),l["\u0275\u0275elementStart"](1,"select",23),l["\u0275\u0275listener"]("ngModelChange",(function(t){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().role_id=t})),l["\u0275\u0275template"](2,f,2,2,"option",25),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span",15),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngModel",e.role_id),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngForOf",e.roles)}}function S(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"option",29),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;l["\u0275\u0275propertyInterpolate"]("value",e.id),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",e.name," ")}}const E=[{path:"",component:(()=>{class e{constructor(e,t,n,r,a){this.router=e,this.dbService=n,this.notify=r,this.authService=a,this.error_roles=!1,this.is_loading_roles=!0,this.is_loaded_roles=!1,this.add_role=!1,this.uploadUrl="uploadPharmacistPicture",this.error_regions=!1,this.is_loading_regions=!0,this.is_loaded_regions=!1,this.user=new i.a,this.user.role=new o.a,-1==this.authService.current_user.permissions.indexOf("Manage Staff")&&(this.notify.failNotification("You are not permitted to view the page"),this.goBack()),this.dbService.setTitle("Users")}ngOnInit(){this.getBranches(),this.dbService.getData("admin/getRoles",this.authService.current_user).subscribe(e=>{this.roles=e.data,this.is_loading_roles=!1,this.is_loaded_roles=!0,this.error_roles=!1},e=>{this.is_loading_roles=!1,this.error_roles=!0,this.is_loaded_roles=!1})}getBranches(){this.notify.showLoading();let e="admin/getBranches?only_others=no";"admin"==this.authService.current_user.type&&(e+="&parent_company_id="+this.authService.current_user.parent_company_id),this.dbService.getData(e,this.authService.current_user).subscribe(e=>{this.notify.hideLoading(),"-1"===e.status||(this.branches=e.data)},e=>{this.notify.hideLoading(),this.notify.noConnectionNotification()})}roleAdded(e){this.roles.push(e),this.role_id=e.role_id,this.add_role=!1}uploadFinished(e){this.user.picture=e}submit(){this.notify.showLoading();const e=new FormData;e.append("display_name",this.user.display_name),e.append("username",this.user.username),e.append("password",this.password),e.append("email",this.user.email),e.append("position",this.user.position),e.append("role_id",this.role_id),e.append("phone",this.user.phone),e.append("active","1"),e.append("company_id",this.company_id),this.dbService.postData(e,"admin/saveUser",this.authService.current_user).subscribe(e=>{this.notify.hideLoading(),"-1"===e.status?this.notify.failNotification("Unable to authenticate. Please login again"):"-9"===e.status?this.notify.showNotification("You are not permitted to perform this action","fail",3e3):"-2"===e.status?this.notify.showNotification("The username already exists. Please choose a different one","fail",3e3):(this.notify.successNotification("User added successfully"),this.router.navigate(["/users"]))},e=>{this.notify.noConnectionNotification()})}goBack(){window.history.back()}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](a.d),l["\u0275\u0275directiveInject"](a.a),l["\u0275\u0275directiveInject"](d.a),l["\u0275\u0275directiveInject"](s.a),l["\u0275\u0275directiveInject"](m.a))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["app-add-user"]],decls:80,vars:13,consts:[[1,"content"],[1,"container"],[1,"row"],[1,"col-sm-12"],[1,"card"],[1,"card-header"],[1,""],[1,"btn","btn-primary","waves-effect",3,"click"],["class","",4,"ngIf"],[1,"card-block"],["ngNativeValidate","",3,"ngSubmit"],["n","ngForm"],[1,"table","table-striped","table-bordered"],["id","name","required","","type","text","name","name",1,"form-control",3,"ngModel","ngModelChange"],["id","username","required","","type","text","name","username",3,"ngModel","ngModelChange"],[1,"help-inline"],["required","","type","text","name","phone",3,"ngModel","ngModelChange"],["required","","id","email","type","email","name","email",1,"form-control",3,"ngModel","ngModelChange"],["required","","type","password","name","password",3,"ngModel","ngModelChange"],["required","","type","password","name","c_password",3,"ngModel","ngModelChange"],["class","text-danger",4,"ngIf"],["required","","type","text","name","position",1,"form-control",3,"ngModel","ngModelChange"],[4,"ngIf"],["required","","name","role",3,"ngModel","ngModelChange"],["value","0"],[3,"value",4,"ngFor","ngForOf"],["type","submit","name","","value","Submit",1,"btn","btn-primary",3,"disabled"],[3,"onFinish"],[1,"text-danger"],[3,"value"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"section",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"div",3),l["\u0275\u0275elementStart"](4,"div",4),l["\u0275\u0275elementStart"](5,"div",5),l["\u0275\u0275elementStart"](6,"h5"),l["\u0275\u0275text"](7,"Add New User"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](8,"div",6),l["\u0275\u0275elementStart"](9,"b"),l["\u0275\u0275text"](10,"If a role is not in the dropdown, "),l["\u0275\u0275elementStart"](11,"button",7),l["\u0275\u0275listener"]("click",(function(){return t.add_role=!t.add_role})),l["\u0275\u0275text"](12,"click here"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](13," to add it"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](14,u,2,0,"div",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](15,"div",9),l["\u0275\u0275elementStart"](16,"form",10,11),l["\u0275\u0275listener"]("ngSubmit",(function(){return t.submit()})),l["\u0275\u0275elementStart"](18,"table",12),l["\u0275\u0275elementStart"](19,"tbody"),l["\u0275\u0275elementStart"](20,"tr"),l["\u0275\u0275elementStart"](21,"td"),l["\u0275\u0275elementStart"](22,"label"),l["\u0275\u0275text"](23,"Full Name*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](24,"td"),l["\u0275\u0275elementStart"](25,"input",13),l["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.display_name=e})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](26,"tr"),l["\u0275\u0275elementStart"](27,"td"),l["\u0275\u0275elementStart"](28,"label"),l["\u0275\u0275text"](29,"Username*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](30,"td"),l["\u0275\u0275elementStart"](31,"input",14),l["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.username=e})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](32,"span",15),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](33,"tr"),l["\u0275\u0275elementStart"](34,"td"),l["\u0275\u0275elementStart"](35,"label"),l["\u0275\u0275text"](36,"Phone*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](37,"td"),l["\u0275\u0275elementStart"](38,"input",16),l["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.phone=e})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](39,"tr"),l["\u0275\u0275elementStart"](40,"td"),l["\u0275\u0275elementStart"](41,"label"),l["\u0275\u0275text"](42,"Email*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](43,"td"),l["\u0275\u0275elementStart"](44,"input",17),l["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.email=e})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](45,"tr"),l["\u0275\u0275elementStart"](46,"td"),l["\u0275\u0275elementStart"](47,"label"),l["\u0275\u0275text"](48,"Password*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](49,"td"),l["\u0275\u0275elementStart"](50,"input",18),l["\u0275\u0275listener"]("ngModelChange",(function(e){return t.password=e})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](51,"tr"),l["\u0275\u0275elementStart"](52,"td"),l["\u0275\u0275elementStart"](53,"label"),l["\u0275\u0275text"](54,"Confirm Password*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](55,"td"),l["\u0275\u0275elementStart"](56,"input",19),l["\u0275\u0275listener"]("ngModelChange",(function(e){return t.confirm_password=e})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](57,h,2,0,"div",20),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](58,"tr"),l["\u0275\u0275elementStart"](59,"td"),l["\u0275\u0275elementStart"](60,"label"),l["\u0275\u0275text"](61,"Position*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](62,"td"),l["\u0275\u0275elementStart"](63,"input",21),l["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.position=e})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](64,"tr"),l["\u0275\u0275elementStart"](65,"td"),l["\u0275\u0275elementStart"](66,"label"),l["\u0275\u0275text"](67,"Role*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](68,g,4,2,"td",22),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](69,"tr"),l["\u0275\u0275elementStart"](70,"td"),l["\u0275\u0275elementStart"](71,"label"),l["\u0275\u0275text"](72,"Branch*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](73,"td"),l["\u0275\u0275elementStart"](74,"select",23),l["\u0275\u0275listener"]("ngModelChange",(function(e){return t.company_id=e})),l["\u0275\u0275elementStart"](75,"option",24),l["\u0275\u0275text"](76," None "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](77,S,2,2,"option",25),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](78,"span",15),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](79,"input",26),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](14),l["\u0275\u0275property"]("ngIf",t.add_role),l["\u0275\u0275advance"](11),l["\u0275\u0275property"]("ngModel",t.user.display_name),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngModel",t.user.username),l["\u0275\u0275advance"](7),l["\u0275\u0275property"]("ngModel",t.user.phone),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngModel",t.user.email),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngModel",t.password),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngModel",t.confirm_password),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.password!=t.confirm_password),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngModel",t.user.position),l["\u0275\u0275advance"](5),l["\u0275\u0275property"]("ngIf",t.is_loaded_roles),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngModel",t.company_id),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngForOf",t.branches),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",t.password!=t.confirm_password))},directives:[r.j,c.f,c.g,c.b,c.l,c.e,c.h,c.m,c.i,c.n,r.i,p.a],styles:[""]}),e})()}];let y=(()=>{class e{}return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.f.forChild(E)],a.f]}),e})();var v=n("uQlb"),_=n("nEHF");let b=(()=>{class e{}return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[r.b,y,v.a,_.a]]}),e})()}}]);